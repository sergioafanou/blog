---
layout: post
title: Como Instalar o Webmin no Ubuntu 18.04
network: digitalocean
date: December 12, 2019 at 07:56PM
url: https://www.digitalocean.com/community/tutorials/how-to-install-webmin-on-ubuntu-18-04-pt
image: https://assets.digitalocean.com/articles/webmin1804/RF2fRmB.png
tags: docker
feedtitle: DigitalOcean Community Tutorials
feedurl: https://www.digitalocean.com/community/tutorials
author: DigitalOcean
---
<p><em>O autor selecionou o <a href="https://www.brightfunds.org/funds/tech-education">Tech Education Fund</a> para receber uma doação de $100 como parte do programa <a href="https://do.co/w4do-cta">Write for DOnations</a>.</em></p>

<h3 id="introdução">Introdução</h3>

<p>O <a href="http://www.webmin.com/">Webmin</a> é um painel de controle baseado na Web para qualquer máquina Linux que permite que você gerencie seu servidor através de uma interface moderna baseada em Web. Com o Webmin, você pode alterar as configurações de pacotes comuns rapidamente, incluindo servidores e bancos de dados Web, além de gerenciar pacotes de usuários, grupos e software.</p>

<p>Neste tutorial, você irá instalar e configurar o Webmin no seu servidor e garantir o acesso à interface com um certificado válido utilizando o <a href="https://letsencrypt.org/">Let&rsquo;s Encrypt</a> e o Apache. Então, você usará o Webmin para adicionar novas contas de usuário, e atualizar todos os pacotes no seu servidor a partir do painel de controle.</p>

<h2 id="pré-requisitos">Pré-requisitos</h2>

<p>Para completar este tutorial, você precisará de:</p>

<ul>
<li>Um servidor Ubuntu 18.04 configurado seguindo <a href="https://www.digitalocean.com/community/tutorials/initial-server-setup-with-ubuntu-18-04">o guia de configuração inicial do servidor Ubuntu 18.04</a>, incluindo um usuário sudo não-root e um firewall.</li>
<li>O Apache instalado seguindo o <a href="https://www.digitalocean.com/community/tutorials/how-to-install-linux-apache-mysql-php-lamp-stack-ubuntu-18-04">Como Instalar Linux, Apache, MySQL, pilha PHP (LAMP) no Ubuntu 18.04</a>. Vamos usar o Apache para executar a verificação de domínio do Let&rsquo;s Encrypt e agir como um proxy para o Webmin. Certifique-se de configurar o acesso ao Apache através do seu firewall ao seguir este tutorial.</li>
<li>Um Nome de Domínio Completamente Qualificado (FQDN), com um registro DNS <strong>A</strong> apontando para o endereço IP do seu servidor. Para configurar isso, siga o tutorial <a href="https://www.digitalocean.com/community/tutorials/how-to-set-up-a-host-name-with-digitalocean">Como Configurar um Nome de Host com o DigitalOcean</a>.</li>
<li>O Certbot instalado seguindo o Passo 1 de <a href="https://www.digitalocean.com/community/tutorials/how-to-secure-apache-with-let-s-encrypt-on-ubuntu-18-04">Como Proteger o Apache com o Let&rsquo;s Encrypt no Ubuntu 18.04</a>. Você usará o Certbot para gerar o certificado TLS/SSL para o Webmin.</li>
</ul>

<h2 id="passo-1-—-instalando-o-webmin">Passo 1 — Instalando o Webmin</h2>

<p>Primeiramente, precisamos adicionar o repositório Webmin para que possamos instalar e atualizar facilmente o Webmin utilizando nosso gerenciador de pacotes. Fazemos isso adicionando o repositório ao arquivo <code>/etc/apt/sources.list</code>.</p>

<p>Abra o arquivo no seu editor:</p>
<pre class="code-pre command"><code langs=""><ul class="prefixed"><li class="line" prefix="$">sudo nano /etc/apt/sources.list
</li></ul></code></pre>
<p>Então, adicione esta linha ao final do arquivo para adicionar o novo repositório:</p>
<div class="code-label " title="/etc/apt/sources.list">/etc/apt/sources.list</div><pre class="code-pre "><code langs="">. . . 
<span class="highlight">deb http://download.webmin.com/download/repository sarge contrib</span>
</code></pre>
<p>Salve o arquivo e saia do editor.</p>

<p>Em seguida, adicione a chave Webmin PGP para que seu sistema confie no novo repositório:</p>
<pre class="code-pre command"><code langs=""><ul class="prefixed"><li class="line" prefix="$">wget http://www.webmin.com/jcameron-key.asc
</li><li class="line" prefix="$">sudo apt-key add jcameron-key.asc
</li></ul></code></pre>
<p>Em seguida, atualize a lista de pacotes para incluir o repositório do Webmin:</p>
<pre class="code-pre command"><code langs=""><ul class="prefixed"><li class="line" prefix="$">sudo apt update 
</li></ul></code></pre>
<p>Então, instale o Webmin:</p>
<pre class="code-pre command"><code langs=""><ul class="prefixed"><li class="line" prefix="$">sudo apt install webmin 
</li></ul></code></pre>
<p>Assim que a instalação terminar, você será apresentado com o seguinte resultado:</p>
<pre class="code-pre "><code langs=""><div class="secondary-code-label " title="Output">Output</div>Webmin install complete. You can now login to 
https://<span class="highlight">your_server_ip</span>:10000 as root with your 
root password, or as any user who can use `sudo`.
</code></pre>
<p>Agora, vamos proteger o acesso ao Webmin colocando ele por trás do servidor Web Apache e adicionando um certificado TLS/SSL válido.</p>

<h2 id="passo-2-—-protegendo-o-webmin-com-o-apache-e-o-let-39-s-encrypt">Passo 2 — Protegendo o Webmin com o Apache e o Let&rsquo;s Encrypt</h2>

<p>Para acessar o Webmin, você precisa especificar a porta <code>10000</code> e garantir que a porta está aberta no seu firewall. Isso é inconveniente, especialmente se estiver acessando o Webmin utilizando um FQDN como o <code>webmin.<span class="highlight">your_domain</span></code>. Vamos usar um host virtual do Apache para pedidos de proxy no servidor do Webmin funcionando na porta <code>10000</code>. Então, vamos proteger o host virtual utilizando um certificado TLS/SSL do Let&rsquo;s Encrypt.</p>

<p>Primeiramente, crie um novo arquivo de host virtual do Apache no diretório de configuração do Apache:</p>
<pre class="code-pre command"><code langs=""><ul class="prefixed"><li class="line" prefix="$">sudo nano /etc/apache2/sites-available/<span class="highlight">your_domain</span>.conf
</li></ul></code></pre>
<p>Adicione o que vem a seguir ao arquivo, substituindo o endereço de e-mail e domínio por seus próprios:</p>
<div class="code-label " title="/etc/apache2/sites-available/your_domain.conf">/etc/apache2/sites-available/your_domain.conf</div><pre class="code-pre "><code langs="">
&lt;VirtualHost *:80&gt;
        ServerAdmin <span class="highlight">your_email</span>
        ServerName <span class="highlight">your_domain</span>
        ProxyPass / http://localhost:10000/
        ProxyPassReverse / http://localhost:10000/
&lt;/VirtualHost&gt;

</code></pre>
<p>Esta configuração diz ao Apache para passar os pedidos para <code>http://localhost:10000</code>, o servidor do Webmin. Ela também garante que os links internos gerados do Webmin também irão passar pelo Apache.</p>

<p>Salve o arquivo e saia do editor.</p>

<p>Em seguida, precisamos dizer ao Webmin para parar de usar o TLS/SSL, uma vez que o Apache irá fornecer isso para nós a partir de agora.</p>

<p>Abra o arquivo <code>/etc/webmin/miniserv.conf</code> no seu editor:</p>
<pre class="code-pre command"><code langs=""><ul class="prefixed"><li class="line" prefix="$">sudo nano /etc/webmin/miniserv.conf
</li></ul></code></pre>
<p>Encontre a seguinte linha:</p>
<div class="code-label " title="/etc/webmin/miniserv.conf">/etc/webmin/miniserv.conf</div><pre class="code-pre "><code langs="">...
ssl=1
...
</code></pre>
<p>Altere o <code>1</code> para <code>0</code>. Isto irá dizer ao Webmin para parar de usar o SSL.</p>

<p>Em seguida, vamos adicionar nosso domínio à lista de domínios permitidos, para que o Webmin compreenda que quando acessarmos o painel do nosso domínio, não é algo malicioso, como um <a href="https://www.owasp.org/index.php/Cross-site_Scripting_(XSS)">ataque Cross-Site Scripting (XSS)</a>.</p>

<p>Abra o arquivo <code>/etc/webmin/config</code> no seu editor:</p>
<pre class="code-pre command"><code langs=""><ul class="prefixed"><li class="line" prefix="$">sudo nano /etc/webmin/config
</li></ul></code></pre>
<p>Adicione a seguinte linha ao final do arquivo, substituindo o <code>your_domain</code> pelo seu domínio totalmente qualificado.</p>
<div class="code-label " title="/etc/webmin/config">/etc/webmin/config</div><pre class="code-pre "><code langs=""> . . . 
referers=<span class="highlight">your_domain</span>
</code></pre>
<p>Salve o arquivo e saia do editor.</p>

<p>Em seguida, reinicie o Webmin para aplicar as alterações de configuração:</p>
<pre class="code-pre command"><code langs=""><ul class="prefixed"><li class="line" prefix="$">sudo systemctl restart webmin
</li></ul></code></pre>
<p>Então, habilite o módulo <code>proxy_http</code> do Apache:</p>
<pre class="code-pre command"><code langs=""><ul class="prefixed"><li class="line" prefix="$">sudo a2enmod proxy_http
</li></ul></code></pre>
<p>Você verá o seguinte resultado:</p>
<pre class="code-pre "><code langs=""><div class="secondary-code-label " title="Output">Output</div>Considering dependency proxy for proxy_http:
Enabling module proxy.
Enabling module proxy_http.
To activate the new configuration, you need to run:
  systemctl restart apache2
</code></pre>
<p>O resultado sugere que você reinicie o Apache, mas primeiro, ative o novo host virtual do Apache que você criou:</p>
<pre class="code-pre command"><code langs=""><ul class="prefixed"><li class="line" prefix="$">sudo a2ensite <span class="highlight">your_domain</span>
</li></ul></code></pre>
<p>Você verá o seguinte resultado indicando que seu site está ativo:</p>
<pre class="code-pre "><code langs=""><div class="secondary-code-label " title="Output">Output</div>Enabling site <span class="highlight">your_domain</span>.
To activate the new configuration, you need to run:
  systemctl reload apache2
</code></pre>
<p>Agora, reinicie o Apache completamente para ativar o módulo <code>proxy_http</code> e o novo host virtual:</p>
<pre class="code-pre command"><code langs=""><ul class="prefixed"><li class="line" prefix="$">sudo systemctl restart apache2
</li></ul></code></pre>
<p><span class='note'><strong>Nota</strong>: Certifique-se de que você permite o tráfego de entrada para seu servidor Web na porta <code>80</code> e na porta <code>443</code> como mostrado no tutorial pré-requisito <a href="https://www.digitalocean.com/community/tutorials/how-to-install-linux-apache-mysql-php-lamp-stack-ubuntu-18-04">Como Instalar Linux, MySQL, pilha PHP (LAMP) no Ubuntu 18.04</a>. Você pode fazer isso com o comando <code>sudo ufw allow in "Apache Full"</code>.<br></span></p>

<p>Navegue para <code>http://<span class="highlight">your_domain</span></code> no seu navegador, e você verá a página de login do Webmin aparecer.</p>

<p><span class='warning'><strong>Aviso</strong>: NÃO logue no Webmin ainda, pois ainda não habilitamos o SSL. Se você entrar agora, suas credenciais serão enviadas para o servidor em sem proteção.<br></span></p>

<p>Agora, vamos configurar um certificado para que sua conexão esteja criptografada enquanto usar o Webmin. Para fazer isso, vamos usar o Let&rsquo;s Encrypt.</p>

<p>Diga ao Certbot para gerar um certificado TLS/SSL para seu domínio e configurar o Apache para redirecionar o tráfego para o site seguro:</p>
<pre class="code-pre command"><code langs=""><ul class="prefixed"><li class="line" prefix="$">sudo certbot --apache --email <span class="highlight">your_email</span> -d <span class="highlight">your_domain</span> --agree-tos --redirect --noninteractive
</li></ul></code></pre>
<p>Você verá o seguinte resultado:</p>
<pre class="code-pre "><code langs=""><div class="secondary-code-label " title="Output">Output</div>Saving debug log to /var/log/letsencrypt/letsencrypt.log
Plugins selected: Authenticator apache, Installer apache
Obtaining a new certificate
Performing the following challenges:
http-01 challenge for <span class="highlight">your_domain</span>
Enabled Apache rewrite module
Waiting for verification...
Cleaning up challenges
Created an SSL vhost at /etc/apache2/sites-available/<span class="highlight">your_domain</span>-le-ssl.conf
Enabled Apache socache_shmcb module
Enabled Apache ssl module
Deploying Certificate to VirtualHost /etc/apache2/sites-available/<span class="highlight">your_domain</span>-le-ssl.conf
Enabling available site: /etc/apache2/sites-available/<span class="highlight">your_domain</span>-le-ssl.conf
Enabled Apache rewrite module
Redirecting vhost in /etc/apache2/sites-enabled/<span class="highlight">your_domain</span>.conf to ssl vhost in /etc/apache2/sites-available/<span class="highlight">your_domain</span>-le-ssl.conf

-------------------------------------------------------------------------------
Congratulations! You have successfully enabled https://<span class="highlight">your_domain</span>

You should test your configuration at:
https://www.ssllabs.com/ssltest/analyze.html?d=<span class="highlight">your_domain</span>
-------------------------------------------------------------------------------
</code></pre>
<p>O resultado indica que o certificado foi instalado e o Apache está configurado para redirecionar pedidos do <code>http://<span class="highlight">your_domain</span></code> para <code>https://<span class="highlight">your_domain</span></code>.</p>

<p>Agora, você configurou uma instância segura e funcional do Webmin. Vamos ver como usá-lo.</p>

<h2 id="passo-3-—-usando-o-webmin">Passo 3 — Usando o Webmin</h2>

<p>O Webmin tem módulos que podem controlar tudo do Servidor BIND DNS, até algo tão simples quanto adicionar usuários ao sistema. Vamos ver como criar um novo usuário, e então explorar como atualizar pacotes de software utilizando o Webmin.</p>

<p>Para fazer login no Webmin, navegue até <code>http://<span class="highlight">your_domain</span></code> e entre com o usuário <strong>root</strong> ou um usuário com privilégios sudo.</p>

<h3 id="gerenciando-usuários-e-grupos">Gerenciando Usuários e Grupos</h3>

<p>Vamos gerenciar os usuários e os grupos no servidor.</p>

<p>Primeiramente, clique na página <strong>System</strong>, e então clique no botão <strong>Users and Groups</strong>. A partir daqui, você pode adicionar um usuário, gerenciar um usuário, ou adicionar ou gerenciar um grupo.</p>

<p>Vamos criar um novo usuário chamado <strong>deploy</strong> que possa ser usado para hospedar aplicativos Web. Para adicionar um usuário, clique em <strong>Create a new user</strong>, que está localizado no topo da tabela de usuários. Isso mostra a *<em>tela *</em>Create User, onde você pode fornecer o nome de usuário, senha, grupos e outras opções. Siga essas instruções para criar o usuário:</p>

<ol>
<li>Preencha o <strong>Username</strong> com <code>deploy</code>.</li>
<li>Selecione <strong>Automatic</strong> para o <strong>User ID</strong>.</li>
<li>Preencha o <strong>Real Name</strong> com um nome descritivo como <code>Deployment user</code>.</li>
<li>Para o <strong>Home Directory</strong>, selecione <strong>Automatic</strong>.</li>
<li>Para ***<em>o Shell, selecione *</em>/bin/bash **da lista suspensa.</li>
<li>Para o <strong>Password</strong>, selecione <strong>Normal Password</strong> e digite uma senha da sua escolha.</li>
<li>Para o <strong>Primary Group</strong>, selecione <strong>New group with same name as user</strong>.</li>
<li>Para o <strong>Secondary Group</strong>, selecione <strong>sudo</strong> da lista <strong>All groups</strong>, e pressione o botão <strong>-&gt;</strong> para adicionar o grupo na lista <strong>in groups</strong>.</li>
<li>Pressione <strong>Create</strong> para criar este novo usuário.</li>
</ol>

<p>Ao criar um usuário, você pode definir as opções para expiração de senha, a shell do usuário, ou se eles tem permissão para um diretório home.</p>

<p>Em seguida, vamos ver como instalar as atualizações no nosso sistema.</p>

<h3 id="atualizando-pacotes">Atualizando Pacotes</h3>

<p>O Webmin permite que você atualize todos os seus pacotes através da interface de usuário. Para atualizar todos os seus pacotes, clique no link <strong>Dashboard</strong>, e então, localize o campo <strong>Package updates</strong>. Se houver atualizações disponíveis, você verá um link que indica o número de atualizações disponíveis, como mostrado na figura a seguir:</p>

<p><img src="https://assets.digitalocean.com/articles/webmin1804/RF2fRmB.png" alt="Webmin shows the number of package updates available"></p>

<p>Clique neste link, e então pressione *<em>Update selected packages *</em>para iniciar a atualização. Você pode ser solicitado a reiniciar o servidor, que você também pode fazer através da interface do Webmin.</p>

<h2 id="conclusão">Conclusão</h2>

<p>Agora, você tem uma instância segura e funcional do Webmin e você usou a interface para criar um usuário e atualizar pacotes. O Webmin te dá acesso a muitas coisas de que você normalmente precisaria acessar através do console, e ele organiza-as de maneira intuitiva. Por exemplo, se tiver o Apache instalado, você encontraria a página de configuração dele sob <strong>Servers</strong>, e então <strong>Apache</strong>.</p>

<p>Explore a interface ainda mais, ou examine a <a href="http://doxfer.webmin.com/Webmin/Main_Page">Official Webmin wiki</a> para aprender mais sobre gerenciamento do seu sistema com o Webmin.</p>
