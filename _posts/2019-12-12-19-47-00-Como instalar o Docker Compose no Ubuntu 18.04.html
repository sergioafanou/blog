---
layout: post
title: Como instalar o Docker Compose no Ubuntu 18.04
network: digitalocean
date: December 12, 2019 at 07:47PM
url: https://www.digitalocean.com/community/tutorials/how-to-install-docker-compose-on-ubuntu-18-04-pt
image: http://ifttt.com/images/no_image_card.png
tags: docker
feedtitle: DigitalOcean Community Tutorials
feedurl: https://www.digitalocean.com/community/tutorials
author: DigitalOcean
---
<h3 id="introdução">Introdução</h3>

<p><a href="https://docs.docker.com/">O Docker</a> é uma ótima ferramenta para automatizar a implantação de aplicativos Linux dentro de contêineres de software, mas para tirar total vantagem deste potencial, cada componente de um aplicativo deve executar em seu próprio contêiner individual. Para aplicativos complexos com vários componentes, orquestrar todos os contêineres para iniciar, comunicar e fechar ao mesmo tempo pode se tornar algo rapidamente complicado.</p>

<p>A comunidade do Docker surgiu com uma solução popular chamada <a href="http://www.fig.sh/">Fig</a>, que permitiu o uso de um arquivo único YAML para orquestrar todos os seus contêineres e configurações do Docker. Ele se tornou tão popular que a equipe do Docker decidiu fazer o <em>Docker Compose</em> baseado na fonte Fig, que agora está descontinuada. O Docker Compose facilita o funcionamento dos processos dos contêineres do Docker para os usuários, incluindo a inicialização, o desligamento e a configuração de ligação intra-contêineres e volumes.</p>

<p>Neste tutorial, mostraremos como instalar a última versão do Docker Compose para ajudar a gerenciar aplicativos multi-contêiner</p>

<h2 id="pré-requisitos">Pré-requisitos</h2>

<p>Para seguir este artigo, será necessário um servidor Ubuntu 18.04, com o seguinte:</p>

<ul>
<li>Um usuário sem <strong>root</strong> com privilégios sudo (<a href="https://www.digitalocean.com/community/tutorials/initial-server-setup-with-ubuntu-18-04">A configuração inicial do servidor com o Ubuntu 18.04</a>e xplica como configurar isso.)</li>
<li>O Docker instalado com as instruções do <strong>Passo 1</strong> e o <strong>Passo 2</strong> do <a href="https://www.digitalocean.com/community/tutorials/how-to-install-and-use-docker-on-ubuntu-18-04">Como instalar e utilizar o Docker no Ubuntu 18.04</a></li>
</ul>

<p>Uma vez que eles estejam funcionando, você pode continuar.</p>

<p><span class='note'><strong>Nota:</strong> Embora os pré-requisitos dêem instruções para instalar o Docker no Ubuntu 18.04, os comandos do <code>docker</code> neste artigo devem funcionar em outros sistemas operacionais, desde que o Docker esteja instalado.<br></span></p>

<h2 id="passo-1-—-como-instalar-o-docker-compose">Passo 1 — Como instalar o Docker Compose</h2>

<p>Embora possamos instalar o Docker Compose a partir dos repositórios oficiais do Ubuntu, ele está várias versões menores atrás do último lançamento, então vamos instalar o Docker Compose do repositório do GitHub do Docker. O comando abaixo é ligeiramente diferente daquele que você encontrará na página dos <a href="https://github.com/docker/compose/releases">Lançamentos</a>. Use a flag <code>-o</code> para especificar o arquivo de saída primeiro ao invés de redirecionar a saída, essa sintaxe evita executar um erro de autorização negada causada ao usar o <code>sudo</code>.</p>

<p>Vamos verificar o <a href="https://github.com/docker/compose/releases">lançamento atual</a> e, se necessário, atualizá lo no comando abaixo:</p>
<pre class="code-pre command"><code langs=""><ul class="prefixed"><li class="line" prefix="$">sudo curl -L https://github.com/docker/compose/releases/download/<span class="highlight">1.21.2</span>/docker-compose-`uname -s`-`uname -m` -o /usr/local/bin/docker-compose
</li></ul></code></pre>
<p>Em seguida, vamos definir as permissões:</p>
<pre class="code-pre command"><code langs=""><ul class="prefixed"><li class="line" prefix="$">sudo chmod +x /usr/local/bin/docker-compose
</li></ul></code></pre>
<p>Então, vamos verificar se a instalação foi bem sucedida verificando a versão:</p>
<pre class="code-pre command"><code langs=""><ul class="prefixed"><li class="line" prefix="$">docker-compose --version
</li></ul></code></pre>
<p>Isso aparecerá na tela a versão que instalamos:</p>
<pre class="code-pre "><code langs=""><div class="secondary-code-label " title="Output">Output</div>docker-compose version <span class="highlight">1.21.2</span>, build a133471
</code></pre>
<p>Agora que temos o Docker Compose instalado, estamos prontos para executar um exemplo &ldquo;Hello World&rdquo;.</p>

<h2 id="passo-2-—-como-executar-um-contêiner-com-o-docker-compose">Passo 2 — Como executar um Contêiner com o Docker Compose</h2>

<p>O registro público do Docker, o Docker Hub, inclui uma imagem do <em>Hello World</em> para demonstração e teste. Ele ilustra a configuração mínima necessária para executar um contêiner utilizando o Docker Compose: um arquivo YAML que chama uma única imagem:</p>

<p>Primeiramente, vamos criar um diretório para o arquivo YAML e mover para ele:</p>
<pre class="code-pre command"><code langs=""><ul class="prefixed"><li class="line" prefix="$">mkdir hello-world
</li><li class="line" prefix="$">cd hello-world
</li></ul></code></pre>
<p>Então, vamos criar o arquivo YAML:</p>
<pre class="code-pre command"><code langs=""><ul class="prefixed"><li class="line" prefix="$">nano docker-compose.yml
</li></ul></code></pre>
<p>Coloque o seguinte conteúdo no arquivo, salve o arquivo e saia do editor de texto:</p>
<div class="code-label " title="docker-compose.yml">docker-compose.yml</div><pre class="code-pre "><code langs="">my-test:
 image: hello-world
</code></pre>
<p>A primeira linha no arquivo YAML é usada como parte do nome do contêiner. A segunda linha especifica qual imagem usar para criar o contêiner. Quando executarmos o comando <code>docker-compose up</code> ele irá procurar uma imagem local pelo nome que especificamos, <code>hello-world</code>. Com isso funcionando, vamos salvar e sair do arquivo.</p>

<p>Podemos ver as imagens manualmente no nosso sistema com o comando <code>docker images</code>:</p>
<pre class="code-pre command"><code langs=""><ul class="prefixed"><li class="line" prefix="$">docker images
</li></ul></code></pre>
<p>Quando não houverem imagens locais, apenas os títulos das colunas são exibidos:</p>
<pre class="code-pre "><code langs=""><div class="secondary-code-label " title="Output">Output</div>REPOSITORY          TAG                 IMAGE ID            CREATED             SIZE
</code></pre>
<p>Enquanto ainda estiver no diretório <code>~/hello-world</code> , vamos executar o seguinte comando:</p>
<pre class="code-pre command"><code langs=""><ul class="prefixed"><li class="line" prefix="$">docker-compose up
</li></ul></code></pre>
<p>A primeira vez que executarmos o comando, se não houver uma imagem local chamada <code>hello-world</code>, o Docker Compose irá puxá-la do repositório público do Docker Hub:</p>
<pre class="code-pre "><code langs=""><div class="secondary-code-label " title="Output">Output</div>Pulling my-test (hello-world:latest)...
latest: Pulling from library/hello-world
c04b14da8d14: Downloading [==================================================&gt;] c04b14da8d14: Extracting [==================================================&gt;]  c04b14da8d14: Extracting [==================================================&gt;]  c04b14da8d14: Pull complete
Digest: sha256:0256e8a36e2070f7bf2d0b0763dbabdd67798512411de4cdcf9431a1feb60fd9
Status: Downloaded newer image for hello-world:latest
. . .
</code></pre>
<p>Após puxar a imagem, o <code>docker-compose</code> cria um contêiner, anexa e executa o programa <a href="https://github.com/docker-library/hello-world/blob/85fd7ab65e079b08019032479a3f306964a28f4d/hello-world/Dockerfile">hello</a>, que por sua vez confirma que a instalação parece estar funcionando:</p>
<pre class="code-pre "><code langs=""><div class="secondary-code-label " title="Output">Output</div>. . .
Creating helloworld_my-test_1...
Attaching to helloworld_my-test_1
my-test_1 |
my-test_1 | Hello from Docker.
my-test_1 | This message shows that your installation appears to be working correctly.
my-test_1 |
. . .
</code></pre>
<p>Em seguida ele mostra na tela uma explicação do que ele fez:</p>
<pre class="code-pre "><code langs=""><div class="secondary-code-label " title="Output of docker-compose up">Output of docker-compose up</div>1. The Docker client contacted the Docker daemon.
2. The Docker daemon pulled the "hello-world" image from the Docker Hub.
3. The Docker daemon created a new container from that image which runs the executable that produces the output you are currently reading.
4. The Docker daemon streamed that output to the Docker client, which sent it to your terminal.
</code></pre>
<p>Os contêineres do Docker apenas funcionam enquanto o comando estiver ativo, então assim que o <code>hello</code> terminar de executar, o contêiner para. Consequentemente, quando olharmos os processos ativos, os cabeçalhos das colunas irão aparecer, mas o contêiner <code>hello-world</code> não estará listado porque ele não está funcionando.</p>
<pre class="code-pre command"><code langs=""><ul class="prefixed"><li class="line" prefix="$">docker ps
</li></ul></code></pre><pre class="code-pre "><code langs=""><div class="secondary-code-label " title="Output">Output</div>CONTAINER ID        IMAGE               COMMAND             CREATED             STATUS                      PORTS               NAMES
</code></pre>
<p>Podemos ver as informações do contêiner que vamos precisar no próximo passo, utilizando a flag <code>-a</code>, que mostra todos os contêineres, não apenas os ativos:</p>
<pre class="code-pre command"><code langs=""><ul class="prefixed"><li class="line" prefix="$">docker ps -a
</li></ul></code></pre><pre class="code-pre "><code langs=""><div class="secondary-code-label " title="Output">Output</div>CONTAINER ID        IMAGE               COMMAND             CREATED             STATUS                      PORTS               NAMES
06069fd5ca23        hello-world         "/hello"            35 minutes ago      Exited (0) 35 minutes ago                       drunk_payne
</code></pre>
<p>Isso mostra as informações que precisaremos remover do contêiner quando terminarmos com ele.</p>

<h2 id="passo-3-—-como-remover-a-imagem-opcional">Passo 3 — Como remover a imagem (opcional)</h2>

<p>Para evitar usar espaço de disco desnecessário, vamos remover a imagem local. Para fazer isso, precisaremos deletar todos os contêineres que referem a imagem utilizando o comando <code>docker rm</code>, seguido ou do ID do CONTÊINER ou do NOME. Abaixo, estamos usando a ID do CONTÊINER pelo comando <code>docker ps -a</code> que acabamos de executar. Certifique-se de substituir a ID do seu contêiner:</p>
<pre class="code-pre command"><code langs=""><ul class="prefixed"><li class="line" prefix="$">docker rm <span class="highlight">06069fd5ca23</span>
</li></ul></code></pre>
<p>Assim que todos os contêineres que fizerem referência a imagem forem removidos, poderemos remover a imagem:</p>
<pre class="code-pre command"><code langs=""><ul class="prefixed"><li class="line" prefix="$">docker rmi hello-world
</li></ul></code></pre>
<h2 id="conclusão">Conclusão</h2>

<p>Agora, instalamos o Docker Compose, testamos nossa instalação executando um exemplo do Hello World e removemos a imagem e contêiner de teste.</p>

<p>Enquanto o exemplo do Hello World confirmou nossa instalação, a configuração simples não mostra um dos principais benefícios do Docker Compose — poder trazer um grupo de contêineres do Docker para cima e para baixo, todos ao mesmo tempo. Para ver o poder do Docker Compose em ação, será possível verificar este exemplo prático em <a href="https://www.digitalocean.com/community/tutorials/how-to-configure-a-continuous-integration-testing-environment-with-docker-and-docker-compose-on-ubuntu-16-04">Como configurar um meio de teste de integração contínuo com o Docker e o Docker Compose no Ubuntu 16.04</a> <em>(nota: este artigo é para o Ubuntu 16.04)</em></p>
