---
layout: post
title: Установка и обеспечение безопасности Redis в Ubuntu 18.04
network: digitalocean
date: January 07, 2020 at 07:33PM
url: https://www.digitalocean.com/community/tutorials/how-to-install-and-secure-redis-on-ubuntu-18-04-ru
image: http://ifttt.com/images/no_image_card.png
tags: docker
feedtitle: DigitalOcean Community Tutorials
feedurl: https://www.digitalocean.com/community/tutorials
author: DigitalOcean
---
<p><em>Предыдущая версия данного обучающего руководства была написана <a href="https://www.digitalocean.com/community/users/jellingwood">Джастином Эллингвудом</a></em></p>

<h3 id="Введение">Введение</h3>

<p><a href="https://redis.io/">Redis</a> — это быстрое хранилище данных типа «ключ‑значение», известное своей гибкостью, производительностью и широким выбором поддерживаемых языков. В этом руководстве описывается установка, настройка и обеспечение безопасности Redis на сервере Ubuntu 18.04.</p>

<h2 id="Предварительные-требования">Предварительные требования</h2>

<p>Для выполнения данного руководства вам потребуется сервер Ubuntu 18.04 с пользователем без прав root с привилегиями <code>sudo</code> и брандмауэром с базовой конфигурацией. Вы можете выполнить настройку с помощью нашего руководства по <a href="https://www.digitalocean.com/community/tutorials/initial-server-setup-with-ubuntu-18-04">первоначальной настройке сервера</a>.</p>

<p>​​Когда все будет готово, выполните вход на сервер Ubuntu 18.04 с помощью пользователя с правами <code>sudo</code> и продолжите выполнять дальнейшие инструкции.</p>

<h2 id="Шаг-1-—-Установка-и-настройка-redis">Шаг 1 — Установка и настройка Redis</h2>

<p>Чтобы получить последнюю версию Redis, мы будем использовать <code>apt</code> для установки из официальных репозиториев Ubuntu.</p>

<p>Обновите локальный кэш пакета <code>apt</code> и установите Redis с помощью следующей команды:</p>
<pre class="code-pre command"><code langs=""><ul class="prefixed"><li class="line" prefix="$">sudo apt update
</li><li class="line" prefix="$">sudo apt install redis-server
</li></ul></code></pre>
<p>После этого будет выполнена загрузка и установка Redis и ее зависимостей. После этого в файл конфигурации Redis, созданный автоматически при установке, необходимо внести одно важное изменение.</p>

<p>Откройте этот файл в предпочитаемом текстовом редакторе:</p>
<pre class="code-pre command"><code langs=""><ul class="prefixed"><li class="line" prefix="$">sudo nano /etc/redis/redis.conf
</li></ul></code></pre>
<p>Внутри файла найдите директиву <code>supervised</code>. Эта директива позволяет объявить систему инициализации для управления Redis как службой, предоставляя вам более широкий контроль за ее работой. Для директивы <code>supervised</code> по умолчанию установлено значение <code>no</code>. Поскольку вы запускаете Ubuntu, которая использует систему инициализации systemd, измените значение на <code>systemd</code>:</p>
<div class="code-label " title="/etc/redis/redis.conf">/etc/redis/redis.conf</div><pre class="code-pre "><code langs="">. . .

# If you run Redis from upstart or systemd, Redis can interact with your
# supervision tree. Options:
#   supervised no      - no supervision interaction
#   supervised upstart - signal upstart by putting Redis into SIGSTOP mode
#   supervised systemd - signal systemd by writing READY=1 to $NOTIFY_SOCKET
#   supervised auto    - detect upstart or systemd method based on
#                        UPSTART_JOB or NOTIFY_SOCKET environment variables
# Note: these supervision methods only signal "process is ready."
#       They do not enable continuous liveness pings back to your supervisor.
supervised <span class="highlight">systemd</span>

. . .
</code></pre>
<p>Это единственное изменение, которое вам нужно внести в файл конфигурации Redis на данный момент,поэтому сохраните и закройте его после завершения редактирования. Перезапустите службу Redis, чтобы изменения в файле конфигурации вступили в силу:</p>
<pre class="code-pre command"><code langs=""><ul class="prefixed"><li class="line" prefix="$">sudo systemctl restart redis.service
</li></ul></code></pre>
<p>После этого установка и настройка Redis будет закончена, и вы можете запускать его на вашем компьютере. Перед началом использования Redis рекомендуется сначала проверить корректность работы системы.</p>

<h2 id="Шаг-2-—-Тестирование-redis">Шаг 2 — Тестирование Redis</h2>

<p>Как и с любым вновь устанавливаемым программным обеспечением, лучше убедиться, что Redis работает ожидаемым образом перед внесением дальнейших изменений в конфигурацию. Мы пройдемся по целому ряду способов, которые позволяют убедиться, что Redis работает правильно.</p>

<p>Сначала проверьте, что служба Redis запущена:</p>
<pre class="code-pre command"><code langs=""><ul class="prefixed"><li class="line" prefix="$">sudo systemctl status redis
</li></ul></code></pre>
<p>Если она запускается без ошибок, при вводе данной команды вы должны получить примерно следующий результат:</p>
<pre class="code-pre "><code langs=""><div class="secondary-code-label " title="Output">Output</div>● redis-server.service - Advanced key-value store
   Loaded: loaded (/lib/systemd/system/redis-server.service; enabled; vendor preset: enabled)
   Active: active (running) since Wed 2018-06-27 18:48:52 UTC; 12s ago
     Docs: http://redis.io/documentation,
           man:redis-server(1)
  Process: 2421 ExecStop=/bin/kill -s TERM $MAINPID (code=exited, status=0/SUCCESS)
  Process: 2424 ExecStart=/usr/bin/redis-server /etc/redis/redis.conf (code=exited, status=0/SUCCESS)
 Main PID: 2445 (redis-server)
    Tasks: 4 (limit: 4704)
   CGroup: /system.slice/redis-server.service
           └─2445 /usr/bin/redis-server 127.0.0.1:6379
. . .
</code></pre>
<p>Здесь вы можете видеть, что служба Redis запущена и уже активирована, т.е. для нее настроен запуск при загрузке сервера.</p>

<span class='note'><p>
<strong>Примечание:</strong> данную опцию рекомендуется использовать во многих стандартных случаях использования Redis. Однако если вы предпочитаете запускать Redis каждый раз вручную при загрузке сервера, воспользуйтесь следующей командой:</p>
<pre class="code-pre command"><code langs=""><ul class="prefixed"><li class="line" prefix="$">sudo systemctl disable redis
</li></ul></code></pre>
<p></p></span>

<p>Чтобы убедиться, что Redis работает правильно, подключитесь к серверу с помощью клиента командной строки:</p>
<pre class="code-pre command"><code langs=""><ul class="prefixed"><li class="line" prefix="$">redis-cli
</li></ul></code></pre>
<p>В появившемся диалоговом окне протестируйте подключение с помощью команды <code>ping</code>:</p>
<pre class="code-pre custom_prefix"><code langs=""><ul class="prefixed"><li class="line" prefix="127.0.0.1:6379&gt;">ping
</li></ul></code></pre><pre class="code-pre "><code langs=""><div class="secondary-code-label " title="Output">Output</div>PONG
</code></pre>
<p>Данный вывод подтверждает, что подключение сервера активно. Затем проверьте, что вы можете задать ключи:</p>
<pre class="code-pre custom_prefix"><code langs=""><ul class="prefixed"><li class="line" prefix="127.0.0.1:6379&gt;">set test "It's working!"
</li></ul></code></pre><pre class="code-pre "><code langs=""><div class="secondary-code-label " title="Output">Output</div>OK
</code></pre>
<p>Запросите значение с помощью следующей команды:</p>
<pre class="code-pre custom_prefix"><code langs=""><ul class="prefixed"><li class="line" prefix="127.0.0.1:6379&gt;">get test
</li></ul></code></pre>
<p>Если все работает корректно, вы получите сохраненное значение:</p>
<pre class="code-pre "><code langs=""><div class="secondary-code-label " title="Output">Output</div>"It's working!"
</code></pre>
<p>Убедившись, что вы можете получить значение, закройте диалоговое окно Redis и вернитесь в командную строку:</p>
<pre class="code-pre custom_prefix"><code langs=""><ul class="prefixed"><li class="line" prefix="127.0.0.1:6379&gt;">exit
</li></ul></code></pre>
<p>В качестве последнего теста мы проверим, может ли Redis сохранять данные даже после остановки или перезапуска. Для этого необходимо перезапустить Redis:</p>
<pre class="code-pre command"><code langs=""><ul class="prefixed"><li class="line" prefix="$">sudo systemctl restart redis
</li></ul></code></pre>
<p>Откройте клиент командной строки и проверьте, что ваше тестовое значение все еще доступно:</p>
<pre class="code-pre command"><code langs=""><ul class="prefixed"><li class="line" prefix="$">redis-cli
</li></ul></code></pre><pre class="code-pre custom_prefix"><code langs=""><ul class="prefixed"><li class="line" prefix="127.0.0.1:6379&gt;">get test
</li></ul></code></pre>
<p>Значение вашего ключа должно оставаться доступным:</p>
<pre class="code-pre "><code langs=""><div class="secondary-code-label " title="Output">Output</div>"It's working!"
</code></pre>
<p>Выйдите в командную строку после завершения:</p>
<pre class="code-pre custom_prefix"><code langs=""><ul class="prefixed"><li class="line" prefix="127.0.0.1:6379&gt;">exit
</li></ul></code></pre>
<p>После этого установку Redis можно считать выполненной и готовой к работе. Однако некоторые настройки по умолчанию являются небезопасными и предоставляют злоумышленникам возможность атаковать ваш сервер и получить доступ к <a href="http://redis.io/topics/security">данным.Остальные шаги в этом руководстве описывают методы для устранения этих факторов уязвимости, как указано на официальном веб-сайте Redis</a>. Хотя эти шаги не являются обязательными, и Redis будет функционировать, если вы решите не выполнять эти действия, но <em>мы настоятельно</em> рекомендуем вам выполнить описанные ниже шаги, чтобы повысить безопасность вашей системы.</p>

<h2 id="Шаг-3-—-Привязка-к-localhost">Шаг 3 — Привязка к localhost</h2>

<p>По умолчанию доступ к Redis осуществляется только из <strong>localhost</strong>. Если вы установили и настроили Redis с помощью другого руководства, вы могли обновить файл конфигурации, чтобы разрешить подключение из любого места. Подобный подход менее безопасен, чем привязка к <strong>localhost</strong>.</p>

<p>Чтобы исправить это, откройте файл конфигурации Redis для редактирования:</p>
<pre class="code-pre command"><code langs=""><ul class="prefixed"><li class="line" prefix="$">sudo nano /etc/redis/redis.conf
</li></ul></code></pre>
<p>Найдите эту строку и убедитесь, что она незакомментирована (удалите символ <code>#</code>, если он существует):</p>
<div class="code-label " title="/etc/redis/redis.conf">/etc/redis/redis.conf</div><pre class="code-pre "><code langs="">bind 127.0.0.1 ::1
</code></pre>
<p>Сохраните и закройте файл после завершения (нажмите <code>CTRL + X</code>, <code>Y</code>, затем <code>ENTER</code>).</p>

<p>Затем перезапустите службу, чтобы systemd распознала изменения:</p>
<pre class="code-pre command"><code langs=""><ul class="prefixed"><li class="line" prefix="$">sudo systemctl restart redis
</li></ul></code></pre>
<p>Чтобы убедиться, что изменение вступило в силу, запустите следующую команду <code>netstat</code>:</p>
<pre class="code-pre command"><code langs=""><ul class="prefixed"><li class="line" prefix="$">sudo netstat -lnp | grep redis
</li></ul></code></pre><pre class="code-pre "><code langs=""><div class="secondary-code-label " title="Output">Output</div>tcp        0      0 127.0.0.1:6379          0.0.0.0:*               LISTEN      14222/redis-server  
tcp6       0      0 ::1:6379                :::*                    LISTEN      14222/redis-server  
</code></pre>
<p>Данный вывод указывает, что программа <code>redis-server</code> привязана к <strong>localhost</strong> (<code>127.0.0.1</code>), отражая изменения, которые вы только что внесли в файл конфигурации. Если вы увидите другой IP-адрес в этой колонке (например, <code>0.0.0.0</code>), вам нужно еще раз проверить, что вы не закомментировали нужную строку и перезапустить службу Redis.</p>

<p>Теперь, когда Redis использует только <strong>localhost</strong>, злоумышленникам будет труднее выполнять запросы или получить доступ к вашему серверу. Однако для Redis в настоящее время не настроено требование аутентификации пользователей перед внесением изменений в конфигурацию или данные, которые она хранит. Чтобы исправить это, Redis позволяет настроить требование аутентификации с помощью пароля перед внесением изменений через клиент Redis (<code>redis-cli</code>).</p>

<h2 id="Шаг-4-—-Настройка-пароля-redis">Шаг 4 — Настройка пароля Redis</h2>

<p>Настройка пароля Redis позволяет использовать одну из двух встроенных функций безопасности — команду <code>auth</code>, которая требует аутентификации клиентов для доступа к базе данных. Пароль настраивается непосредственно в файле конфигурации Redis, <code>/etc/redis/redis.conf</code>, поэтому вам нужно снова открыть этот файл в предпочитаемом редакторе:</p>
<pre class="code-pre command"><code langs=""><ul class="prefixed"><li class="line" prefix="$">sudo nano /etc/redis/redis.conf
</li></ul></code></pre>
<p>Прокрутите содержимое файла до раздела <code>SECURITY</code> и найдите следующую закомментированную директиву:</p>
<div class="code-label " title="/etc/redis/redis.conf">/etc/redis/redis.conf</div><pre class="code-pre "><code langs=""># requirepass foobared
</code></pre>
<p>Разкомментируйте ее, удалив символ <code>#</code> и измените <code>foobared</code> на безопасный пароль.</p>

<span class='note'><p>
<strong>Примечание:</strong> над директивой <code>requirepass</code> в файле <code>redis.conf</code> располагается закомментированное предупреждение:</p>
<pre class="code-pre "><code langs=""># Warning: since Redis is pretty fast an outside user can try up to
# 150k passwords per second against a good box. This means that you should
# use a very strong password otherwise it will be very easy to break.
#
</code></pre>
<p>Таким образом, очень важно, чтобы вы указали очень надежный и очень длинный пароль. Вместо того чтобы придумать пароль самостоятельно, вы можете использовать команду <code>openssl</code> для генерации случайного пароля, как в следующем примере. Использовав вывод первой команды во второй команде <code>openssl</code>, как показано здесь, вы сможете удалить любые переносы строк, созданные при выполнении первой команды:</p>
<pre class="code-pre command"><code langs=""><ul class="prefixed"><li class="line" prefix="$">openssl rand 60 | openssl base64 -A
</li></ul></code></pre>
<p>Вывод должен выглядеть следующим образом:</p>
<pre class="code-pre "><code langs=""><div class="secondary-code-label " title="Output">Output</div>RBOJ9cCNoGCKhlEBwQLHri1g+atWgn4Xn4HwNUbtzoVxAYxkiYBi7aufl4MILv1nxBqR4L6NNzI0X6cE
</code></pre>
<p>Скопируйте и вставьте вывод этой команды в качестве нового значения для <code>requirepass</code>. Оно должно выглядеть следующим образом:</p>
<pre class="code-pre "><code langs=""><div class="secondary-code-label " title="/etc/redis/redis.conf">/etc/redis/redis.conf</div>requirepass <span class="highlight">RBOJ9cCNoGCKhlEBwQLHri1g+atWgn4Xn4HwNUbtzoVxAYxkiYBi7aufl4MILv1nxBqR4L6NNzI0X6cE</span>
</code></pre>
<p></p></span>

<p>После установки пароля сохраните и закройте файл, а потом перезапустите Redis:</p>
<pre class="code-pre command"><code langs=""><ul class="prefixed"><li class="line" prefix="$">sudo systemctl restart redis.service
</li></ul></code></pre>
<p>Чтобы убедиться, что пароль работает, откройте командную строку Redis:</p>
<pre class="code-pre command"><code langs=""><ul class="prefixed"><li class="line" prefix="$">redis-cli
</li></ul></code></pre>
<p>Ниже показана последовательность команд, используемых для проверки работы пароля Redis. Первая команда пытается задать ключ для значения перед аутентификацией:</p>
<pre class="code-pre custom_prefix"><code langs=""><ul class="prefixed"><li class="line" prefix="127.0.0.1:6379&gt;">set key1 10
</li></ul></code></pre>
<p>Это не сработает, потому что вы не выполнили аутентификацию, поэтому Redis возвращает ошибку:</p>
<pre class="code-pre "><code langs=""><div class="secondary-code-label " title="Output">Output</div>(error) NOAUTH Authentication required.
</code></pre>
<p>Следующая команда выполняет аутентификацию с паролем, указанным в файле конфигурации Redis:</p>
<pre class="code-pre custom_prefix"><code langs=""><ul class="prefixed"><li class="line" prefix="127.0.0.1:6379&gt;">auth <span class="highlight">your_redis_password</span>
</li></ul></code></pre>
<p>Redis принимает пароль:</p>
<pre class="code-pre "><code langs=""><div class="secondary-code-label " title="Output">Output</div>OK
</code></pre>
<p>После этого запуск предыдущей команды будет успешным:</p>
<pre class="code-pre custom_prefix"><code langs=""><ul class="prefixed"><li class="line" prefix="127.0.0.1:6379&gt;">set key1 10
</li></ul></code></pre><pre class="code-pre "><code langs=""><div class="secondary-code-label " title="Output">Output</div>OK
</code></pre>
<p><code>get key1</code> запрашивает в Redis значение нового ключа.</p>
<pre class="code-pre custom_prefix"><code langs=""><ul class="prefixed"><li class="line" prefix="127.0.0.1:6379&gt;">get key1
</li></ul></code></pre><pre class="code-pre "><code langs=""><div class="secondary-code-label " title="Output">Output</div>"10"
</code></pre>
<p>Подтвердив, что вы можете выполнять команды в клиенте Redis после аутентификации, вы можете закрыть <code>redis-cli</code>:</p>
<pre class="code-pre custom_prefix"><code langs=""><ul class="prefixed"><li class="line" prefix="127.0.0.1:6379&gt;">quit
</li></ul></code></pre>
<p>Затем мы рассмотрим переименование команд Redis, которые при ошибочном вводе или вводе злоумышленником могут причинить серьезный ущерб вашему компьютеру.</p>

<h2 id="Шаг-5-—-Переименование-опасных-команд">Шаг 5 — Переименование опасных команд</h2>

<p>Другой элемент безопасности, встроенные в Redis, подразумевает переименование или полное удаление определенных команд, которые считаются опасными.</p>

<p>При использовании неавторизованными пользователями, такие команды могут использоваться для изменения конфигурации, уничтожения или выведения из строя ваших данных. Как и в случае пароля для аутентификации, переименование или отключение команд выполняется в том же разделе <code>SECURITY</code> в файле <code>/etc/redis/redis.conf</code>.</p>

<p>Список команд, которые считаются опасными, включает: <strong>FLUSHDB</strong>, <strong>FLUSHALL</strong>, <strong>KEYS</strong>, <strong>PEXPIRE</strong>, <strong>DEL</strong>, <strong>CONFIG</strong>, <strong>SHUTDOWN</strong>, <strong>BGREWRITEAOF</strong>, <strong>BGSAVE</strong>, <strong>SAVE</strong>, <strong>SPOP</strong>, <strong>SREM</strong>, <strong>RENAME</strong> и <strong>DEBUG</strong>. Данный список не является всеобъемлющим, но переименование или удаление всех команд в этом списке служит хорошим отправным пунктом для повышения безопасности вашего сервера Redis.</p>

<p>Решение о том, нужно ли отключить или переименовать команду, зависит от ваших потребностей или потребностей вашего сайта. Если вы знаете, что вы не будете использовать команду, которая может быть использована злоумышленниками, тогда вы можете отключить ее. В другом случае мы рекомендуем вам переименовать ее.</p>

<p>Чтобы активировать или отключить команды Redis, откройте файл конфигурации еще раз:</p>
<pre class="code-pre command"><code langs=""><ul class="prefixed"><li class="line" prefix="$">sudo nano  /etc/redis/redis.conf
</li></ul></code></pre>
<p><span class='warning'><strong>Предупреждение.</strong> Седующие шаги с демонстрацией отключения или переименования команд являются примерами. Вы должны отключить или переименовать команды, имеющие смысл для вас. Вы можете просмотреть полный список команд самостоятельно и узнать, как они могут использоваться злоумышленниками, по адресу <a href="http://redis.io/commands">redis.io/commands</a>.<br></span></p>

<p>Чтобы отключить команду, просто укажите пустую строку в качестве имени (обозначается парой кавычек без символов между ними), как показано ниже:</p>
<div class="code-label " title="/etc/redis/redis.conf">/etc/redis/redis.conf</div><pre class="code-pre "><code langs="">. . .
# It is also possible to completely kill a command by renaming it into
# an empty string:
#
<span class="highlight">rename-command FLUSHDB ""</span>
<span class="highlight">rename-command FLUSHALL ""</span>
<span class="highlight">rename-command DEBUG ""</span>
. . .
</code></pre>
<p>Чтобы переименовать команду, дайте ей другое имя, как показано в приведенных ниже примерах. Переименованные команды должно быть трудно подобрать, но легко запомнить:</p>
<div class="code-label " title="/etc/redis/redis.conf">/etc/redis/redis.conf</div><pre class="code-pre "><code langs="">. . .
# rename-command CONFIG ""
<span class="highlight">rename-command SHUTDOWN SHUTDOWN_MENOT</span>
<span class="highlight">rename-command CONFIG ASC12_CONFIG</span>
. . .
</code></pre>
<p>Сохраните изменения и закройте файл.</p>

<p>После переименования команды примените изменения, перезапустив Redis:</p>
<pre class="code-pre command"><code langs=""><ul class="prefixed"><li class="line" prefix="$">sudo systemctl restart redis.service
</li></ul></code></pre>
<p>Чтобы протестировать новую команду, откройте командную строку Redis:</p>
<pre class="code-pre command"><code langs=""><ul class="prefixed"><li class="line" prefix="$">redis-cli
</li></ul></code></pre>
<p>Затем выполните аутентификацию:</p>
<pre class="code-pre custom_prefix"><code langs=""><ul class="prefixed"><li class="line" prefix="127.0.0.1:6379&gt;">auth <span class="highlight">your_redis_password</span>
</li></ul></code></pre><pre class="code-pre "><code langs=""><div class="secondary-code-label " title="Output">Output</div>OK
</code></pre>
<p>Предположим, вы переименовали команду <code>CONFIG</code> в <code>ASC12_CONFIG</code>, как показано в предыдущем примере. Сначала попробуйте воспользоваться первоначальной команду <code>CONFIG</code>. Команда не будет выполнена, потому что вы переименовали ее:</p>
<pre class="code-pre custom_prefix"><code langs=""><ul class="prefixed"><li class="line" prefix="127.0.0.1:6379&gt;">config get requirepass
</li></ul></code></pre><pre class="code-pre "><code langs=""><div class="secondary-code-label " title="Output">Output</div>(error) ERR unknown command 'config'
</code></pre>
<p>Вызов переименованной команды будет успешным. Регистр не имеет значения:</p>
<pre class="code-pre custom_prefix"><code langs=""><ul class="prefixed"><li class="line" prefix="127.0.0.1:6379&gt;">asc12_config get requirepass
</li></ul></code></pre><pre class="code-pre "><code langs=""><div class="secondary-code-label " title="Output">Output</div>1) "requirepass"
2) "<span class="highlight">your_redis_password</span>"
</code></pre>
<p>После этого вы можете закрыть <code>redis-cli</code>:</p>
<pre class="code-pre custom_prefix"><code langs=""><ul class="prefixed"><li class="line" prefix="127.0.0.1:6379&gt;">exit
</li></ul></code></pre>
<p>Обратите внимание, что если вы уже используете командную строку Redis, а затем перезапустите Redis, вам нужно будет повторно выполнить аутентификацию. Иначе вы получите следующую ошибку при вводе команды:</p>
<pre class="code-pre "><code langs=""><div class="secondary-code-label " title="Output">Output</div>NOAUTH Authentication required.
</code></pre>
<span class='warning'><p>
В отношении практики переименования команд в конце раздела <code>SECURITY</code> файла <code>/etc/redis/redis.conf</code> есть следующее предостережение:</p>

<blockquote>
<p><code>Обратите внимание, что изменение имени команд, зарегистрированных в файле AOF или передающихся “slave” компонентам системы, может вызывать проблемы.</code></p>
</blockquote>

<p><strong><em>Примечание:</em></strong> <em>проект Redis предпочитает использовать термины «master» и «slave», в то время как DigitalOcean предпочитает использовать варианты «primary» и «secondary». Чтобы не допустить путаницы, мы решили использовать здесь термины, используемые в документации Redis.</em></p>

<p>Это значит, что, если переименованная команда не содержится в файле AOF, либо содержится, но AOF файл не передается «slave» компонентам, не будет никаких проблем.</p>

<p>Учитывайте этот момент, когда будете переименовать команды. Лучшее всего переименовать команду, пока вы не используете  AOF сохранение или сразу после установки, т.е. до развертывания использующего Redis приложения.</p>

<p>Если вы используете AOF и работаете с конфигурацией master-slave, <a href="https://github.com/antirez/redis/issues/2783">изучите этот ответ на странице проблем проекта на GitHub</a>. Ниже приводится ответ на вопрос автора:</p>

<blockquote>
<p>Команды сохраняются в AOF и воспроизводятся в «slave» компоненте в таком же виде, как были отправлены, поэтому если вы попытаетесь использовать AOF для экземпляра, где не было выполнено переименование, могут возникнуть противоречия, так как команда не может быть выполнена (то же самое характерно для «slave» компонентов).</p>
</blockquote>

<p>Таким образом, при переименовании необходимо убедиться, что переименованные команды применяются во всех экземплярах на установках типа «master-slave».</p></span>

<h2 id="Заключение">Заключение</h2>

<p>С помощью этого руководства вы установили и  настроили Redis, подтвердили, что установка Redis работает правильно, и воспользовались встроенными функциями безопасности, чтобы сделать Redis менее уязвимой для атак злоумышленников.</p>

<p>Обратите внимание, что после входа на ваш сервер очень легко будет обойти защитные функции Redis, которые мы настроили. Поэтому наиболее важным элементом безопасности на вашем сервере Redis является ваш брандмауэр (который вы должны были настроить на этапе <a href="https://www.digitalocean.com/community/tutorials/initial-server-setup-with-ubuntu-18-04#step-four-%E2%80%94-setting-up-a-basic-firewall">первоначальной настройки сервера</a>, поскольку злоумышленникам очень трудно преодолеть эту преграду.</p>
