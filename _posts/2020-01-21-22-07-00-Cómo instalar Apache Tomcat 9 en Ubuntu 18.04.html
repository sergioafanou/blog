---
layout: post
title: Cómo instalar Apache Tomcat 9 en Ubuntu 18.04
network: digitalocean
date: January 21, 2020 at 10:07PM
url: https://www.digitalocean.com/community/tutorials/install-tomcat-9-ubuntu-1804-es
image: https://assets.digitalocean.com/articles/tomcat8_1604/splashscreen.png
tags: docker
feedtitle: DigitalOcean Community Tutorials
feedurl: https://www.digitalocean.com/community/tutorials
author: DigitalOcean
---
<h3 id="introducción">Introducción</h3>

<p>Apache Tomcat es un servidor web y contenedor de servlets que se utiliza para presentar aplicaciones Java. Tomcat es una implementación de código abierto de las tecnologías Java Servlet y JavaServer Pages publicada por la Apache Software Foundation. En este tutorial se abordan la instalación básica y algunas configuraciones de la última versión de Tomcat 9 en su servidor Ubuntu 18.04.</p>

<h2 id="requisitos-previos">Requisitos previos</h2>

<p>Antes de comenzar con esta guía, debe disponer de un usuario no root con privilegios <code>sudo</code> configurado en su servidor. Puede aprender a hacer esto completando nuestra <a href="https://www.digitalocean.com/community/tutorials/initial-server-setup-with-ubuntu-16-04">guía de configuración inicial para servidores de Ubuntu 16.04</a>.</p>

<h2 id="paso-1-instalar-java">Paso 1: Instalar Java</h2>

<p>Para que sea posible ejecutar cualquier código de aplicaciones web Java, es necesario que Tomcat esté instalado en el servidor. Podemos cumplir con ese requisito instalando OpenJDK con apt.</p>

<p>Primero, actualice su índice de paquetes de apt:</p>
<pre class="code-pre command"><code langs=""><ul class="prefixed"><li class="line" prefix="$">sudo apt update
</li></ul></code></pre>
<p>A continuación, instale el paquete del Kit de desarrollo Jave con apt:</p>
<pre class="code-pre command"><code langs=""><ul class="prefixed"><li class="line" prefix="$">sudo apt install default-jdk
</li></ul></code></pre>
<p>Ahora que Java está instalado, podremos crear un usuario <code>tomcat</code>, que usaremos para ejecutar el servicio de Tomcat.</p>

<h2 id="paso-2-crear-un-usuario-tomcat">Paso 2: Crear un usuario tomcat</h2>

<p>Por seguridad, Tomcat debería ejecutarse como un usuario sin privilegios (es decir, no root). Crearemos un nuevo usuario y grupo que ejecutarán el servicio de Tomcat.</p>

<p>Primero, cree un nuevo grupo <code>tomcat</code>:</p>
<pre class="code-pre command"><code langs=""><ul class="prefixed"><li class="line" prefix="$">sudo groupadd tomcat
</li></ul></code></pre>
<p>A continuación, cree un nuevo usuario <code>tomcat</code>. Haremos que este usuario sea miembro del grupo <code>tomcat</code>, con un directorio de inicio <code>/opt/tomcat</code> (donde instalaremos Tomcat) y un shell de <code>/bin/false</code> (de modo que nadie pueda iniciar sesión en la cuenta):</p>
<pre class="code-pre command"><code langs=""><ul class="prefixed"><li class="line" prefix="$">sudo useradd -s /bin/false -g tomcat -d /opt/tomcat tomcat
</li></ul></code></pre>
<p>Ahora que nuestro usuario <code>tomcat</code> está configurado, descargaremos e instalaremos Tomcat.</p>

<h2 id="paso-3-instalar-tomcat">Paso 3: Instalar Tomcat</h2>

<p>La mejor alternativa para instalar Tomcat 9 es descargar la última versión binaria y luego configurarla manualmente.</p>

<p>Busque la última versión de Tomcat 9 en la <a href="https://tomcat.apache.org/download-90.cgi">página de descargas de Tomcat 9</a>. En el momento en que se redactó esta guía, la versión más reciente fue la <strong>9.0.10</strong>, pero debería usar una versión estable posterior si se encuentra disponible. En la sección <strong>Binary Distributions</strong>, debajo de la lista de <strong>Core</strong>, copie el enlace a “tar.gz”.</p>

<p>A continuación, posiciónese en el directorio <code>/tmp</code> en su servidor. Este es un buen directorio para descargar los elementos ephemeral como el tarball de Tomcat, que no necesitaremos tras extraer el contenido de Tomcat:</p>
<pre class="code-pre command"><code langs=""><ul class="prefixed"><li class="line" prefix="$">cd /tmp
</li></ul></code></pre>
<p>Utilice <code>curl</code> para descargar el enlace que copió desde el sitio web de Tomcat:</p>
<pre class="code-pre command"><code langs=""><ul class="prefixed"><li class="line" prefix="$">curl -O <span class="highlight">http://mirror.cc.columbia.edu/pub/software/apache/tomcat/tomcat-9/v9.0.10/bin/apache-tomcat-9.0.10.tar.gz</span>
</li></ul></code></pre>
<p>Instalaremos Tomcat en el directorio <code>/opt/tomcat</code>. Cree el directorio y luego extraiga el archivo con estos comandos:</p>
<pre class="code-pre command"><code langs=""><ul class="prefixed"><li class="line" prefix="$">sudo mkdir /opt/tomcat
</li><li class="line" prefix="$">sudo tar xzvf apache-tomcat-9*tar.gz -C /opt/tomcat --strip-components=1
</li></ul></code></pre>
<p>A continuación, podremos configurar los permisos de usuario adecuados para nuestra instalación.</p>

<h2 id="paso-4-actualizar-los-permisos">Paso 4: Actualizar los permisos</h2>

<p>El usuario <code>tomcat</code> que configuramos debe tener acceso a la instalación de Tomcat. Configuraremos esto ahora.</p>

<p>Posiciónese en el directorio en el que desempaquetamos la instalación de Tomcat:</p>
<pre class="code-pre command"><code langs=""><ul class="prefixed"><li class="line" prefix="$">cd /opt/tomcat
</li></ul></code></pre>
<p>Otorgue la propiedad sobre todo el directorio de instalación al grupo <code>tomcat</code>:</p>
<pre class="code-pre command"><code langs=""><ul class="prefixed"><li class="line" prefix="$">sudo chgrp -R tomcat /opt/tomcat
</li></ul></code></pre>
<p>A continuación, proporcione al grupo <code>tomcat</code> acceso de lectura al directorio <code>conf</code> y a todos sus contenidos, y acceso de <strong>ejecución</strong> al directorio:</p>
<pre class="code-pre command"><code langs=""><ul class="prefixed"><li class="line" prefix="$">sudo chmod -R g+r conf
</li><li class="line" prefix="$">sudo chmod g+x conf
</li></ul></code></pre>
<p>Asegúrese de que el usuario <code>tomcat</code> sea el propietario de los directorios <code>webapps</code>, <code>work</code>, <code>temp</code> y <code>logs</code>:</p>
<pre class="code-pre command"><code langs=""><ul class="prefixed"><li class="line" prefix="$">sudo chown -R tomcat webapps/ work/ temp/ logs/
</li></ul></code></pre>
<p>Ahora que están configurados los permisos adecuados, podemos crear un archivo de servicio systemd para gestionar el proceso de Tomcat.</p>

<h2 id="paso-5-crear-un-archivo-de-servicio-de-systemd">Paso 5: Crear un archivo de servicio de systemd</h2>

<p>Nos convendrá poder ejecutar Tomcat como servicio; por ello, configuraremos el servicio systemd.</p>

<p>Tomcat necesita saber dónde está instalado Java. Esta ruta se denomina comúnmente “JAVA_HOME”. La alternativa más sencilla para revisar esa ubicación es ejecutar el siguiente comando:</p>
<pre class="code-pre command"><code langs=""><ul class="prefixed"><li class="line" prefix="$">sudo update-java-alternatives -l
</li></ul></code></pre><pre class="code-pre "><code langs=""><div class="secondary-code-label " title="Output">Output</div>java-1.11.0-openjdk-amd64       1081       <span class="highlight">/usr/lib/jvm/java-1.11.0-openjdk-amd64</span>
</code></pre>
<p>Su <code>JAVA_HOME</code> es el resultado de la última columna (resaltada en rojo). Considerando el ejemplo anterior, el <code>JAVA_HOME</code> correcto para este servidor sería el siguiente:</p>
<pre class="code-pre "><code langs=""><div class="secondary-code-label " title="JAVA_HOME">JAVA_HOME</div>/usr/lib/jvm/java-1.11.0-openjdk-amd64
</code></pre>
<p>Es posible que su <code>JAVA_HOME</code> sea diferente.</p>

<p>Con esta información, podemos crear el archivo de servicio systemd. Abra un archivo llamado <code>tomcat.service</code> en el directorio <code>/etc/systemd/system</code> escribiendo lo siguiente:</p>
<pre class="code-pre command"><code langs=""><ul class="prefixed"><li class="line" prefix="$">sudo nano /etc/systemd/system/tomcat.service
</li></ul></code></pre>
<p>Pegue el siguiente contenido en su archivo de servicio. Modifique el valor de <code>JAVA_HOME</code> si es necesario para que coincida con el valor que encontró en su sistema. Es posible que también desee modificar los ajustes de asignación de memoria especificados en <code>CATALINA_OPTS</code>:</p>
<div class="code-label " title="/etc/systemd/system/tomcat.service">/etc/systemd/system/tomcat.service</div><pre class="code-pre "><code langs="">[Unit]
Description=Apache Tomcat Web Application Container
After=network.target

[Service]
Type=forking

Environment=JAVA_HOME=<span class="highlight">/usr/lib/jvm/java-1.11.0-openjdk-amd64</span>
Environment=CATALINA_PID=/opt/tomcat/temp/tomcat.pid
Environment=CATALINA_HOME=/opt/tomcat
Environment=CATALINA_BASE=/opt/tomcat
Environment='CATALINA_OPTS=-Xms512M -Xmx1024M -server -XX:+UseParallelGC'
Environment='JAVA_OPTS=-Djava.awt.headless=true -Djava.security.egd=file:/dev/./urandom'

ExecStart=/opt/tomcat/bin/startup.sh
ExecStop=/opt/tomcat/bin/shutdown.sh

User=tomcat
Group=tomcat
UMask=0007
RestartSec=10
Restart=always

[Install]
WantedBy=multi-user.target
</code></pre>
<p>Cuando termine, guarde y cierre el archivo.</p>

<p>A continuación, vuelva a cargar el demonio systemd para que reciba información sobre nuestro archivo de servicio:</p>
<pre class="code-pre command"><code langs=""><ul class="prefixed"><li class="line" prefix="$">sudo systemctl daemon-reload
</li></ul></code></pre>
<p>Inicie el servicio Tomcat escribiendo lo siguiente:</p>
<pre class="code-pre command"><code langs=""><ul class="prefixed"><li class="line" prefix="$">sudo systemctl start tomcat
</li></ul></code></pre>
<p>Compruebe que se inició sin errores escribiendo lo siguiente:</p>
<pre class="code-pre command"><code langs=""><ul class="prefixed"><li class="line" prefix="$">sudo systemctl status tomcat
</li></ul></code></pre>
<h2 id="paso-6-aplicar-ajustes-al-firewall-y-probar-el-servidor-de-tomcat">Paso 6: Aplicar ajustes al firewall y probar el servidor de Tomcat</h2>

<p>Ahora que se inició el servicio de Tomcat, podemos probarlo para garantizar que la página predeterminada está disponible.</p>

<p>Antes de hacer esto, debemos realizar ajustes en el firewall para permitir que nuestras solicitudes lleguen al servicio. Si cumplió con los requisitos previos, en este momento dispondrá de un firewall <code>ufw</code> habilitado.</p>

<p>Tomcat utiliza el puerto <code>8080</code> para aceptar solicitudes convencionales. Permita el tráfico hacia este puerto escribiendo lo siguiente:</p>
<pre class="code-pre command"><code langs=""><ul class="prefixed"><li class="line" prefix="$">sudo ufw allow 8080
</li></ul></code></pre>
<p>Una vez modificado firewall, podrá acceder a la página de presentación predeterminada agregando a su dominio o dirección IP la terminación <code>:8080</code> y visitándolos en un navegador web:</p>
<pre class="code-pre "><code langs=""><div class="secondary-code-label " title="Open in web browser">Open in web browser</div>http://<span class="highlight">server_domain_or_IP</span>:8080
</code></pre>
<p>Verá la página de presentación de Tomcat predeterminada e información adicional. Sin embargo, si hace clic en los enlaces de de la aplicación de administración, por ejemplo, se denegará el acceso. Podemos configurar ese acceso a continuación.</p>

<p>Si pudo acceder correctamente a Tomcat, será un buen momento para habilitar el archivo de servicio a fin de que Tomcat se inicie automáticamente en el inicio:</p>
<pre class="code-pre command"><code langs=""><ul class="prefixed"><li class="line" prefix="$">sudo systemctl enable tomcat
</li></ul></code></pre>
<h2 id="paso-7-configurar-la-interfaz-de-administración-web-de-tomcat">Paso 7: Configurar la interfaz de administración web de Tomcat</h2>

<p>Para usar la aplicación de administración web que viene con Tomcat, debemos añadir un inicio de sesión a nuestro servidor de Tomcat. Haremos esto editando el archivo <code>tomcat-users.xml</code>:</p>
<pre class="code-pre command"><code langs=""><ul class="prefixed"><li class="line" prefix="$">sudo nano /opt/tomcat/conf/tomcat-users.xml
</li></ul></code></pre>
<p>Le convendrá añadir un usuario que pueda acceder a <code>manager-gui</code> y <code>admin-gui</code> (aplicaciones web que vienen con Tomcat). Puede hacerlo definiendo un usuario, similar al ejemplo que se muestra a continuación, entre las etiquetas <code>tomcat-users</code>. Asegúrese de cambiar el nombre de usuario y la contraseña por opciones seguras.</p>
<div class="code-label " title="tomcat-users.xml — Admin User">tomcat-users.xml — Admin User</div><pre class="code-pre "><code langs="">&lt;tomcat-users . . .&gt;
    &lt;user username="<span class="highlight">admin</span>" password="<span class="highlight">password</span>" roles="manager-gui,admin-gui"/&gt;
&lt;/tomcat-users&gt;
</code></pre>
<p>Guarde y cierre el archivo cuando termine.</p>

<p>Por defecto, las versiones más recientes de Tomcat impiden que las aplicaciones provenientes del propio servidor accedan a las aplicaciones Manager y Host Manager. Debido a que la instalación se realizará en una máquina remota, probablemente le convenga eliminar o alterar esta restricción. Para cambiar las restricciones de direcciones IP en estas, abra los archivos <code>context.xml</code> correspondientes.</p>

<p>Para la aplicación Manager, escriba lo siguiente:</p>
<pre class="code-pre command"><code langs=""><ul class="prefixed"><li class="line" prefix="$">sudo nano /opt/tomcat/webapps/manager/META-INF/context.xml
</li></ul></code></pre>
<p>Para la aplicación Host Manager, escriba esto:</p>
<pre class="code-pre command"><code langs=""><ul class="prefixed"><li class="line" prefix="$">sudo nano /opt/tomcat/webapps/host-manager/META-INF/context.xml
</li></ul></code></pre>
<p>En el interior, elimine la restricción de direcciones IP para permitir las conexiones desde cualquier lugar. Además, si desea permitir el acceso únicamente a las conexiones que provienen de su propia dirección IP, puede añadir su dirección IP pública a la lista:</p>
<div class="code-label " title="context.xml files for Tomcat webapps">context.xml files for Tomcat webapps</div><pre class="code-pre "><code langs="">&lt;Context antiResourceLocking="false" privileged="true" &gt;
  <span class="highlight">&lt;!--</span>&lt;Valve className="org.apache.catalina.valves.RemoteAddrValve"
         allow="127\.\d+\.\d+\.\d+|::1|0:0:0:0:0:0:0:1" /&gt;<span class="highlight">--&gt;</span>
&lt;/Context&gt;
</code></pre>
<p>Guarde y cierre los archivos cuando termine.</p>

<p>Para implementar los cambios que realizamos, reinicie el servicio de Tomcat:</p>
<pre class="code-pre command"><code langs=""><ul class="prefixed"><li class="line" prefix="$">sudo systemctl restart tomcat
</li></ul></code></pre>
<h2 id="paso-8-acceder-a-la-interfaz-web">Paso 8: Acceder a la interfaz web</h2>

<p>Ahora que creamos un usuario, podremos acceder a la interfaz de administración web en un navegador web. De nuevo, puede acceder a la interfaz correcta introduciendo el nombre de dominio o la dirección IP de su servidor seguido del puerto 8080 en su navegador:</p>
<pre class="code-pre "><code langs=""><div class="secondary-code-label " title="Open in web browser">Open in web browser</div>http://<span class="highlight">server_domain_or_IP</span>:8080
</code></pre>
<p>La página que ve sería la misma que se cargó cuando realizó la prueba anteriormente:</p>

<p><img src="https://assets.digitalocean.com/articles/tomcat8_1604/splashscreen.png" alt="root de Tomcat"></p>

<p>Veamos Manager App. Se puede acceder a ella a través del enlace o con <code>http://<span class="highlight">server_domain_or_IP</span>:80/manager/html</code>. Deberá introducir las credenciales de la cuenta que agregó al archivo <code>tomcat-users.xml</code>. Después de eso, debería ver una página similar a esta:</p>

<p><img src="https://assets.digitalocean.com/articles/tomcat8_1604/manager.png" alt="Administrador de aplicaciones web de Tomcat"></p>

<p>El Administrador de aplicaciones web se utiliza para gestionar sus aplicaciones Java. En él puede concretar inicios, detenciones, recargas e implementaciones y detener estas últimas. También puede ejecutar algunos diagnósticos en sus aplicaciones (es decir, encontrar fugas de memoria). Por último, la información sobre su servidor está disponible en la parte inferior de esta página.</p>

<p>Ahora veremos Host Manager, al que se puede acceder a través del enlace o con <code>http://<span class="highlight">server_domain_or_IP</span>:80/host-manager/html/</code>:</p>

<p><img src="https://assets.digitalocean.com/articles/tomcat8_1604/host-manager.png" alt="Host Manager virtual de Tomcat"></p>

<p>Desde la página de Virtual Host Manager, puede añadir hosts virtuales desde los cuales proporcionará sus aplicaciones.</p>

<h2 id="conclusión">Conclusión</h2>

<p>¡Completó la instalación de Tomcat! Ahora puede implementar sus propias aplicaciones web Java.</p>

<p>En este momento, su instalación de Tomcat funciona, pero no está completamente cifrada. Esto significa que todos los datos, incluidos los elementos confidenciales como las contraseñas, se envían en texto sin formato, que otros pueden interceptar y leer en Internet. Para evitar que esto suceda, se le recomienda encarecidamente cifrar sus conexiones con SSL. Puede obtener información sobre cómo cifrar su conexión con Tomcat siguiendo <a href="https://www.digitalocean.com/community/tutorials/how-to-encrypt-tomcat-8-connections-with-apache-or-nginx-on-ubuntu-16-04">esta guía</a> (<em>tenga en cuenta que en ella se abarca el cifrado de Tomcat 8 en Ubuntu 16.04</em>).</p>
