---
layout: post
title: How To Set Up the code-server Cloud IDE Platform on CentOS 7
network: digitalocean
date: December 20, 2019 at 07:56PM
url: https://www.digitalocean.com/community/tutorials/how-to-set-up-the-code-server-cloud-ide-platform-on-centos-7
image: https://assets.digitalocean.com/articles/code-server-1804/step2a.png
tags: docker
feedtitle: DigitalOcean Community Tutorials
feedurl: https://www.digitalocean.com/community/tutorials
author: DigitalOcean
---
<p><em>The author selected the <a href="https://www.brightfunds.org/funds/foss-nonprofits">Free and Open Source Fund</a> to receive a donation as part of the <a href="https://do.co/w4do-cta">Write for DOnations</a> program.</em></p>

<h3 id="introduction">Introduction</h3>

<p>With developer tools moving to the cloud, creation and adoption of cloud IDE (Integrated Development Environment) platforms is growing. Cloud IDEs allow for real-time collaboration between developer teams to work in a unified development environment that minimizes incompatibilities and enhances productivity. Accessible through web browsers, cloud IDEs are available from every type of modern device.</p>

<p><a href="https://github.com/cdr/code-server">code-server</a> is <a href="https://code.visualstudio.com/">Microsoft Visual Studio Code</a> running on a remote server and accessible directly from your browser. Visual Studio Code is a modern code editor with integrated Git support, a code debugger, smart autocompletion, and customizable and extensible features. This means that you can use various devices running different operating systems, and always have a consistent development environment on hand.</p>

<p>In this tutorial, you will set up the code-server cloud IDE platform on your CentOS 7 machine and expose it at your domain, secured with free <a href="https://letsencrypt.org/">Let&rsquo;s Encrypt</a> TLS certificates. In the end, you&rsquo;ll have Microsoft Visual Studio Code running on your CentOS 7 server, available at your domain and protected with a password.</p>

<h2 id="prerequisites">Prerequisites</h2>

<ul>
<li><p>A server running CentOS 7 with at least 2GB RAM, root access, and a sudo, non-root account. You can set this up by following <a href="https://www.digitalocean.com/community/tutorials/initial-server-setup-with-centos-7">this initial server setup guide</a>.</p></li>
<li><p>Nginx installed on your server. For a guide on how to do this, see <a href="https://www.digitalocean.com/community/tutorials/how-to-install-nginx-on-centos-7">How To Install Nginx on CentOS 7</a>.</p></li>
<li><p>Both of the following DNS records set up for your server. You can follow <a href="https://www.digitalocean.com/community/tutorials/an-introduction-to-digitalocean-dns">this introduction to DigitalOcean DNS</a> for details on how to add them.</p>

<ul>
<li>An A record with <code><span class="highlight">your-domain</span></code> pointing to your server&rsquo;s public IP address.</li>
<li>An A record with <code>www.<span class="highlight">your-domain</span></code> pointing to your server&rsquo;s public IP address.</li>
</ul></li>
<li><p>A fully registered domain name to host code-server, pointed to your server. This tutorial will use <code>code-server.<span class="highlight">your-domain</span></code> throughout. You can purchase a domain name on <a href="https://www.namecheap.com/">Namecheap</a>, get one for free on <a href="https://www.freenom.com/en/index.html?lang=en">Freenom</a>, or use the domain registrar of your choice.</p></li>
</ul>

<h2 id="step-1-—-installing-code-server">Step 1 — Installing code-server</h2>

<p>In this section, you will set up code-server on your server. This entails downloading the latest version and creating a <a href="https://www.digitalocean.com/community/tutorials/understanding-systemd-units-and-unit-files"><code>systemd</code></a> service that will keep code-server always running in the background. You&rsquo;ll also specify a restart policy for the service, so that code-server stays available after possible crashes or reboots.</p>

<p>You&rsquo;ll store all data pertaining to code-server in a folder named <code>~/code-server</code>. Create it by running the following command:</p>
<pre class="code-pre command"><code langs=""><ul class="prefixed"><li class="line" prefix="$">mkdir ~/code-server
</li></ul></code></pre>
<p>Navigate to it:</p>
<pre class="code-pre command"><code langs=""><ul class="prefixed"><li class="line" prefix="$">cd ~/code-server
</li></ul></code></pre>
<p>You&rsquo;ll need to head over to the <a href="https://github.com/cdr/code-server/releases">Github releases</a> page of code-server and pick the latest Linux build (the file will contain &lsquo;linux&rsquo; in its name). At the time of writing, the latest version was <span class="highlight">2.1692</span>. Download it using <code>curl</code> by running the following command:</p>
<pre class="code-pre command"><code langs=""><ul class="prefixed"><li class="line" prefix="$">curl -LO https://github.com/cdr/code-server/releases/download/<span class="highlight">2.1692-vsc1.39.2/code-server2.1692-vsc1.39.2-linux-x86_64.tar.gz</span>
</li></ul></code></pre>
<p>Then, unpack the archive by running:</p>
<pre class="code-pre command"><code langs=""><ul class="prefixed"><li class="line" prefix="$">tar -xzvf <span class="highlight">code-server2.1692-vsc1.39.2-linux-x86_64.tar.gz</span>
</li></ul></code></pre>
<p>You&rsquo;ll get a folder named exactly as the original file you downloaded, which contains the code-server executable. Navigate to it:</p>
<pre class="code-pre command"><code langs=""><ul class="prefixed"><li class="line" prefix="$">cd <span class="highlight">code-server2.1692-vsc1.39.2-linux-x86_64</span>
</li></ul></code></pre>
<p>Copy the code-server executable to <code>/usr/local/bin</code> so you&rsquo;ll be able to access it system wide by running the following command:</p>
<pre class="code-pre command"><code langs=""><ul class="prefixed"><li class="line" prefix="$">sudo cp code-server /usr/local/bin
</li></ul></code></pre>
<p>Next, create a folder for code-server, where it will store user data:</p>
<pre class="code-pre command"><code langs=""><ul class="prefixed"><li class="line" prefix="$">sudo mkdir /var/lib/code-server
</li></ul></code></pre>
<p>Now that you&rsquo;ve downloaded code-server and made it available system-wide, you will create a systemd service to keep code-server running in the background at all times.</p>

<p>You&rsquo;ll store the service configuration in a file named <code>code-server.service</code>, in the <code>/usr/lib/systemd/system</code> directory, where systemd stores its services. Create it using the <a href="https://www.digitalocean.com/community/tutorials/how-to-use-vim-for-advanced-editing-of-plain-text-or-code-on-a-vps--2"><code>vi</code> editor</a>:</p>
<pre class="code-pre command"><code langs=""><ul class="prefixed"><li class="line" prefix="$">sudo vi /usr/lib/systemd/system/code-server.service
</li></ul></code></pre>
<p>Add the following lines:</p>
<div class="code-label " title="/usr/lib/systemd/system/code-server.service">/usr/lib/systemd/system/code-server.service</div><pre class="code-pre "><code langs="">[Unit]
Description=code-server
After=nginx.service

[Service]
Type=simple
Environment=PASSWORD=<span class="highlight">your_password</span>
ExecStart=/usr/local/bin/code-server --host 127.0.0.1 --user-data-dir /var/lib/code-server --auth password
Restart=always

[Install]
WantedBy=multi-user.target
</code></pre>
<p>Here you first specify the description of the service. Then, you state that the <code>nginx</code> service must be started before this one. After the <code>[Unit]</code> section, you define the type of the service (<code>simple</code> means that the process should be simply run) and provide the command that will be executed.</p>

<p>You also specify that the global code-server executable should be started with a few arguments specific to code-server.  <code>--host 127.0.0.1</code> binds it to <code>localhost</code>, so it&rsquo;s only directly accessible from inside of your server. <code>--user-data-dir /var/lib/code-server</code> sets its user data directory, and <code>--auth password</code> specifies that it should authenticate visitors with a password, specified in the <code>PASSWORD</code> environment variable declared on the line above it.</p>

<p>Remember to replace <code><span class="highlight">your_password</span></code> with your desired password. Type <code>:wq</code> and then <code>ENTER</code> to save and close the file.</p>

<p>The next line tells systemd to restart code-server in all malfunction events (for example, when it crashes or the process is killed). The <code>[Install]</code> section orders systemd to start this service when it becomes possible to log in to your server.</p>

<p>Start the code-server service by running the following command:</p>
<pre class="code-pre command"><code langs=""><ul class="prefixed"><li class="line" prefix="$">sudo systemctl start code-server
</li></ul></code></pre>
<p>Check that it&rsquo;s started correctly by observing its status:</p>
<pre class="code-pre command"><code langs=""><ul class="prefixed"><li class="line" prefix="$">sudo systemctl status code-server
</li></ul></code></pre>
<p>You&rsquo;ll see output similar to:</p>
<pre class="code-pre "><code langs=""><div class="secondary-code-label " title="Output">Output</div>● code-server.service - code-server
   Loaded: loaded (/usr/lib/systemd/system/code-server.service; disabled; vendor preset: disabled)
   Active: active (running) since Thu 2019-12-19 19:24:42 UTC; 5s ago
 Main PID: 1668 (code-server)
   CGroup: /system.slice/code-server.service
           ├─1668 /usr/local/bin/code-server --host 127.0.0.1 --user-data-dir /var/lib/code-server --auth password
           └─1679 /usr/local/bin/code-server --host 127.0.0.1 --user-data-dir /var/lib/code-server --auth password

Dec 19 19:24:42 code-server-centos systemd[1]: Started code-server.
Dec 19 19:24:44 code-server-centos code-server[1668]: info  Server listening on http://127.0.0.1:8080
Dec 19 19:24:44 code-server-centos code-server[1668]: info    - Using custom password for authentication
Dec 19 19:24:44 code-server-centos code-server[1668]: info    - Not serving HTTPS
</code></pre>
<p>To make code-server start automatically after a server reboot, enable its service by running the following command:</p>
<pre class="code-pre command"><code langs=""><ul class="prefixed"><li class="line" prefix="$">sudo systemctl enable code-server
</li></ul></code></pre>
<p>In this step, you&rsquo;ve downloaded code-server and made it available globally. Then, you&rsquo;ve created a systemd service for it and enabled it, so code-server will start at every server boot. Next, you&rsquo;ll expose it at your domain by configuring Nginx to serve as a reverse proxy between the visitor and code-server.</p>

<h2 id="step-2-—-exposing-code-server-at-your-domain">Step 2 — Exposing code-server at Your Domain</h2>

<p>In this section, you will configure Nginx as a reverse proxy for code-server.</p>

<p>As you have learned in the Nginx prerequisite step, its site configuration files are stored under <code>/etc/nginx/conf.d</code> and will automatically be loaded when Nginx starts.</p>

<p>You&rsquo;ll store the configuration for exposing code-server at your domain in a file named <code>code-server.conf</code>, under <code>/etc/nginx/conf.d</code>. Start off by creating it using your editor:</p>
<pre class="code-pre command"><code langs=""><ul class="prefixed"><li class="line" prefix="$">sudo vi /etc/nginx/conf.d/code-server.conf
</li></ul></code></pre>
<p>Add the following lines:</p>
<div class="code-label " title="/etc/nginx/conf.d/code-server.conf">/etc/nginx/conf.d/code-server.conf</div><pre class="code-pre "><code langs="">server {
    listen 80;
    listen [::]:80;

    server_name code-server.<span class="highlight">your-domain</span>;

    location / {
        proxy_pass http://localhost:8080/;
        proxy_set_header Upgrade $http_upgrade;
        proxy_set_header Connection upgrade;
        proxy_set_header Accept-Encoding gzip;
    }
}
</code></pre>
<p>Replace <code>code-server.<span class="highlight">your-domain</span></code> with your desired domain, then save and close the file.</p>

<p>In this file, you define that Nginx should listen to HTTP port <code>80</code>. Then, you specify a <code>server_name</code> that tells Nginx for which domain to accept requests and apply this particular configuration.</p>

<p>In the next block, for the root location (<code>/</code>), you specify that requests should be passed back and forth to code-server running at <code>localhost:8080</code>. The next three lines (starting with <code>proxy_set_header</code>) order Nginx to carry over some HTTP request headers that are needed for correct functioning of WebSockets, which code-server extensively uses.</p>

<p>To test the validity of the configuration, run the following command:</p>
<pre class="code-pre command"><code langs=""><ul class="prefixed"><li class="line" prefix="$">sudo nginx -t
</li></ul></code></pre>
<p>You&rsquo;ll see the following output:</p>
<pre class="code-pre "><code langs=""><div class="secondary-code-label " title="Output">Output</div>nginx: the configuration file /etc/nginx/nginx.conf syntax is ok
nginx: configuration file /etc/nginx/nginx.conf test is successful
</code></pre>
<p>For the configuration to take effect, you&rsquo;ll need to restart Nginx:</p>
<pre class="code-pre command"><code langs=""><ul class="prefixed"><li class="line" prefix="$">sudo systemctl restart nginx
</li></ul></code></pre>
<p>CentOS 7 comes with SELinux turned on, with a strict ruleset, which by default does not permit Nginx to connect to local TCP sockets. Nginx needs to do in order to serve as a reverse proxy for code-server. Run the following command to relax the rule permanently:</p>
<pre class="code-pre command"><code langs=""><ul class="prefixed"><li class="line" prefix="$">sudo setsebool httpd_can_network_connect 1 -P
</li></ul></code></pre>
<p>Then, in your browser, navigate to the domain you used for code-server. You will see the code-server login prompt.</p>

<p><img src="https://assets.digitalocean.com/articles/code-server-1804/step2a.png" alt="code-server login prompt"></p>

<p>code-server is asking you for your password. Enter the one you set in the previous step and press <strong>Enter IDE</strong>. You&rsquo;ll now enter code-server and immediately see its editor GUI.</p>

<p><img src="https://assets.digitalocean.com/articles/code-server-1804/step2b.png" alt="code-server GUI"></p>

<p>You now have your code-server installation accessible at your domain. In the next step, you&rsquo;ll secure it by applying a free Let&rsquo;s Encrypt TLS certificate.</p>

<h2 id="step-3-—-securing-your-domain">Step 3 — Securing Your Domain</h2>

<p>In this section, you will secure your domain using a Let&rsquo;s Encrypt TLS certificate, which you&rsquo;ll provision using Certbot.</p>

<p>To install the latest version of Certbot and its Nginx plugin, run the following command:</p>
<pre class="code-pre command"><code langs=""><ul class="prefixed"><li class="line" prefix="$">sudo yum install certbot python2-certbot-nginx
</li></ul></code></pre>
<p>To request certificates for your domain, run the following command:</p>
<pre class="code-pre command"><code langs=""><ul class="prefixed"><li class="line" prefix="$">sudo certbot --nginx -d code-server.<span class="highlight">your-domain</span>
</li></ul></code></pre>
<p>In this command, you run <code>certbot</code> to request certificates for your domain—you pass the domain name with the <code>-d</code> parameter. The <code>--nginx</code> flag tells it to automatically change Nginx site configuration to support HTTPS. Remember to replace <code>code-server.<span class="highlight">your-domain</span></code> with your domain name.</p>

<p>If this is your first time running Certbot, you&rsquo;ll be asked to provide an email address for urgent notices and to accept the EFF&rsquo;s Terms of Service. Certbot will then request certificates for your domain from Let&rsquo;s Encrypt. It will then ask you if you&rsquo;d like to redirect all HTTP traffic to HTTPS:</p>
<pre class="code-pre "><code langs=""><div class="secondary-code-label " title="Output">Output</div>Please choose whether or not to redirect HTTP traffic to HTTPS, removing HTTP access.
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
1: No redirect - Make no further changes to the webserver configuration.
2: Redirect - Make all requests redirect to secure HTTPS access. Choose this for
new sites, or if you're confident your site works on HTTPS. You can undo this
change by editing your web server's configuration.
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
Select the appropriate number [1-2] then [enter] (press 'c' to cancel):
</code></pre>
<p>It is recommended to select the second option in order to maximize security. After you input your selection, press <code>ENTER</code>.</p>

<p>The output will be similar to this:</p>
<pre class="code-pre "><code langs=""><div class="secondary-code-label " title="Output">Output</div>IMPORTANT NOTES:
 - Congratulations! Your certificate and chain have been saved at:
   /etc/letsencrypt/live/code-server.<span class="highlight">your-domain</span>/fullchain.pem
   Your key file has been saved at:
   /etc/letsencrypt/live/code-server.<span class="highlight">your-domain</span>/privkey.pem
   Your cert will expire on ... To obtain a new or tweaked
   version of this certificate in the future, simply run certbot again
   with the "certonly" option. To non-interactively renew *all* of
   your certificates, run "certbot renew"
 - Your account credentials have been saved in your Certbot
   configuration directory at /etc/letsencrypt. You should make a
   secure backup of this folder now. This configuration directory will
   also contain certificates and private keys obtained by Certbot so
   making regular backups of this folder is ideal.
 - If you like Certbot, please consider supporting our work by:

   Donating to ISRG / Let's Encrypt:   https://letsencrypt.org/donate
   Donating to EFF:                    https://eff.org/donate-le
</code></pre>
<p>This means that Certbot has sucessfully generated TLS certificates and applied them to the Nginx configuration for your domain. You can now reload your code-server domain in your browser and observe a padlock to the left of the site address, which means that your connection is properly secured.</p>

<p>Now you&rsquo;ll make Certbot automatically renew the certificates before they expire. To run the renewal check daily, you&rsquo;ll use <a href="https://www.digitalocean.com/community/tutorials/how-to-use-cron-to-automate-tasks-on-a-vps"><code>cron</code></a>, a standard system service for running periodic jobs. You direct <code>cron</code> by opening and editing a file called a <code>crontab</code>:</p>
<pre class="code-pre command"><code langs=""><ul class="prefixed"><li class="line" prefix="$">sudo crontab -e
</li></ul></code></pre>
<p>This command will open the default <code>crontab</code>, which is currently an empty text file. Add the following line, then save and close it:</p>
<div class="code-label " title="crontab">crontab</div><pre class="code-pre "><code langs="">. . .
15 3 * * * /usr/bin/certbot renew --quiet
</code></pre>
<p><code>15 3 * * *</code> will run the following command at 3:15 am every day—you can adapt this to any time.</p>

<p>The <code>renew</code> command for Certbot will check all certificates installed on the system and update any that are set to expire in less than thirty days. <code>--quiet</code> tells Certbot not to output information or wait for user input.</p>

<p><code>cron</code> will now run this command daily. All installed certificates will be automatically renewed and reloaded when they have thirty days or less before they expire.</p>

<p>Now that you have code-server accessible at your domain through a secured Nginx reverse proxy, you&rsquo;re ready to review the user interface of code-server.</p>

<h2 id="step-4-—-using-the-code-server-interface">Step 4 — Using the code-server Interface</h2>

<p>In this section, you&rsquo;ll use some of the features of the code-server interface. Since code-server is Visual Studio Code running in the cloud, it has the same interface as the standalone desktop edition.</p>

<p>On the left-hand side of the IDE, there is a vertical row of six buttons opening the most commonly used features in a side panel known as the Activity Bar.</p>

<p><img src="https://assets.digitalocean.com/articles/code-server-1804/step4a.png" alt="code-server GUI - Sidepanel"></p>

<p>This bar is customizable so you can move these views to a different order or remove them from the bar. By default, the first button opens the general menu in a dropdown, while the second view opens the Explorer panel that provides tree-like navigation of the project&rsquo;s structure. You can manage your folders and files here—creating, deleting, moving, and renaming them as necessary. The next view provides access to a search and replace functionality.</p>

<p>Following this, in the default order, is your view of the source control systems, like <a href="https://git-scm.com/download">Git</a>. Visual Studio code also supports other source control providers and you can find further instructions for source control work flows with the editor in this <a href="https://code.visualstudio.com/docs/editor/versioncontrol">documentation</a>.</p>

<p><img src="https://assets.digitalocean.com/articles/code-server-1804/step4b.png" alt="Git pane with context-menu open"></p>

<p>The debugger option on the Activity Bar provides all the common actions for debugging in the panel. Visual Studio Code comes with built-in support for the <a href="https://nodejs.org/">Node.js</a> runtime debugger and any language that transpiles to <a href="https://en.wikipedia.org/wiki/JavaScript">Javascript</a>. For other languages you can install <a href="https://code.visualstudio.com/docs/editor/debugging#_debugger-extensions">extensions</a> for the required debugger. You can save debugging configurations in the <code>launch.json</code> file.</p>

<p><img src="https://assets.digitalocean.com/articles/code-server-1804/step4c.png" alt="Debugger View with launch.json open"></p>

<p>The final view in the Activity Bar provides a menu to access available extensions on the <a href="https://marketplace.visualstudio.com/VSCode">Marketplace</a>.</p>

<p><img src="https://assets.digitalocean.com/articles/code-server-1804/step4d.png" alt="code-server GUI - Tabs"></p>

<p>The central part of the GUI is your editor, which you can separate by tabs for your code editing. You can change your editing view to a grid system or to side-by-side files.</p>

<p><img src="https://assets.digitalocean.com/articles/code-server-1804/step4e.png" alt="Editor Grid View"></p>

<p>After creating a new file through the <strong>File</strong> menu, an empty file will open in a new tab, and once saved, the file&rsquo;s name will be viewable in the Explorer side panel. Creating folders can be done by right clicking on the Explorer sidebar and clicking on <strong>New Folder</strong>. You can expand a folder by clicking on its name as well as dragging and dropping files and folders to upper parts of the hierarchy to move them to a new location.</p>

<p><img src="https://assets.digitalocean.com/articles/code-server-1804/step4f.png" alt="code-server GUI - New Folder"></p>

<p>You can gain access to a terminal by entering <code>CTRL+SHIFT+`</code>, or by clicking on <strong>Terminal</strong> in the upper menu dropdown, and selecting <strong>New Terminal</strong>. The terminal will open in a lower panel and its working directory will be set to the project&rsquo;s workspace, which contains the files and folders shown in the Explorer side panel.</p>

<p>You&rsquo;ve explored a high-level overview of the code-server interface and reviewed some of the most commonly used features.</p>

<h2 id="conclusion">Conclusion</h2>

<p>You now have code-server, a versatile cloud IDE, installed on your CentOS 7 server, exposed at your domain and secured using Let&rsquo;s Encrypt certificates. You can now work on projects individually, as well as in a team-collaboration setting. Running a cloud IDE frees resources on your local machine and allows you to scale the resources when needed. For further information, see the <a href="https://code.visualstudio.com/docs">Visual Studio Code documentation</a> for additional features and detailed instructions on other components of code-server.</p>

<p>If you would like to run code-server on your DigitalOcean Kubernetes cluster check out our tutorial on <a href="https://www.digitalocean.com/community/tutorials/how-to-set-up-the-code-server-cloud-ide-platform-on-digitalocean-kubernetes">How To Set Up the code-server Cloud IDE Platform on DigitalOcean Kubernetes</a>.</p>
