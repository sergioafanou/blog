---
layout: post
title: How To Set Up the Eclipse Theia Cloud IDE Platform on DigitalOcean Kubernetes
network: digitalocean
date: December 13, 2019 at 07:02PM
url: https://www.digitalocean.com/community/tutorials/how-to-set-up-the-eclipse-theia-cloud-ide-platform-on-digitalocean-kubernetes
image: https://assets.digitalocean.com/articles/eclipse-kubernetes-cloud-ide/step1a.png
tags: docker
feedtitle: DigitalOcean Community Tutorials
feedurl: https://www.digitalocean.com/community/tutorials
author: DigitalOcean
---
<p><em>The author selected the <a href="https://www.brightfunds.org/funds/foss-nonprofits">Free and Open Source Fund</a> to receive a donation as part of the <a href="https://do.co/w4do-cta">Write for DOnations</a> program.</em></p>

<h3 id="introduction">Introduction</h3>

<p>With developer tools moving to the cloud, creation and adoption of cloud IDE (Integrated Development Environment) platforms is growing. Cloud IDEs are accessible from every type of modern device through web browsers, and they offer numerous advantages for real-time collaboration scenarios. Working in a cloud IDE provides a unified development and testing environment for you and your team, while minimizing platform incompatibilities. Because they are natively based on cloud technologies, they are able to make use of the cluster to achieve tasks, which can greatly exceed the power and reliability of a single development computer.</p>

<p><a href="https://theia-ide.org/">Eclipse Theia</a> is an extensible cloud IDE running on a remote server and accessible from a web browser. Visually, it&rsquo;s designed to look and behave similarly to <a href="https://code.visualstudio.com/">Microsoft Visual Studio Code</a>, which means that it supports many programming languages, has a flexible layout, and has an integrated terminal. What separates Eclipse Theia from other cloud IDE software is its extensibility; it can be modified using <a href="https://theia-ide.org/docs/authoring_extensions">custom extensions</a>, which allow you to craft a cloud IDE suited to your needs.</p>

<p>In this tutorial, you will set up the default version of the Eclipse Theia cloud IDE platform on your DigitalOcean Kubernetes cluster and expose it at your domain, secured with Let’s Encrypt certificates and requiring the visitor to authenticate. In the end, you’ll have Eclipse Theia running on your Kubernetes cluster available via HTTPS and requiring the visitor to log in.</p>

<h2 id="prerequisites">Prerequisites</h2>

<ul>
<li><p>A DigitalOcean Kubernetes cluster with your connection configured as the <code>kubectl</code> default. Instructions on how to configure <code>kubectl</code> are shown in the <strong>Connect to your Cluster</strong> step when you create your cluster. To create a Kubernetes cluster on DigitalOcean, see <a href="https://www.digitalocean.com/docs/kubernetes/quickstart/">Kubernetes Quickstart</a>.</p></li>
<li><p>The Helm package manager installed on your local machine, and Tiller installed on your cluster. To do this, complete Steps 1 and 2 of the <a href="https://www.digitalocean.com/community/tutorials/how-to-install-software-on-kubernetes-clusters-with-the-helm-package-manager">How To Install Software on Kubernetes Clusters with the Helm Package Manager</a> tutorial.</p></li>
<li><p>The Nginx Ingress Controller and Cert Manager installed on your cluster using Helm in order to expose Eclipse Theia using Ingress Resources. To do this, follow <a href="https://www.digitalocean.com/community/tutorials/how-to-set-up-an-nginx-ingress-on-digitalocean-kubernetes-using-helm">How to Set Up an Nginx Ingress on DigitalOcean Kubernetes Using Helm</a>.</p></li>
<li><p>A fully registered domain name to host Eclipse Theia. This tutorial will use <code><span class="highlight">theia.your_domain</span></code> throughout. You can purchase a domain name on <a href="https://www.namecheap.com/">Namecheap</a>, get one for free on <a href="https://www.freenom.com/en/index.html?lang=en">Freenom</a>, or use the domain registrar of your choice.</p></li>
</ul>

<h2 id="step-1-—-installing-and-exposing-eclipse-theia">Step 1 — Installing and Exposing Eclipse Theia</h2>

<p>To begin you&rsquo;ll install Eclipse Theia to your DigitalOcean Kubernetes cluster. Then, you will expose it at your desired domain using an Nginx Ingress.</p>

<p>Since you created two example deployments and a resource as part of the prerequisites, you can freely delete them by running the following commands:</p>
<pre class="code-pre command"><code langs=""><ul class="prefixed"><li class="line" prefix="$">kubectl delete -f hello-kubernetes-ingress.yaml
</li><li class="line" prefix="$">kubectl delete -f hello-kubernetes-first.yaml
</li><li class="line" prefix="$">kubectl delete -f hello-kubernetes-second.yaml
</li></ul></code></pre>
<p>For this tutorial, you&rsquo;ll store the deployment configuration on your local machine, in a file named <code>eclipse-theia.yaml</code>. Create it using the following command:</p>
<pre class="code-pre command"><code langs=""><ul class="prefixed"><li class="line" prefix="$">nano eclipse-theia.yaml
</li></ul></code></pre>
<p>Add the following lines to the file:</p>
<div class="code-label " title="eclipse-theia.yaml">eclipse-theia.yaml</div><pre class="code-pre "><code langs="">apiVersion: v1
kind: Namespace
metadata:
  name: theia
---
apiVersion: networking.k8s.io/v1beta1
kind: Ingress
metadata:
  name: theia-next
  namespace: theia
  annotations:
    kubernetes.io/ingress.class: nginx
spec:
  rules:
  - host: <span class="highlight">theia.your_domain</span>
    http:
      paths:
      - backend:
          serviceName: theia-next
          servicePort: 80
---
apiVersion: v1
kind: Service
metadata:
 name: theia-next
 namespace: theia
spec:
 ports:
 - port: 80
   targetPort: 3000
 selector:
   app: theia-next
---
apiVersion: apps/v1
kind: Deployment
metadata:
  labels:
    app: theia-next
  name: theia-next
  namespace: theia
spec:
  selector:
    matchLabels:
      app: theia-next
  replicas: 1
  template:
    metadata:
      labels:
        app: theia-next
    spec:
      containers:
      - image: theiaide/theia:next
        imagePullPolicy: Always
        name: theia-next
        ports:
        - containerPort: 3000
</code></pre>
<p>This configuration defines a Namespace, a Deployment, a Service, and an Ingress. The Namespace is called <code>theia</code> and will contain all Kubernetes objects related to Eclipse Theia, separated from the rest of the cluster. The Deployment consists of one instance of the <a href="https://hub.docker.com/r/theiaide/theia/"><code>theiaide/theia:next</code></a> Docker image with the port <code>3000</code> exposed on the container. The Service looks for the Deployment and remaps the container port to the usual HTTP port, <code>80</code>, allowing in-cluster access to Eclipse Theia.</p>

<p>The Ingress contains a rule to serve the Service at port <code>80</code> externally at your desired domain. In its annotations, you specify that the Nginx Ingress Controller should be used for request processing. Remember to replace <code><span class="highlight">theia.your_domain</span></code> with your desired domain that you&rsquo;ve pointed to your cluster&rsquo;s Load Balancer, then save and close the file.</p>

<p>Save and exit the file.</p>

<p>Then, create the configuration in Kubernetes by running the following command:</p>
<pre class="code-pre command"><code langs=""><ul class="prefixed"><li class="line" prefix="$">kubectl create -f eclipse-theia.yaml
</li></ul></code></pre>
<p>You&rsquo;ll see the following output:</p>
<pre class="code-pre "><code langs=""><div class="secondary-code-label " title="Output">Output</div>namespace/theia created
ingress.networking.k8s.io/theia-next created
service/theia-next created
deployment.apps/theia-next created
</code></pre>
<p>You can watch the Eclipse Theia pod creation by running:</p>
<pre class="code-pre command"><code langs=""><ul class="prefixed"><li class="line" prefix="$">kubectl get pods -w -n theia
</li></ul></code></pre>
<p>The output will look like this:</p>
<pre class="code-pre "><code langs=""><div class="secondary-code-label " title="Output">Output</div>NAME                          READY   STATUS              RESTARTS   AGE
theia-next-847d8c8b49-jt9bc   0/1     ContainerCreating   0          22s
</code></pre>
<p>After some time, the status will turn to <code>RUNNING</code>, which means you&rsquo;ve successfully installed Eclipse Theia to your cluster.</p>

<p>Navigate to your domain in your browser. You&rsquo;ll see the default Eclipse Theia editor GUI.</p>

<p><img src="https://assets.digitalocean.com/articles/eclipse-kubernetes-cloud-ide/step1a.png" alt="The default Eclipse Theia editor GUI"></p>

<p>You&rsquo;ve deployed Eclipse Theia to your DigitalOcean Kubernetes cluster and exposed it at your desired domain with an Ingress. Next, you&rsquo;ll secure access to your Eclipse Theia deployment by enabling login authentication.</p>

<h2 id="step-2-—-enabling-login-authentication-for-your-domain">Step 2 — Enabling Login Authentication For Your Domain</h2>

<p>In this step, you&rsquo;ll enable username and password authentication for your Eclipse Theia deployment. You&rsquo;ll achieve this by first curating a list of valid login combinations using the <code>htpasswd</code> utility. Then, you&rsquo;ll create a Kubernetes secret containing that list and configure the Ingress to authenticate visitors according to it. In the end, your domain will only be accessible when the visitor inputs a valid username and password combination. This will prevent guests and other unwanted visitors from accessing Eclipse Theia.</p>

<p>The <a href="https://httpd.apache.org/docs/2.4/programs/htpasswd.html"><code>htpasswd</code></a> utility comes from the Apache web server and is used for creating files that store lists of login combinations. The format of <code>htpasswd</code> files is one <code>username:hashed_password</code> combination per line, which is the format the Nginx Ingress Controller expects the list to conform to.</p>

<p>Start by installing <code>htpasswd</code> on your system by running the following command:</p>
<pre class="code-pre command"><code langs=""><ul class="prefixed"><li class="line" prefix="$">sudo apt install apache2-utils -y
</li></ul></code></pre>
<p>You&rsquo;ll store the list in a file called <code>auth</code>. Create it by running:</p>
<pre class="code-pre command"><code langs=""><ul class="prefixed"><li class="line" prefix="$">touch <span class="highlight">auth</span>
</li></ul></code></pre>
<p>This file needs to be named <code>auth</code> because the Nginx Ingress Controller expects the secret to contain a key called <code>data.auth</code>. If it&rsquo;s missing, the controller will return HTTP 503 <code>Service Unavailable</code> status.</p>

<p>Add a username and password combination to <code>auth</code> by running the following command:</p>
<pre class="code-pre command"><code langs=""><ul class="prefixed"><li class="line" prefix="$">htpasswd auth <span class="highlight">username</span>
</li></ul></code></pre>
<p>Remember to replace <code><span class="highlight">username</span></code> with your desired username. You&rsquo;ll be asked for an accompanying password and the combination will be added into the <code>auth</code> file. You can repeat this command for as many users as you wish to add.</p>

<span class='note'><p>
<strong>Note:</strong> If the system you are working on does not have <code>htpasswd</code> installed, you can use a Dockerized version instead.</p>

<p>You&rsquo;ll need to have Docker installed on your machine. For instructions on how to do so, visit the <a href="https://docs.docker.com/install/">official docs</a>.</p>

<p>Run the following command to run a dockerized version:</p>
<pre class="code-pre command"><code langs=""><ul class="prefixed"><li class="line" prefix="$">docker run --rm -it httpd htpasswd -n <span class="highlight">&lt;username&gt;</span>
</li></ul></code></pre>
<p>Remember to replace <code><span class="highlight">&lt;username&gt;</span></code> with the username you want to use. You&rsquo;ll be asked for a password. The hashed login combination will be written out on the console, and you&rsquo;ll need to manually add it to the end of the <code>auth</code> file. Repeat this process for as many logins as you wish to add.<br></p></span>

<p>When you are done, create a new secret in Kubernetes with the contents of the file by running the following command:</p>
<pre class="code-pre command"><code langs=""><ul class="prefixed"><li class="line" prefix="$">kubectl create secret generic theia-basic-auth --from-file=auth -n theia
</li></ul></code></pre>
<p>You can see the secret with:</p>
<pre class="code-pre command"><code langs=""><ul class="prefixed"><li class="line" prefix="$">kubectl get secret theia-basic-auth -o yaml -n theia
</li></ul></code></pre>
<p>The output will look like:</p>
<pre class="code-pre "><code langs=""><div class="secondary-code-label " title="Output">Output</div>apiVersion: v1
data:
  auth: c2FtbXk6JGFwcjEkVFMuSDdyRWwkaFNSNWxPbkc0OEhncmpGZVFyMzEyLgo=
kind: Secret
metadata:
  creationTimestamp: "..."
  name: theia-basic-auth
  namespace: default
  resourceVersion: "10900"
  selfLink: /api/v1/namespaces/default/secrets/theia-basic-auth
  uid: 050767b9-8823-4fd3-b498-5f11074f768b
type: Opaque

</code></pre>
<p>Next, you&rsquo;ll need to edit the Ingress to make it use the secret. Open the deployment configuration for editing:</p>
<pre class="code-pre command"><code langs=""><ul class="prefixed"><li class="line" prefix="$">nano eclipse-theia.yaml
</li></ul></code></pre>
<p>Add the highlighted lines to your file:</p>
<div class="code-label " title="eclipse-theia.yaml">eclipse-theia.yaml</div><pre class="code-pre "><code langs="">apiVersion: v1
kind: Namespace
metadata:
  name: theia
---
apiVersion: networking.k8s.io/v1beta1
kind: Ingress
metadata:
  name: theia-next
  namespace: theia
  annotations:
    kubernetes.io/ingress.class: nginx
    <span class="highlight">nginx.ingress.kubernetes.io/auth-type: basic</span>
    <span class="highlight">nginx.ingress.kubernetes.io/auth-secret: theia-basic-auth</span>
    <span class="highlight">nginx.ingress.kubernetes.io/auth-realm: 'Authentication Required - Eclipse Theia'</span>
spec:
  rules:
  - host: theia.your_domain
    http:
      paths:
      - backend:
          serviceName: theia-next
          servicePort: 80
...
</code></pre>
<p>First, in the <code>auth-type</code> annotation, you specify that the authentication type is <code>basic</code>. This means that Nginx will require the user to type in a username and password. Then, in <code>auth-secret</code>, you specify that the secret that contains the list of valid combinations is <code>theia-basic-auth</code>, which you&rsquo;ve just created. The remaining <code>auth-realm</code> annotation specifies a message that will be shown to the user as an explanation of why authentication is required. You can change the message contained in this field to your liking.</p>

<p>Save and close the file.</p>

<p>To propagate the changes to your cluster, run the following command:</p>
<pre class="code-pre command"><code langs=""><ul class="prefixed"><li class="line" prefix="$">kubectl apply -f eclipse-theia.yaml
</li></ul></code></pre>
<p>You&rsquo;ll see the output:</p>
<pre class="code-pre "><code langs=""><div class="secondary-code-label " title="Output">Output</div>namespace/theia unchanged
ingress.networking.k8s.io/theia-next configured
service/theia-next unchanged
deployment.apps/theia-next unchanged
</code></pre>
<p>Navigate to your domain in your browser, where you&rsquo;ll now be asked to log in.</p>

<p>You&rsquo;ve enabled basic login authentication on your Ingress by configuring it to use the secret containing the hashed username and password combinations. In the next step, you&rsquo;ll secure access further by adding TLS certificates, so that the traffic between you and your Eclipse Theia deployment stays encrypted.</p>

<h2 id="step-3-—-applying-let-39-s-encrypt-https-certificates">Step 3 — Applying Let&rsquo;s Encrypt HTTPS Certificates</h2>

<p>Next you will secure your Eclipse Theia installation by applying Let’s Encrypt certificates to your Ingress, which Cert-Manager will automatically provision. After completing this step, your Eclipse Theia installation will be accessible via HTTPS.</p>

<p>Open <code>eclipse-theia.yaml</code> for editing:</p>
<pre class="code-pre command"><code langs=""><ul class="prefixed"><li class="line" prefix="$">nano eclipse-theia.yaml
</li></ul></code></pre>
<p>Add the highlighted lines to your file, making sure to replace the placeholder domain with your own:</p>
<div class="code-label " title="eclipse-theia.yaml">eclipse-theia.yaml</div><pre class="code-pre "><code langs="">apiVersion: v1
kind: Namespace
metadata:
  name: theia
---
apiVersion: networking.k8s.io/v1beta1
kind: Ingress
metadata:
  name: theia-next
  namespace: theia
  annotations:
    kubernetes.io/ingress.class: nginx
    nginx.ingress.kubernetes.io/auth-type: basic
    nginx.ingress.kubernetes.io/auth-secret: theia-basic-auth
    nginx.ingress.kubernetes.io/auth-realm: 'Authentication Required - Eclipse Theia'
    <span class="highlight">cert-manager.io/cluster-issuer: letsencrypt-prod</span>
spec:
  <span class="highlight">tls:</span>
  <span class="highlight">- hosts:</span>
    <span class="highlight">- theia.your_domain</span>
    <span class="highlight">secretName: theia-prod</span>
  rules:
  - host: theia.your_domain
    http:
      paths:
      - backend:
          serviceName: theia-next
          servicePort: 80
...
</code></pre>
<p>First, you specify the <code>letsencrypt-prod</code> ClusterIssuer you created as part of the prerequisites as the issuer that will be used to provision certificates for this Ingress. Then, in the <code>tls</code> section, you specify the exact domain that should be secured, as well as a name for a secret that will be holding those certificates.</p>

<p>Save and exit the file.</p>

<p>Apply the changes to your cluster by running the following command:</p>
<pre class="code-pre command"><code langs=""><ul class="prefixed"><li class="line" prefix="$">kubectl apply -f eclipse-theia.yaml
</li></ul></code></pre>
<p>The output will look like:</p>
<pre class="code-pre "><code langs=""><div class="secondary-code-label " title="Output">Output</div>namespace/theia unchanged
ingress.networking.k8s.io/theia-next configured
service/theia-next unchanged
deployment.apps/theia-next unchanged
</code></pre>
<p>It will take a few minutes for the certificates to be provisioned and fully applied. You can track the progress by observing the output of the following command:</p>
<pre class="code-pre command"><code langs=""><ul class="prefixed"><li class="line" prefix="$">kubectl describe certificate theia-prod -n theia
</li></ul></code></pre>
<p>When it finishes, the end of the output will look similar to this:</p>
<pre class="code-pre "><code langs=""><div class="secondary-code-label " title="Output">Output</div>...
Events:
  Type    Reason        Age   From          Message
  ----    ------        ----  ----          -------
  Normal  GeneratedKey  42m   cert-manager  Generated a new private key
  Normal  Requested     42m   cert-manager  Created new CertificateRequest resource "theia-prod-3785736528"
  Normal  Issued        42m   cert-manager  Certificate issued successfully
</code></pre>
<p>Refresh your domain in your browser. You&rsquo;ll see a green padlock shown on the leftmost side of the address bar signifying that the connection is secure.</p>

<p>You&rsquo;ve configured the Ingress to use Let&rsquo;s Encrypt certificates thus making your Eclipse Theia deployment more secure. Now you can review the default Eclipse Theia user interface.</p>

<h2 id="step-4-—-using-the-eclipse-theia-interface">Step 4 — Using the Eclipse Theia Interface</h2>

<p>In this section, you’ll explore some of the features of the Eclipse Theia interface.</p>

<p>On the left-hand side of the IDE, there is a vertical row of four buttons opening the most commonly used features in a side panel.</p>

<p><img src="https://assets.digitalocean.com/articles/eclipse-kubernetes-cloud-ide/step4a.png" alt="Eclipse Theia GUI - Sidepanel"></p>

<p>This bar is customizable so you can move these views to a different order or remove them from the bar. By default, the first view opens the Explorer panel that provides tree-like navigation of the project&rsquo;s structure. You can manage your folders and files here—creating, deleting, moving, and renaming them as necessary.</p>

<p>After creating a new file through the <strong>File</strong> menu, you&rsquo;ll see an empty file open in a new tab. Once saved, you can view the file&rsquo;s name in Explorer side panel. To create folders right click on the Explorer sidebar and click on <strong>New Folder</strong>. You can expand a folder by clicking on its name as well as dragging and dropping files and folders to upper parts of the hierarchy to move them to a new location.</p>

<p><img src="https://assets.digitalocean.com/articles/eclipse-kubernetes-cloud-ide/step4b.png" alt="Eclipse Theia GUI - New Folder"></p>

<p>The next two options provide access to search and replace functionality. Following it, the next one provides a view of source control systems that you may be using, such as <a href="https://git-scm.com/download">Git</a>.</p>

<p>The final view is the debugger option, which provides all the common actions for debugging in the panel. You can save debugging configurations in the <code>launch.json</code> file.</p>

<p><img src="https://assets.digitalocean.com/articles/eclipse-kubernetes-cloud-ide/step4c.png" alt="Debugger View with launch.json open"></p>

<p>The central part of the GUI is your editor, which you can separate by tabs for your code editing. You can change your editing view to a grid system or to side-by-side files. Like all modern IDEs, Eclipse Theia supports syntax highlighting for your code.</p>

<p><img src="https://assets.digitalocean.com/articles/eclipse-kubernetes-cloud-ide/step4d.png" alt="Editor Grid View"></p>

<p>You can gain access to a terminal by typing <code>CTRL+SHIFT+`</code>, or by clicking on <strong>Terminal</strong> in the upper menu, and selecting <strong>New Terminal</strong>. The terminal will open in a lower panel and its working directory will be set to the project&rsquo;s workspace, which contains the files and folders shown in the Explorer side panel.</p>

<p><img src="https://assets.digitalocean.com/articles/eclipse-kubernetes-cloud-ide/step4e.png" alt="Terminal open"></p>

<p>You’ve explored a high-level overview of the Eclipse Theia interface and reviewed some of the most commonly used features.</p>

<h2 id="conclusion">Conclusion</h2>

<p>You now have Eclipse Theia, a versatile cloud IDE, installed on your DigitalOcean Kubernetes cluster. You&rsquo;ve secured it with a free Let&rsquo;s Encrypt TLS certificate and set up the instance to require a login from the visitor. You can work on your source code and documents with it individually or collaborate with your team. You can also try building your own version of Eclipse Theia if you need additional functionality. For further information on how to do that, visit the <a href="https://theia-ide.org/docs/composing_applications/">Theia docs</a>.</p>
