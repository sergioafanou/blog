---
layout: post
title: Como instalar o MongoDB no Ubuntu 18.04
network: digitalocean
date: December 12, 2019 at 07:49PM
url: https://www.digitalocean.com/community/tutorials/how-to-install-mongodb-on-ubuntu-18-04-pt
image: http://ifttt.com/images/no_image_card.png
tags: docker
feedtitle: DigitalOcean Community Tutorials
feedurl: https://www.digitalocean.com/community/tutorials
author: DigitalOcean
---
<p><em>O autor selecionou a <a href="https://www.brightfunds.org/organizations/creative-commons-corporation-van-houweling-molly">Corporativa Creative Commons</a> para receber uma doação de $100 como parte do programa <a href="https://do.co/w4do-cta">Write for DOnations</a>.</em></p>

<h3 id="introdução">Introdução</h3>

<p><a href="https://www.mongodb.com/">O MongoDB</a> é um banco de dados de documento NoSQL de código aberto e gratuito usado habitualmente em aplicativos Web modernos.</p>

<p>Neste tutorial, você irá instalar o MongoDB, gerenciar seus serviços, e opcionalmente, habilitar o acesso remoto.</p>

<h2 id="pré-requisitos">Pré-requisitos</h2>

<p>Para seguir este tutorial, será necessário:</p>

<ul>
<li>Um servidor Ubuntu 18.04 configurado seguindo este <a href="https://www.digitalocean.com/community/tutorials/initial-server-setup-with-ubuntu-18-04">tutorial de configuração inicial do servidor</a>, incluindo um usuário sudo não-root e um firewall.</li>
</ul>

<h2 id="passo-1-—-como-instalar-o-mongodb">Passo 1 — Como instalar o MongoDB</h2>

<p>Os repositórios de pacotes oficiais do Ubuntu incluem uma versão atualizada do MongoDB, ou seja, podemos instalar os pacotes necessários utilizando o <code>apt</code>.</p>

<p>Primeiramente, atualize a lista de pacotes para ter a versão mais recente dos registros:</p>
<pre class="code-pre command"><code langs=""><ul class="prefixed"><li class="line" prefix="$">sudo apt update
</li></ul></code></pre>
<p>Agora, instale o pacote MongoDB:</p>
<pre class="code-pre command"><code langs=""><ul class="prefixed"><li class="line" prefix="$">sudo apt install -y mongodb
</li></ul></code></pre>
<p>Este comando instala vários pacotes que contêm a versão estável mais recente do MongoDB, junto com ferramentas de gerenciamento úteis para o servidor MongoDB. O servidor de banco de dados é iniciado automaticamente após a instalação.</p>

<p>Em seguida, vamos verificar se o servidor está funcionando corretamente.</p>

<h2 id="passo-2-—-como-verificar-o-serviço-e-o-banco-de-dados">Passo 2 — Como verificar o serviço e o banco de dados</h2>

<p>O processo de instalação iniciou o MongoDB automaticamente, mas vamos verificar se o serviço está iniciado e que o banco de dados está funcionando.</p>

<p>Primeiramente, verifique o estado do serviço:</p>
<pre class="code-pre command"><code langs=""><ul class="prefixed"><li class="line" prefix="$">sudo systemctl status mongodb
</li></ul></code></pre>
<p>Você verá este resultado:</p>
<pre class="code-pre "><code langs=""><div class="secondary-code-label " title="Output">Output</div>● <span class="highlight">mongodb.service</span> - An object/document-oriented database
   Loaded: loaded (/lib/systemd/system/mongodb.service; enabled; vendor preset: enabled)
   Active: <span class="highlight">active (running)</span> since Sat 2018-05-26 07:48:04 UTC; 2min 17s ago
     Docs: man:mongod(1)
 Main PID: 2312 (mongod)
    Tasks: 23 (limit: 1153)
   CGroup: /system.slice/mongodb.service
           └─2312 /usr/bin/mongod --unixSocketPrefix=/run/mongodb --config /etc/mongodb.conf
</code></pre>
<p>De acordo com o <code>systemd</code>, o servidor MongoDB está funcionando.</p>

<p>Podemos verificar isso mais adiante ao conectarmos ao servidor de banco de dados e executarmos um comando de diagnóstico</p>

<p>Execute este comando:</p>
<pre class="code-pre command"><code langs=""><ul class="prefixed"><li class="line" prefix="$">mongo --eval 'db.runCommand({ connectionStatus: 1 })'
</li></ul></code></pre>
<p>Isso mostrará a versão atual do banco de dados, o endereço e a porta do servidor, e o resultado do comando de estado:</p>
<pre class="code-pre "><code langs=""><div class="secondary-code-label " title="Output">Output</div>MongoDB shell version v3.6.3
connecting to: <span class="highlight">mongodb://127.0.0.1:27017</span>
MongoDB server version: <span class="highlight">3.6.3</span>
{
        "authInfo" : {
                "authenticatedUsers" : [ ],
                "authenticatedUserRoles" : [ ]
        },
        <span class="highlight">"ok" : 1</span>
}
</code></pre>
<p>Um valor de <code>1</code> para o campo <code>ok</code> na resposta indica que o servidor está funcionando corretamente.</p>

<p>Em seguida, vamos ver como gerenciar a instância do servidor.</p>

<h2 id="passo-3-—-como-gerenciar-o-serviço-mongodb">Passo 3 — Como gerenciar o serviço MongoDB</h2>

<p>O MongoDB instala como um serviço systemd, o que significa que você pode gerenciar ele utilizando comandos <code>systemd</code> padrões ao lado de todos os outros serviços de sytem no Ubuntu.</p>

<p>Para verificar o estado do serviço, digite:</p>
<pre class="code-pre command"><code langs=""><ul class="prefixed"><li class="line" prefix="$">sudo systemctl status mongodb
</li></ul></code></pre>
<p>É possível parar o servidor a qualquer momento digitando:</p>
<pre class="code-pre command"><code langs=""><ul class="prefixed"><li class="line" prefix="$">sudo systemctl stop mongodb
</li></ul></code></pre>
<p>Para iniciar o servidor quando ele for parado, digite:</p>
<pre class="code-pre command"><code langs=""><ul class="prefixed"><li class="line" prefix="$">sudo systemctl start mongodb
</li></ul></code></pre>
<p>Você também pode reiniciar o servidor com um único comando:</p>
<pre class="code-pre command"><code langs=""><ul class="prefixed"><li class="line" prefix="$">sudo systemctl restart mongodb
</li></ul></code></pre>
<p>Por padrão, o MongoDB está configurado para iniciar automaticamente com o servidor. Se quiser desativar o inicializador automático, digite:</p>
<pre class="code-pre command"><code langs=""><ul class="prefixed"><li class="line" prefix="$">sudo systemctl disable mongodb
</li></ul></code></pre>
<p>Habilitá-lo novamente também é fácil. Para fazer isso, utilize:</p>
<pre class="code-pre command"><code langs=""><ul class="prefixed"><li class="line" prefix="$">sudo systemctl enable mongodb
</li></ul></code></pre>
<p>Em seguida, vamos ajustar as configurações de firewall para nossa instalação do MongoDB.</p>

<h2 id="passo-4-—-como-ajustar-o-firewall-opcional">Passo 4 — Como ajustar o Firewall (opcional)</h2>

<p>Ao assumirmos que tenha seguido as instruções do <a href="https://www.digitalocean.com/community/tutorials/automating-initial-server-setup-with-ubuntu-18-04">tutorial de configuração inicial do servidor</a> para habilitar o firewall no seu servidor, então o servidor MongoDB estará inacessível pela internet.</p>

<p>Se quiser usar o servidor MongoDB apenas localmente com aplicativos funcionando no mesmo servidor, esta é a configuração recomendada e segura. Entretanto, se quiser poder se conectar ao seu servidor MongoDB pela internet, será necessário permitir as conexões recebidas em <code>ufw</code>.</p>

<p>Para permitir o acesso ao MongoDB em sua porta padrão <code>27017</code>de todos os lugares, utilize o <code>sudo ufw allow <span class="highlight">27017</span></code>. Entretanto, habilitar o acesso à internet ao servidor MongoDB em uma instalação padrão dá a qualquer um acesso ilimitado ao servidor de banco de dados e seus dados.</p>

<p>Na maioria dos casos, o MongoDB deve ser acessado apenas por certos locais confiáveis, como outro servidor que hospeda um aplicativo. Para realizar esta tarefa, permita o acesso na porta padrão do MongoDB enquanto especifica o endereço IP de outro servidor que será explicitamente permitido para se conectar:</p>
<pre class="code-pre command"><code langs=""><ul class="prefixed"><li class="line" prefix="$">sudo ufw allow from <span class="highlight">your_other_server_ip</span>/32 to any port <span class="highlight">27017</span>  
</li></ul></code></pre>
<p>Verifique a mudança nas configurações do firewall com o <code>ufw</code>:</p>
<pre class="code-pre command"><code langs=""><ul class="prefixed"><li class="line" prefix="$">sudo ufw status
</li></ul></code></pre>
<p>Você deve ver o tráfego permitido para a porta <code>27017</code> na saída:</p>
<div class="code-label " title="Output">Output</div><pre class="code-pre "><code langs="">Status: active

To                         Action      From
--                         ------      ----
OpenSSH                    ALLOW       Anywhere
<span class="highlight">27017                      ALLOW       Anywhere</span>
OpenSSH (v6)               ALLOW       Anywhere (v6)
<span class="highlight">27017 (v6)                 ALLOW       Anywhere (v6)</span>
</code></pre>
<p>Se tiver decidido permitir que apenas um certo endereço IP se conecte ao servidor MongoDB, o endereço IP do local permitido estará listado ao invés de *Anywhere *na saída.</p>

<p>Você pode encontrar configurações de firewall mais avançadas para restringir o acesso a serviços em <a href="https://www.digitalocean.com/community/tutorials/ufw-essentials-common-firewall-rules-and-commands">Essenciais do UFW: regras e comandos comuns do firewall</a>.</p>

<p>Embora a porta esteja aberta, o MongoDB agora está escutando apenas o endereço local <code>127.0.0.1</code>. Para permitir conexões remotas, adicione o endereço IP publicly-routable do seu servidor ao arquivo <code>mongod.conf</code>.</p>

<p>Abra o arquivo de configuração do MongoDB no seu editor:</p>
<pre class="code-pre command"><code langs=""><ul class="prefixed"><li class="line" prefix="$">sudo nano /etc/mongodb.conf
</li></ul></code></pre>
<p>Adicione o endereço IP do seu servidor ao valor do <code>bindIP</code>:</p>
<div class="code-label " title=""></div><pre class="code-pre "><code langs="">...
logappend=true

bind_ip = 127.0.0.1<span class="highlight">,your_server_ip</span>
#port = 27017

...
</code></pre>
<p>Certifique-se de colocar uma vírgula entre o endereço IP existente e o que você adicionou.</p>

<p>Salve o arquivo, saia do editor e reinicie o MongoDB:</p>
<pre class="code-pre command"><code langs=""><ul class="prefixed"><li class="line" prefix="$">sudo systemctl restart mongodb
</li></ul></code></pre>
<p>O MongoDB agora está escutando conexões remotas, mas qualquer um pode acessá-lo. Siga a parte 2 de <a href="https://www.digitalocean.com/community/tutorials/how-to-install-and-secure-mongodb-on-ubuntu-16-04#part-two-securing-mongodb">Como instalar e proteger o MongoDB no Ubuntu 16.04</a> para adicionar um usuário administrativo e bloquear as coisas mais adiante.</p>

<h2 id="conclusão">Conclusão</h2>

<p>Você pode encontrar tutoriais mais aprofundados sobre como configurar e utilizar o MongoDB nestes <a href="https://www.digitalocean.com/community/search?q=mongodb">artigos da comunidade DigitalOcean</a>. A <a href="https://docs.mongodb.com/v3.2/">documentação MongoDB</a> oficial também é um ótimo recurso sobre as possibilidades que o MongoDB proporciona.</p>
