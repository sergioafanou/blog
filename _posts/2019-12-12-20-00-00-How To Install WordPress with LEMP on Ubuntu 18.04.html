---
layout: post
title: How To Install WordPress with LEMP on Ubuntu 18.04
network: digitalocean
date: December 12, 2019 at 08:00PM
url: https://www.digitalocean.com/community/tutorials/how-to-install-wordpress-with-lemp-on-ubuntu-18-04-pt
image: https://assets.digitalocean.com/articles/wordpress_lemp_1604/language_selection.png
tags: docker
feedtitle: DigitalOcean Community Tutorials
feedurl: https://www.digitalocean.com/community/tutorials
author: DigitalOcean
---
<h3 id="introdução">Introdução</h3>

<p>O WordPress é o CMS (sistema de gerenciamento de conteúdos) mais popular na Internet. Ele permite que você configure blogs e sites flexíveis com facilidade, além de um back-end em MySQL com processamento em PHP. A adoção do WordPress teve um crescimento incrível, sendo uma ótima escolha para se colocar um website em funcionamento de maneira rápida. Após a configuração, quase toda a administração pode ser feita através no front-end Web.</p>

<p>Neste guia, iremos concentrar-nos na obtenção de uma instância de WordPress, configurada em pilha LEMP (Linux, Nginx, MySQL e PHP) em um servidor Ubuntu 18.04.</p>

<h2 id="pré-requisitos">Pré-requisitos</h2>

<p>Para completar este tutorial, será necessário ter acesso a um servidor Ubuntu 18.04.</p>

<p>Será necessário realizar as seguintes tarefas antes de iniciar este guia:</p>

<ul>
<li><strong>Criar um usuário <code>sudo</code> no seu servidor</strong>: vamos realizar os passos neste guia usando um usuário não raiz com privilégios <code>sudo</code>. É possível criar um usuário com privilégios <code>sudo</code> seguindo nosso <a href="https://www.digitalocean.com/community/tutorials/initial-server-setup-with-ubuntu-18-04">Guia de configuração inicial do servidor Ubuntu 18.04</a>.</li>
<li><strong>Instale uma pilha LEMP</strong>: o WordPress precisará de um servidor Web, um banco de dados e um PHP para funcionar corretamente. Configurar uma pilha LEMP (Linux, Nginx, MySQL e PHP) cumpre todos esses requisitos. Siga <a href="https://www.digitalocean.com/community/tutorials/how-to-install-linux-nginx-mysql-php-lemp-stack-ubuntu-18-04">este guia</a> para instalar e configurar este software.</li>
<li><strong>Proteger o seu site com o protocolo SSL</strong>: o Wordpress fornece conteúdo dinâmico e cuida da autenticação e autorização do usuário. O protocolo TLS/SSL é a tecnologia que permite criptografar o tráfego do seu site para que sua conexão esteja segura. A maneira como você irá configurar o SSL dependerá de se você tem um nome de domínio para seu site.

<ul>
<li><strong>Se tiver um nome de domínio&hellip;</strong> a maneira mais fácil de proteger seu site é com o Let&rsquo;s Encrypt, que oferece certificados confiáveis e gratuitos. Siga nosso guia do <a href="https://www.digitalocean.com/community/tutorials/how-to-secure-nginx-with-let-s-encrypt-on-ubuntu-18-04">Let&rsquo;s Encrypt para o Nginx</a> para configurar isto.</li>
<li><strong>Se não tiver um domínio&hellip;</strong> e somente estiver usando essa configuração para teste ou uso pessoal, em vez disso, utilize um certificado autoassinado. Tal certificado proporciona o mesmo tipo de criptografia, mas sem a validação de domínio. Siga nosso <a href="https://www.digitalocean.com/community/tutorials/how-to-create-a-self-signed-ssl-certificate-for-nginx-in-ubuntu-18-04">guia SSL autoassinado para o Nginx</a> para configurar.</li>
</ul></li>
</ul>

<p>Quando terminar os passos de configuração, faça login no seu servidor como seu usuário <code>sudo</code> e continue abaixo.</p>

<h2 id="passo-1-—-criando-um-banco-de-dados-do-mysql-e-um-usuário-para-o-wordpress">Passo 1 — Criando um banco de dados do MySQL e um usuário para o WordPress</h2>

<p>O primeiro passo que vamos dar é um passo preparatório. O WordPress utiliza o MySQL para gerenciar e armazenar as informações do site e as do usuário. Já temos o MySQL instalado, mas precisamos criar um banco de dados e um usuário para o WordPress usar.</p>

<p>Para começar, faça login na conta raiz (administrativa) do MySQL. Se o MySQL estiver configurado para usar o plug-in de autenticação <code>auth_socket</code> (o padrão), faça login na conta administrativa do MySQL usando o <code>sudo</code>:</p>
<pre class="code-pre command"><code langs=""><ul class="prefixed"><li class="line" prefix="$">sudo mysql
</li></ul></code></pre>
<p>Se alterar o método de autenticação para usar uma senha para a conta raiz do MySQL, utilize o seguinte formato:</p>
<pre class="code-pre command"><code langs=""><ul class="prefixed"><li class="line" prefix="$">mysql -u root -p
</li></ul></code></pre>
<p>Será solicitada a senha que definiu para conta raiz do MySQL.</p>

<p>Primeiramente, criamos um banco de dados separado que o WordPress pode controlar. Você pode dar o nome que quiser ao banco de dados, mas neste guia nós o chamaremos de<code>wordpress</code>para ficar mais simples. Você pode criar o banco de dados para o WordPress digitando:</p>
<pre class="code-pre custom_prefix"><code langs=""><ul class="prefixed"><li class="line" prefix="mysql&gt;">CREATE DATABASE <span class="highlight">wordpress</span> DEFAULT CHARACTER SET utf8 COLLATE utf8_unicode_ci;
</li></ul></code></pre>
<p><span class='note'><strong>Nota:</strong> cada instrução do MySQL deve terminar em um ponto e vírgula (;). Verifique para garantir que a instrução foi seguida (ou seja, o ponto e vírgula foi usado), caso estiver enfrentando algum problema.<br></span></p>

<p>Em seguida, vamos criar uma conta de usuário do MySQL separada que vamos usar exclusivamente para operar no nosso novo banco de dados. Criar bancos de dados e contas para uma função é uma boa ideia sob o ponto de vista de gerenciamento e segurança. Vamos usar o nome <code>wordpressuser</code> neste guia. Sinta-se à vontade para alterar isso se quiser.</p>

<p>Vamos criar essa conta, definir uma senha e conceder o acesso ao banco de dados que criamos. Podemos fazer isso digitando o seguinte comando: Lembre-se de escolher uma senha forte para o usuário do seu banco de dados:</p>
<pre class="code-pre custom_prefix"><code langs=""><ul class="prefixed"><li class="line" prefix="mysql&gt;">GRANT ALL ON <span class="highlight">wordpress</span>.* TO '<span class="highlight">wordpressuser</span>'@'localhost' IDENTIFIED BY '<span class="highlight">password</span>';
</li></ul></code></pre>
<p>Agora, você tem um banco de dados e uma conta de usuário, criados especificamente para o WordPress. Precisamos atualizar os privilégios para que a instância atual do MySQL saiba sobre as alterações recentes que fizemos:</p>
<pre class="code-pre custom_prefix"><code langs=""><ul class="prefixed"><li class="line" prefix="mysql&gt;">FLUSH PRIVILEGES;
</li></ul></code></pre>
<p>Saia do MySQL digitando:</p>
<pre class="code-pre custom_prefix"><code langs=""><ul class="prefixed"><li class="line" prefix="mysql&gt;">EXIT;
</li></ul></code></pre>
<p>A sessão do MySQL irá fechar, voltando você para o shell normal do Linux.</p>

<h2 id="passo-2-—-instalando-extensões-adicionais-do-php">Passo 2 — Instalando extensões adicionais do PHP</h2>

<p>Ao configurar nossa pilha LEMP, vamos precisar apenas de um conjunto pequeno de extensões para fazer com que o PHP se comunique com o MySQL. O WordPress e muitos dos seus plug-ins potencializam extensões adicionais do PHP.</p>

<p>Podemos baixar e instalar algumas das extensões PHP mais populares para serem usadas com o WordPress digitando:</p>
<pre class="code-pre command"><code langs=""><ul class="prefixed"><li class="line" prefix="$">sudo apt update
</li><li class="line" prefix="$">sudo apt install php-curl php-gd php-intl php-mbstring php-soap php-xml php-xmlrpc php-zip
</li></ul></code></pre>
<p><span class='note'><strong>Nota:</strong> cada plug-in do WordPress tem seus próprios requisitos. Alguns podem precisar de pacotes adicionais do PHP para serem instalados. Verifique a documentação do plug-in para descobrir seus requisitos PHP. Se estiverem disponíveis, eles podem podem ser instalados com o <code>apt</code> como mostrado acima.<br></span></p>

<p>Quando terminar de instalar as extensões, reinicie o processo PHP-FPM para que o processador PHP em execução possa potencializar os recursos recém-instalados:</p>
<pre class="code-pre command"><code langs=""><ul class="prefixed"><li class="line" prefix="$">sudo systemctl restart php7.2-fpm
</li></ul></code></pre>
<p>Agora, temos todas as extensões necessárias do PHP instaladas no servidor.</p>

<h2 id="passo-3-—-configurando-o-nginx">Passo 3 — Configurando o Nginx</h2>

<p>A seguir, vamos fazer alguns pequenos ajustes nos arquivos de blocos do nosso servidor Nginx. Baseado nos tutoriais com os pré-requisitos, você deve ter um arquivo de configuração para seu site no diretório <code>/etc/nginx/sites-available/</code> configurado para responder ao nome de domínio ou endereço IP do seu servidor e que está protegido por um certificado TLS/SSL. Vamos usar o <code>/etc/apache2/sites-available/wordpress</code> como exemplo, mas você deve substituir o caminho para seu arquivo de configuração, se apropriado.</p>

<p>Além disso, utilizaremos o <code>/var/www/wordpress</code> como o diretório raiz de nossa instalação do WordPress. Você deve usar a raiz da Web especificada em sua própria configuração.</p>

<p><span class='note'><strong>Nota:</strong> é possível que esteja usando a configuração padrão <code>/etc/nginx/sites-available/default</code> (com <code>/var/www/html</code> como raiz da Web). Esta configuração pode ser usada sem problemas se você só for hospedar um site neste servidor. Caso contrário, é melhor dividir a configuração necessária em blocos lógicos, sendo um arquivo por site.</span>**</p>

<p>Abra o arquivo de bloco de servidor do seu site com privilégios <code>sudo</code> para começar:</p>
<pre class="code-pre command"><code langs=""><ul class="prefixed"><li class="line" prefix="$">sudo nano /etc/nginx/sites-available/<span class="highlight">wordpress</span>
</li></ul></code></pre>
<p>Dentro do bloco de <code>server</code> principal, precisamos adicionar alguns blocos de <code>location</code>.</p>

<p>Comece criando blocos de localização que sejam exatamente correspondentes para as solicitações enviadas ao <code>/favicon.ico</code> e <code>/robots.txt</code>, pois não queremos registrar solicitações para nenhum dos dois.</p>

<p>Vamos usar um local para a expressão regular verificar as solicitações de arquivos estáticos. Novamente, vamos desligar a geração dos logs dessas solicitações e os marcaremos como altamente armazenáveis em cache, uma vez que esses recursos são normalmente caros para atender. Você pode ajustar essa lista de arquivos estáticos para conter quaisquer outras extensões de arquivos que seu site possa usar:</p>
<div class="code-label " title="/etc/nginx/sites-available/wordpress">/etc/nginx/sites-available/wordpress</div><pre class="code-pre "><code langs="">server {
    . . .

    <span class="highlight">location = /favicon.ico { log_not_found off; access_log off; }</span>
    <span class="highlight">location = /robots.txt { log_not_found off; access_log off; allow all; }</span>
    <span class="highlight">location ~* \.(css|gif|ico|jpeg|jpg|js|png)$ {</span>
        <span class="highlight">expires max;</span>
        <span class="highlight">log_not_found off;</span>
    <span class="highlight">}</span>
    . . .
}
</code></pre>
<p>Dentro do bloco existente <code>location/</code>, precisamos ajustar a lista <code>try_files</code> para que em vez de retornar um erro 404 como a opção padrão, o controle seja passado para o arquivo <code>index.php</code> com os argumentos do pedido.</p>

<p>Isto deve se parecer com isso:</p>
<div class="code-label " title="/etc/nginx/sites-available/wordpress">/etc/nginx/sites-available/wordpress</div><pre class="code-pre "><code langs="">server {
    . . .
    location / {
        <span class="highlight">#</span>try_files $uri $uri/ =404;
        <span class="highlight">try_files $uri $uri/ /index.php$is_args$args;</span>
    }
    . . .
}
</code></pre>
<p>Quando você terminar, salve e feche o arquivo.</p>

<p>Agora, podemos verificar nossa configuração quanto aos erros de sintaxe digitando:</p>
<pre class="code-pre command"><code langs=""><ul class="prefixed"><li class="line" prefix="$">sudo nginx -t
</li></ul></code></pre>
<p>Se nenhum erro foi reportado, recarregue o Nginx digitando:</p>
<pre class="code-pre command"><code langs=""><ul class="prefixed"><li class="line" prefix="$">sudo systemctl reload nginx
</li></ul></code></pre>
<p>Em seguida, vamos baixar e configurar o WordPress, propriamente dito.</p>

<h2 id="passo-4-—-fazendo-o-download-do-wordpress">Passo 4 — Fazendo o download do WordPress</h2>

<p>Agora que nosso software de servidor está configurado, podemos baixar e configurar o WordPress. Por motivos de segurança, é sempre recomendável obter a versão mais recente do WordPress do site deles.</p>

<p>Altere para um diretório gravável e baixe o arquivo comprimido da versão digitando:</p>
<pre class="code-pre command"><code langs=""><ul class="prefixed"><li class="line" prefix="$">cd /tmp
</li><li class="line" prefix="$">curl -LO https://wordpress.org/latest.tar.gz
</li></ul></code></pre>
<p>Extraia o arquivo comprimido para criar a estrutura de diretórios do WordPress:</p>
<pre class="code-pre command"><code langs=""><ul class="prefixed"><li class="line" prefix="$">tar xzvf latest.tar.gz
</li></ul></code></pre>
<p>Vamos mover esses arquivos para nossa raiz de documentos temporariamente. Antes de fazer isso, podemos copiar o arquivo de configuração de amostra para o nome de arquivo que o WordPress realmente lê:</p>
<pre class="code-pre command"><code langs=""><ul class="prefixed"><li class="line" prefix="$">cp /tmp/wordpress/wp-config-sample.php /tmp/wordpress/wp-config.php
</li></ul></code></pre>
<p>Agora, podemos copiar o conteúdo todo do diretório para nossa raiz de documentos. Estamos usando o sinalizador <code>-a</code> para garantir que nossas permissões sejam mantidas. Estamos usando um ponto no final do nosso diretório fonte para indicar que tudo dentro do diretório deve ser copiado, incluindo arquivos ocultos:</p>
<pre class="code-pre command"><code langs=""><ul class="prefixed"><li class="line" prefix="$">sudo cp -a /tmp/wordpress/. /var/www/<span class="highlight">wordpress</span>
</li></ul></code></pre>
<p>Agora que nossos arquivos estão na posição correta, vamos atribuir a propriedade sobre eles ao ao usuário e grupo <code>www-data</code>. É sob esse usuário e grupo que o Nginx executa; além disso, o Nginx terá que conseguir ler e gravar os arquivos do WordPress para atender o site e realizar atualizações automáticas.</p>
<pre class="code-pre command"><code langs=""><ul class="prefixed"><li class="line" prefix="$">sudo chown -R www-data:www-data /var/www/<span class="highlight">wordpress</span>
</li></ul></code></pre>
<p>Nossos arquivos agora estão na raiz de documento do nosso servidor e têm a propriedade correta, mas ainda assim precisamos concluir mais algumas configurações.</p>

<h2 id="passo-5-—-configurando-o-arquivo-de-configuração-do-wordpress">Passo 5 — Configurando o arquivo de configuração do WordPress</h2>

<p>Em seguida, precisamos fazer algumas alterações no arquivo de configuração principal do WordPress.</p>

<p>Quando abrirmos o arquivo, nossa prioridade será a de ajustar algumas chaves secretas para oferecer alguma segurança para a nossa instalação. O WordPress oferece um gerador seguro para esses valores para que você não tenha que tentar obter bons valores por conta própria. Esses valores são usados internamente, de modo que ter valores seguros e complexos aqui não irá atrapalhar a usabilidade.</p>

<p>Para pegar valores seguros do gerador de chave secreta do WordPress, digite:</p>
<pre class="code-pre command"><code langs=""><ul class="prefixed"><li class="line" prefix="$">curl -s https://api.wordpress.org/secret-key/1.1/salt/
</li></ul></code></pre>
<p>Você receberá valores únicos que se parecem com estes:</p>

<p><span class='warning'><strong>Aviso:</strong> é importante que você peça valores únicos sempre. <strong>NÃO</strong> copie os valores mostrados abaixo!<br></span></p>
<pre class="code-pre "><code langs=""><div class="secondary-code-label " title="Output">Output</div>define('AUTH_KEY',         '1jl/vqfs&lt;XhdXoAPz9 <span class="highlight">DO NOT COPY THESE VALUES</span> c_j{iwqD^&lt;+c9.k&lt;J@4H');
define('SECURE_AUTH_KEY',  'E2N-h2]Dcvp+aS/p7X <span class="highlight">DO NOT COPY THESE VALUES</span> {Ka(f;rv?Pxf})CgLi-3');
define('LOGGED_IN_KEY',    'W(50,{W^,OPB%PB&lt;JF <span class="highlight">DO NOT COPY THESE VALUES</span> 2;y&amp;,2m%3]R6DUth[;88');
define('NONCE_KEY',        'll,4UC)7ua+8&lt;!4VM+ <span class="highlight">DO NOT COPY THESE VALUES</span> #`DXF+[$atzM7 o^-C7g');
define('AUTH_SALT',        'koMrurzOA+|L_lG}kf <span class="highlight">DO NOT COPY THESE VALUES</span>  07VC*Lj*lD&amp;?3w!BT#-');
define('SECURE_AUTH_SALT', 'p32*p,]z%LZ+pAu:VY <span class="highlight">DO NOT COPY THESE VALUES</span> C-?y+K0DK_+F|0h{!_xY');
define('LOGGED_IN_SALT',   'i^/G2W7!-1H2OQ+t$3 <span class="highlight">DO NOT COPY THESE VALUES</span> t6**bRVFSD[Hi])-qS`|');
define('NONCE_SALT',       'Q6]U:K?j4L%Z]}h^q7 <span class="highlight">DO NOT COPY THESE VALUES</span> 1% ^qUswWgn+6&amp;xqHN&amp;%');
</code></pre>
<p>Essas são linhas de configuração que podemos colar diretamente no nosso arquivo de configuração para definir chaves seguras. Copie o resultado que acabou de receber.</p>

<p>Agora abra o arquivo de configuração do WordPress:</p>
<pre class="code-pre command"><code langs=""><ul class="prefixed"><li class="line" prefix="$">sudo nano /var/www/<span class="highlight">wordpress</span>/wp-config.php
</li></ul></code></pre>
<p>Encontre a seção que contém os valores fictícios para essas configurações. Eles se parecerão com isso:</p>
<div class="code-label " title="/var/www/wordpress/wp-config.php">/var/www/wordpress/wp-config.php</div><pre class="code-pre "><code langs="">. . .

define('AUTH_KEY',         'put your unique phrase here');
define('SECURE_AUTH_KEY',  'put your unique phrase here');
define('LOGGED_IN_KEY',    'put your unique phrase here');
define('NONCE_KEY',        'put your unique phrase here');
define('AUTH_SALT',        'put your unique phrase here');
define('SECURE_AUTH_SALT', 'put your unique phrase here');
define('LOGGED_IN_SALT',   'put your unique phrase here');
define('NONCE_SALT',       'put your unique phrase here');

. . .
</code></pre>
<p>Exclua essas linhas e cole os valores que copiou da linha de comando:</p>
<div class="code-label " title="/var/www/wordpress/wp-config.php">/var/www/wordpress/wp-config.php</div><pre class="code-pre "><code langs="">. . .

define('AUTH_KEY',         '<span class="highlight">VALUES COPIED FROM THE COMMAND LINE</span>');
define('SECURE_AUTH_KEY',  '<span class="highlight">VALUES COPIED FROM THE COMMAND LINE</span>');
define('LOGGED_IN_KEY',    '<span class="highlight">VALUES COPIED FROM THE COMMAND LINE</span>');
define('NONCE_KEY',        '<span class="highlight">VALUES COPIED FROM THE COMMAND LINE</span>');
define('AUTH_SALT',        '<span class="highlight">VALUES COPIED FROM THE COMMAND LINE</span>');
define('SECURE_AUTH_SALT', '<span class="highlight">VALUES COPIED FROM THE COMMAND LINE</span>');
define('LOGGED_IN_SALT',   '<span class="highlight">VALUES COPIED FROM THE COMMAND LINE</span>');
define('NONCE_SALT',       '<span class="highlight">VALUES COPIED FROM THE COMMAND LINE</span>');

. . .
</code></pre>
<p>Em seguida, precisamos modificar algumas das configurações de conexão do banco de dados no início do arquivo. Você precisa ajustar o nome do banco de dados, o usuário do banco de dados e a senha associada que configuramos no MySQL.</p>

<p>A outra mudança que precisamos fazer é definir o método que o WordPress deve usar para gravar no sistema de arquivos. Uma vez que demos permissão ao servidor Web para gravar onde ele precisar, podemos definir explicitamente o método do sistema de arquivos como &ldquo;direct&rdquo; (direto). Deixar de definir esse método de acesso - usando nossas configurações atuais, levaria o WordPress a solicitar credenciais FTP quando realizássemos algumas ações. Esta configuração pode ser adicionada abaixo das configurações de conexão do banco de dados ou em qualquer outro lugar no arquivo:</p>
<div class="code-label " title="/var/www/wordpress/wp-config.php">/var/www/wordpress/wp-config.php</div><pre class="code-pre "><code langs="">. . .

define('DB_NAME', '<span class="highlight">wordpress</span>');

/** MySQL database username */
define('DB_USER', '<span class="highlight">wordpressuser</span>');

/** MySQL database password */
define('DB_PASSWORD', '<span class="highlight">password</span>');

. . .

<span class="highlight">define('FS_METHOD', 'direct');</span>
</code></pre>
<p>Salve e feche o arquivo quando você terminar.</p>

<h2 id="passo-6-—-concluindo-a-instalação-através-da-interface-com-a-web">Passo 6 — Concluindo a instalação através da Interface com a Web</h2>

<p>Agora que a configuração do servidor está completa, podemos concluir a instalação através da interface com a Web.</p>

<p>No seu navegador Web, navegue até o nome de domínio do seu servidor ou endereço IP público:</p>
<pre class="code-pre "><code langs="">http://<span class="highlight">server_domain_or_IP</span>
</code></pre>
<p>Selecione a linguagem que você gostaria de usar:</p>

<p><img src="https://assets.digitalocean.com/articles/wordpress_lemp_1604/language_selection.png" alt="WordPress language selection"></p>

<p>Em seguida, você chegará à página de configuração principal.</p>

<p>Selecione um nome para seu site do WordPress e escolha um nome de usuário (É recomendável não escolher algo como &ldquo;admin&rdquo; por motivos de segurança). Uma senha forte será gerada automaticamente. Salve essa senha ou selecione uma senha forte alternativa.</p>

<p>Digite seu endereço de e-mail e selecione se deseja impedir que mecanismos de pesquisa façam a indexação do seu site:</p>

<p><img src="https://assets.digitalocean.com/articles/wordpress_lemp_1604/setup_installation.png" alt="WordPress setup installation​​​"></p>

<p>Quando clicar adiante, você será levado para uma página que solicita que você faça login:</p>

<p><img src="https://assets.digitalocean.com/articles/wordpress_lemp_1604/login_prompt.png" alt="WordPress login prompt"></p>

<p>Assim que fizer login, será levado para o painel de administração do WordPress:</p>

<p><img src="https://assets.digitalocean.com/articles/wordpress_lemp_1604/admin_screen.png" alt="WordPress login prompt"></p>

<h2 id="conclusão">Conclusão</h2>

<p>O Wordpress deve estar instalado e pronto para usar! Alguns dos passos comuns na sequência serão: escolher a configuração dos permalinks dos seus posts (pode ser encontrado em <code>Configurações &gt; Permalinks</code>) ou selecionar um novo tema (em <code>Appearance &gt; Themes</code>). Se esta é a primeira vez que usa o WordPress, explore a interface um pouco para se familiarizar com o seu novo CMS.</p>
