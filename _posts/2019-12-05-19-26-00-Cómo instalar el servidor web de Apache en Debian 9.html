---
layout: post
title: Cómo instalar el servidor web de Apache en Debian 9
network: digitalocean
date: December 05, 2019 at 07:26PM
url: https://www.digitalocean.com/community/tutorials/como-instalar-el-servidor-web-de-apache-en-debian-9-es
image: http://assets.digitalocean.com/how-to-install-lamp-debian-9/small_apache_default_debian9.png
tags: docker
feedtitle: DigitalOcean Community Tutorials
feedurl: https://www.digitalocean.com/community/tutorials
author: DigitalOcean
---
<h3 id="introducción">Introducción</h3>

<p>El servidor HTTP Apache es el más usado del mundo. Ofrece muchas características potentes, entre las que se incluyen módulos que se cargan de forma dinámica, una sólida compatibilidad con medios y amplia integración con otras herramientas de software populares.</p>

<p>En esta guía, explicaremos la forma de instalar el servidor web de Apache en su servidor de Debian 9.</p>

<h2 id="requisitos-previos">Requisitos previos</h2>

<p>Antes de comenzar a aplicar esta guía, debe tener un usuario no root normal con privilegios sudo configurado en su servidor. Además, deberá habilitar un firewall básico para que bloquee los puertos que no sean esenciales. Para aprender a configurar una cuenta normal de usuario y un firewall para su servidor, siga nuestra <a href="https://www.digitalocean.com/community/tutorials/initial-server-setup-with-debian-9">guía de configuración inicial para servidores de Debian 9</a>.</p>

<p>Cuando disponga de una cuenta, inicie sesión como usuario no root para comenzar.</p>

<h2 id="paso-1-instalar-apache">Paso 1: Instalar Apache</h2>

<p>Apache está disponible dentro de los repositorios de software predeterminados de Debian, lo que permite instalarlo utilizando herramientas convencionales de administración de paquetes.</p>

<p>Comencemos actualizando el índice de paquetes locales para que reflejen los últimos cambios anteriores:</p>
<pre class="code-pre command"><code langs=""><ul class="prefixed"><li class="line" prefix="$">sudo apt update
</li></ul></code></pre>
<p>A continuación, instale el paquete <code>apache2</code>:</p>
<pre class="code-pre command"><code langs=""><ul class="prefixed"><li class="line" prefix="$">sudo apt install apache2
</li></ul></code></pre>
<p>Una vez confirmada la instalación, <code>apt</code> instalará Apache y todas las dependencias necesarias.</p>

<h2 id="paso-2-ajustar-el-firewall">Paso 2: Ajustar el firewall</h2>

<p>Antes de probar Apache, es necesario modificar los ajustes de firewall para permitir el acceso externo a los puertos web predeterminados. Suponiendo que siguió las instrucciones de los requisitos previos, debería tener un firewall UFW configurado para que restrinja el acceso a su servidor.</p>

<p>Durante la instalación, Apache se registra con UFW para proporcionar algunos perfiles de aplicación que pueden utilizarse para habilitar o deshabilitar el acceso a Apache a través del firewall.</p>

<p>Enumere los perfiles de aplicación <code>ufw</code> escribiendo lo siguiente:</p>
<pre class="code-pre command"><code langs=""><ul class="prefixed"><li class="line" prefix="$">sudo ufw app list
</li></ul></code></pre>
<p>Verá una lista de los perfiles de aplicación:</p>
<pre class="code-pre "><code langs=""><div class="secondary-code-label " title="Output">Output</div>Available applications:
  AIM
  Bonjour
  CIFS
. . . 
 WWW
 WWW Cache
 WWW Full
 WWW Secure
. . . 
</code></pre>
<p>Los perfiles de Apache comienzan con WWW:</p>

<ul>
<li><strong>WWW</strong>: este perfil abre solo el puerto 80 (tráfico web normal no cifrado).</li>
<li><strong>WWW Cache</strong>: este perfil abre solo el puerto 8080 (algunas veces se utiliza para proxies web y de caché).</li>
<li><strong>WWW Full</strong>: este perfil abre el puerto 80 (tráfico web normal no cifrado) y el puerto 443 (tráfico cifrado de TLS/SSL).</li>
<li><strong>WWW Secure</strong>: este perfil abre solo el puerto 443 (tráfico cifrado de TLS/SSL).</li>
</ul>

<p>Se recomienda habilitar el perfil más restrictivo, que de todos modos permitirá el tráfico que configuró. Debido a que en esta guía aún no configuramos SSL para nuestro servidor, solo deberemos permitir el tráfico en el puerto 80:</p>
<pre class="code-pre command"><code langs=""><ul class="prefixed"><li class="line" prefix="$">sudo ufw allow 'WWW'
</li></ul></code></pre>
<p>Puede verificar el cambio escribiendo lo siguiente:</p>
<pre class="code-pre command"><code langs=""><ul class="prefixed"><li class="line" prefix="$">sudo ufw status
</li></ul></code></pre>
<p>Debería ver el tráfico HTTP permitido en el resultado que se muestra:</p>
<pre class="code-pre "><code langs=""><div class="secondary-code-label " title="Output">Output</div>Status: active

To                         Action      From
--                         ------      ----
OpenSSH                    ALLOW       Anywhere
WWW                        ALLOW       Anywhere
OpenSSH (v6)               ALLOW       Anywhere (v6)
WWW (v6)                   ALLOW       Anywhere (v6)
</code></pre>
<p>Como puede ver, el perfil se activó para permitir el acceso al servidor web.</p>

<h2 id="paso-3-comprobar-su-servidor-web">Paso 3: Comprobar su servidor web</h2>

<p>Al final del proceso de instalación, Debian 9 inicia Apache. El servidor web ya debería estar en funcionamiento.</p>

<p>Realice una verificación con el sistema <code>systemd</code> init para saber si se encuentra en ejecución el servicio escribiendo lo siguiente:</p>
<pre class="code-pre command"><code langs=""><ul class="prefixed"><li class="line" prefix="$">sudo systemctl status apache2
</li></ul></code></pre><pre class="code-pre "><code langs=""><div class="secondary-code-label " title="Output">Output</div>● apache2.service - The Apache HTTP Server
   Loaded: loaded (/lib/systemd/system/apache2.service; enabled; vendor preset: enabled)
   Active: active (running) since Wed 2018-09-05 19:21:48 UTC; 13min ago
 Main PID: 12849 (apache2)
   CGroup: /system.slice/apache2.service
           ├─12849 /usr/sbin/apache2 -k start
           ├─12850 /usr/sbin/apache2 -k start
           └─12852 /usr/sbin/apache2 -k start

Sep 05 19:21:48 apache systemd[1]: Starting The Apache HTTP Server...
Sep 05 19:21:48 apache systemd[1]: Started The Apache HTTP Server.
</code></pre>
<p>Como puede ver en este resultado, parece que el servicio se inició correctamente. Sin embargo, la mejor forma de comprobarlo es solicitar una página de Apache.</p>

<p>Puede acceder a la página de destino predeterminada de Apache para confirmar que el software funcione correctamente mediante su dirección IP: Si no conoce la dirección IP de su servidor, puede obtenerla de varias formas desde la línea de comandos.</p>

<p>Intente escribir esto en la línea de comandos de su servidor:</p>
<pre class="code-pre command"><code langs=""><ul class="prefixed"><li class="line" prefix="$">hostname -I
</li></ul></code></pre>
<p>Obtendrá algunas direcciones separadas por espacios. Puede probar cada una de ellas en su navegador web para ver si funcionan.</p>

<p>Una alternativa es usar la herramienta <code>curl</code>, que debería proporcionarle su dirección IP pública tal como se ve desde otra ubicación en Internet.</p>

<p>Primero, instale <code>curl</code> utilizando <code>apt</code>:</p>
<pre class="code-pre command"><code langs=""><ul class="prefixed"><li class="line" prefix="$">sudo apt install curl
</li></ul></code></pre>
<p>Luego, utilice <code>curl</code> para recuperar icanhazip.com mediante IPv4:</p>
<pre class="code-pre command"><code langs=""><ul class="prefixed"><li class="line" prefix="$">curl -4 icanhazip.com
</li></ul></code></pre>
<p>Cuando tenga la dirección IP de su servidor, introdúzcala en la barra de direcciones de su navegador:</p>
<pre class="code-pre "><code langs="">http://<span class="highlight">your_server_ip</span>
</code></pre>
<p>Debería ver la página web predeterminada de Apache de Debian 9:</p>

<p><img src="http://assets.digitalocean.com/how-to-install-lamp-debian-9/small_apache_default_debian9.png" alt="Página predeterminada de Apache"></p>

<p>Esta página indica que Apache funciona correctamente. También incluye información básica sobre archivos y ubicaciones de directorios importantes de Apache.</p>

<h2 id="paso-4-administrar-el-proceso-de-apache">Paso 4: Administrar el proceso de Apache</h2>

<p>Ahora el servidor web funciona, repasemos algunos comandos de administración básicos.</p>

<p>Para detener su servidor web, escriba lo siguiente:</p>
<pre class="code-pre command"><code langs=""><ul class="prefixed"><li class="line" prefix="$">sudo systemctl stop apache2
</li></ul></code></pre>
<p>Para iniciar el servidor web cuando se detenga, escriba lo siguiente:</p>
<pre class="code-pre command"><code langs=""><ul class="prefixed"><li class="line" prefix="$">sudo systemctl start apache2
</li></ul></code></pre>
<p>Para detener y luego iniciar el servicio de nuevo, escriba lo siguiente:</p>
<pre class="code-pre command"><code langs=""><ul class="prefixed"><li class="line" prefix="$">sudo systemctl restart apache2
</li></ul></code></pre>
<p>Si solo realiza cambios de configuración, Apache a menudo puede recargarse sin cerrar conexiones. Para hacerlo, utilice este comando:</p>
<pre class="code-pre command"><code langs=""><ul class="prefixed"><li class="line" prefix="$">sudo systemctl reload apache2
</li></ul></code></pre>
<p>Por defecto, Apache está configurado para iniciarse automáticamente cuando el servidor lo hace. Si no es lo que quiere, deshabilite este comportamiento escribiendo lo siguiente:</p>
<pre class="code-pre command"><code langs=""><ul class="prefixed"><li class="line" prefix="$">sudo systemctl disable apache2
</li></ul></code></pre>
<p>Para volver a habilitar el servicio de modo que se cargue en el inicio, escriba lo siguiente:</p>
<pre class="code-pre command"><code langs=""><ul class="prefixed"><li class="line" prefix="$">sudo systemctl enable apache2
</li></ul></code></pre>
<p>Ahora, Apache debería iniciarse de forma automática cuando el servidor lo haga de nuevo.</p>

<h2 id="paso-5-configurar-hosts-virtuales-recomendado">Paso 5: Configurar hosts virtuales (recomendado)</h2>

<p>Al emplear el servidor web Apache, puede utilizar _hosts virtuales _(similares a bloques de servidor de Nginx) para encapsular detalles de configuración y alojar más de un dominio desde un único servidor. Configuraremos un dominio llamado <strong>example.com</strong>, pero debería <strong>cambiarlo por su propio nombre de dominio</strong>. Consulte nuestra <a href="https://www.digitalocean.com/community/tutorials/an-introduction-to-digitalocean-dns">Introducción a DNS de DigitalOcean</a> para hallar más información sobre la configuración de un nombre de dominio con DigitalOcean.</p>

<p>Por defecto, Apache en Debian 9 tiene habilitado un bloque de servidor que está configurado para proporcionar documentos del directorio <code>/var/www/html</code>. Si bien esto funciona bien para un solo sitio, puede ser difícil de manejar si aloja varios. En vez de modificar <code>/var/www/html</code>, crearemos una estructura de directorio dentro de <code>/var/www</code> para nuestro sitio <strong>example.com</strong> y dejaremos <code>/var/www/html</code> como directorio predeterminado que se abastecerá si una solicitud de cliente no coincide con otros sitios.</p>

<p>Cree el directorio para <strong>example.com</strong>, utilizando el indicador <code>-p</code> para crear cualquier directorio principal necesario:</p>
<pre class="code-pre commmand"><code langs="">sudo mkdir -p /var/www/<span class="highlight">example.com</span>/html
</code></pre>
<p>A continuación, asigne la propiedad del directorio con la variable de entorno <code>$USER</code>:</p>
<pre class="code-pre command"><code langs=""><ul class="prefixed"><li class="line" prefix="$">sudo chown -R $USER:$USER /var/www/<span class="highlight">example.com</span>/html
</li></ul></code></pre>
<p>Los permisos de sus root web deberían ser correctos si no modificó su valor <code>unmask</code>, pero puede comprobarlo escribiendo lo siguiente:</p>
<pre class="code-pre command"><code langs=""><ul class="prefixed"><li class="line" prefix="$">sudo chmod -R 755 /var/www/<span class="highlight">example.com</span>
</li></ul></code></pre>
<p>A continuación, cree una página de ejemplo <code>index.html</code> utilizando <code>nano</code> o su editor favorito:</p>
<pre class="code-pre command"><code langs=""><ul class="prefixed"><li class="line" prefix="$">nano /var/www/<span class="highlight">example.com</span>/html/index.html
</li></ul></code></pre>
<p>Dentro de ella, agregue el siguiente ejemplo de HTML:</p>
<div class="code-label " title="/var/www/example.com/html/index.html">/var/www/example.com/html/index.html</div><pre class="code-pre "><code langs="">&lt;html&gt;
    &lt;head&gt;
        &lt;title&gt;Welcome to <span class="highlight">Example.com</span>!&lt;/title&gt;
    &lt;/head&gt;
    &lt;body&gt;
        &lt;h1&gt;Success!  The <span class="highlight">example.com</span> virtual host is working!&lt;/h1&gt;
    &lt;/body&gt;
&lt;/html&gt;
</code></pre>
<p>Guarde y cierre el archivo cuando termine.</p>

<p>Para que Apache proporcione este contenido, es necesario crear un archivo de host virtual con las directivas correctas. En lugar de modificar el archivo de configuración predeterminado situado en <code>/etc/apache2/sites-available/000-default.conf</code> directamente, crearemos uno nuevo en <code>/etc/apache2/sites-available/<span class="highlight">example.com</span>.conf</code>:</p>
<pre class="code-pre command"><code langs=""><ul class="prefixed"><li class="line" prefix="$">sudo nano /etc/apache2/sites-available/<span class="highlight">example.com</span>.conf
</li></ul></code></pre>
<p>Péguelo en el siguiente bloque de configuración, similar al predeterminado, pero actualizado para nuestro nuevo directorio y nombre de dominio:</p>
<div class="code-label " title="/etc/apache2/sites-available/example.com.conf">/etc/apache2/sites-available/example.com.conf</div><pre class="code-pre "><code langs="">&lt;VirtualHost *:80&gt;
    ServerAdmin <span class="highlight">admin@example.com</span>
    ServerName <span class="highlight">example.com</span>
    ServerAlias <span class="highlight">www.example.com</span>
    DocumentRoot /var/www/<span class="highlight">example.com</span>/html
    ErrorLog ${APACHE_LOG_DIR}/error.log
    CustomLog ${APACHE_LOG_DIR}/access.log combined
&lt;/VirtualHost&gt;
</code></pre>
<p>Tenga en cuenta que cambiamos <code>DocumentRoot</code> por nuestro nuevo directorio y <code>ServerAdmin</code> por un correo electrónico al que pueda acceder el administrador del sitio <strong>example.com</strong>. También agregamos dos directivas: <code>ServerName</code>, que establece el dominio de base que debería coincidir para esta definición de host virtual, y <code>ServerAlias</code>, que define más nombres que deberían coincidir como si fuesen el nombre de base.</p>

<p>Guarde y cierre el archivo cuando termine.</p>

<p>Habilitaremos el archivo con la herramienta <code>a2ensite</code>:</p>
<pre class="code-pre command"><code langs=""><ul class="prefixed"><li class="line" prefix="$">sudo a2ensite <span class="highlight">example.com</span>.conf
</li></ul></code></pre>
<p>Deshabilite el sitio predeterminado definido en <code>000-default.conf</code>:</p>
<pre class="code-pre command"><code langs=""><ul class="prefixed"><li class="line" prefix="$">sudo a2dissite 000-default.conf
</li></ul></code></pre>
<p>A continuación, realizaremos una prueba para ver que no haya errores de configuración:</p>
<pre class="code-pre command"><code langs=""><ul class="prefixed"><li class="line" prefix="$">sudo apache2ctl configtest
</li></ul></code></pre>
<p>Debería ver el siguiente resultado:</p>
<pre class="code-pre "><code langs=""><div class="secondary-code-label " title="Output">Output</div>Syntax OK
</code></pre>
<p>Reinicie Apache para implementar sus cambios:</p>
<pre class="code-pre command"><code langs=""><ul class="prefixed"><li class="line" prefix="$">sudo systemctl restart apache2
</li></ul></code></pre>
<p>Con esto, Apache debería ser el servidor de su nombre de dominio. Puede probar esto visitando <code>http://<span class="highlight">example.com</span></code>. Allí, debería ver algo como lo siguiente:</p>

<p><img src="https://assets.digitalocean.com/articles/apache_virt_hosts_1404/example.png" alt="Ejemplo de host virtual de Apache"></p>

<h2 id="paso-6-familiarizarse-con-archivos-y-direcciones-importantes-de-apache">Paso 6: Familiarizarse con archivos y direcciones importantes de Apache</h2>

<p>Ahora que sabe administrar el propio servicio de Apache, debe tomarse unos minutos para familiarizarse con algunos directorios y archivos importantes.</p>

<h3 id="contenido">Contenido</h3>

<ul>
<li><code>/var/www/html</code>: el contenido web real, que por defecto solo consta de la página predeterminada de Apache que vio antes, se proporciona desde el directorio <code>/var/www/html</code>. Esto se puede cambiar modificando los archivos de configuración de Apache.</li>
</ul>

<h3 id="configuración-del-servidor">Configuración del servidor</h3>

<ul>
<li><code>/etc/apache2</code>: el directorio de configuración de Apache. En él se encuentran todos los archivos de configuración de Apache.</li>
<li><code>/etc/apache2/apache2.conf</code>: el archivo principal de configuración de Apache. Esto se puede modificar para realizar cambios en la configuración general de Apache. Este archivo administra la carga de muchos de los demás archivos del directorio de configuración.</li>
<li><code>/etc/apache2/ports.conf</code>: este archivo especifica los puertos en los que Apache escuchará. Por defecto, Apache escucha en el puerto 80. De forma adicional, lo hace en el 443 cuando se habilita un módulo que proporciona capacidades SSL.</li>
<li><code>/etc/apache2/sites-available/</code>: el directorio en el que se pueden almacenar hosts por sitio. Apache no utilizará los archivos de configuración de este directorio a menos que estén vinculados al directorio <code>sites-enabled</code>. Normalmente, toda la configuración de bloques de servidor se realiza en este directorio y luego se habilita al vincularse al otro directorio con el comando <code>a2ensite.</code></li>
<li><code>/etc/apache2/sites-enabled/</code>: el directorio donde se almacenan hosts virtuales por sitio habilitados. Normalmente, se crean vinculando los archivos de configuración del directorio <code>sites-available</code> con <code>a2ensite</code>. Apache lee los archivos de configuración y los enlaces de este directorio cuando se inicia o se vuelve a cargar para compilar una configuración completa.</li>
<li><code>/etc/apache2/conf-available/</code> y <code>/etc/apache2/conf-enabled/</code>: estos directorios tienen la misma relación que los directorios <code>sites-available</code> y <code>sites-enabled</code>, pero se utilizan para almacenar fragmentos de configuración que no pertenecen a un host virtual. Los archivos del directorio <code>conf-available</code> pueden habilitarse con el comando <code>a2enconf</code> y deshabilitarse con el comando <code>a2disconf</code>.</li>
<li><code>/etc/apache2/mods-available/</code> y <code>/etc/apache2/mods-enabled/</code>: estos directorios contienen los módulos disponibles y habilitados, respectivamente. Los archivos que terminan en <code>.load</code> contienen fragmentos para cargar módulos específicos, mientras que los archivos que terminan en <code>.conf</code> contienen la configuración de estos módulos. Los módulos pueden habilitarse y deshabilitarse con los comandos <code>a2enmod</code> y <code>a2dissmod</code>.</li>
</ul>

<h3 id="registros-del-servidor">Registros del servidor</h3>

<ul>
<li><code>/var/log/apache2/access.log</code>: por defecto, cada solicitud enviada a su servidor web se asienta en este archivo de registro a menos que Apache esté configurado para no hacerlo.</li>
<li><code>/var/log/apache2/error.log</code>: por defecto, todos los errores se registran en este archivo. La directiva <code>LogLevel</code> de la configuración de Apache especifica el nivel de detalle de los registros de error.</li>
</ul>

<h2 id="conclusión">Conclusión</h2>

<p>Ahora que ha instaló su servidor web, dispone de varias opciones respecto del tipo de contenido que puede ofrecer y de las tecnologías que puede utilizar para crear una experiencia más completa.</p>

<p>Si desea construir una pila de aplicaciones más completa, puede consultar este artículo sobre <a href="https://www.digitalocean.com/community/tutorials/how-to-install-linux-apache-mariadb-php-lamp-stack-debian9">cómo configurar una pila LAMP en Debian 9</a>.</p>
