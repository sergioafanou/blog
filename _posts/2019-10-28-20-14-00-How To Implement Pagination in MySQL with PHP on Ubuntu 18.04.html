---
layout: post
title: How To Implement Pagination in MySQL with PHP on Ubuntu 18.04
network: digitalocean
date: October 28, 2019 at 08:14PM
url: https://www.digitalocean.com/community/tutorials/how-to-implement-pagination-in-mysql-with-php-on-ubuntu-18-04
image: https://assets.digitalocean.com/articles/mysql_pagination1804/step2a.png
tags: docker
feedtitle: DigitalOcean Community Tutorials
feedurl: https://www.digitalocean.com/community/tutorials
author: DigitalOcean
---
<p><em>The author selected the <a href="https://www.brightfunds.org/organizations/apache-software-foundation">the Apache Software Foundation</a> to receive a donation as part of the <a href="https://do.co/w4do-cta">Write for DOnations</a> program.</em></p>

<h3 id="introduction">Introduction</h3>

<p>Pagination is the concept of constraining the number of returned rows in a recordset into separate, orderly pages to allow easy navigation between them, so when there is a large dataset you can configure your pagination to only return a specific number of rows on each page. For example, pagination can help to avoid overwhelming users when a web store contains thousands of products by reducing the number of items listed on a page, as it&rsquo;s often unlikely a user will need to view every product. Another example is an application that shows records on a mobile device; enabling pagination in such a case would split records into multiple pages that can fit better on a screen.</p>

<p>Besides the visual benefits for end-users, pagination makes applications faster because it reduces the number of records that are returned at a time. This limits the data that needs to be transmitted between the client and the server, which helps preserve server resources such as RAM.</p>

<p>In this tutorial, you&rsquo;ll build a <a href="https://www.php.net/">PHP</a> script to connect to your database and implement pagination to your script using the <a href="https://www.mysql.com/">MySQL</a> <a href="https://dev.mysql.com/doc/refman/5.5/en/limit-optimization.html"><code>LIMIT</code> clause</a>.</p>

<h2 id="prerequisites">Prerequisites</h2>

<p>Before you begin, you will need the following:</p>

<ul>
<li>One Ubuntu 18.04 server set up by following the <a href="https://www.digitalocean.com/community/tutorials/initial-server-setup-with-ubuntu-18-04">Initial Server Setup with Ubuntu 18.04</a>, including a sudo non-root user.</li>
<li>Apache, MySQL, and PHP installed on your system. You can follow the guide on <a href="https://www.digitalocean.com/community/tutorials/how-to-install-linux-apache-mysql-php-lamp-stack-ubuntu-18-04">How To Install Linux, Apache, MySQL, PHP (LAMP) stack on Ubuntu 18.04</a>.</li>
</ul>

<h2 id="step-1-—-creating-a-database-user-and-a-test-database">Step 1 — Creating a Database User and a Test Database</h2>

<p>In this tutorial you&rsquo;ll create a PHP script that will connect to a MySQL database, fetch records, and display them in an HTML page within a table. You&rsquo;ll test the PHP script in two different ways from your web browser. First, creating a script without any pagination code to see how the records are displayed. Second, adding page navigation code in the PHP file to understand how pagination works practically.</p>

<p>The PHP code requires a MySQL user for authentication purposes and a sample database to connect to. In this step you&rsquo;ll create a non-root user for your MySQL database, a sample database, and a table to test the PHP script.</p>

<p>To begin log in to your server. Then log in to your MySQL server with the following command:</p>
<pre class="code-pre command"><code langs=""><ul class="prefixed"><li class="line" prefix="$">sudo mysql -u root -p
</li></ul></code></pre>
<p>Enter the <strong>root</strong> password of your MySQL server and hit <code>ENTER</code> to continue. Then, you&rsquo;ll see the MySQL prompt. To create a sample database, which we will call <code><span class="highlight">test_db</span></code> in this tutorial, run the following command:</p>
<pre class="code-pre custom_prefix"><code langs=""><ul class="prefixed"><li class="line" prefix="mysql&gt;">Create database <span class="highlight">test_db</span>;
</li></ul></code></pre>
<p>You will see the following output:</p>
<pre class="code-pre "><code langs=""><div class="secondary-code-label " title="Output">Output</div>Query OK, 1 row affected (0.00 sec)
</code></pre>
<p>Then, create a <code><span class="highlight">test_user</span></code> and grant the user all privileges to the <code><span class="highlight">test_db</span></code>. Replace <code><span class="highlight">PASSWORD</span></code> with a strong value:</p>
<pre class="code-pre custom_prefix"><code langs=""><ul class="prefixed"><li class="line" prefix="mysql&gt;">GRANT ALL PRIVILEGES ON test_db.* TO 'test_user'@'localhost' IDENTIFIED BY '<span class="highlight">PASSWORD</span>';
</li></ul></code></pre><pre class="code-pre "><code langs=""><div class="secondary-code-label " title="Output">Output</div>Query OK, 1 row affected (0.00 sec)
</code></pre>
<p>Reload the MySQL privileges with:</p>
<pre class="code-pre custom_prefix"><code langs=""><ul class="prefixed"><li class="line" prefix="mysql&gt;">FLUSH PRIVILEGES;
</li></ul></code></pre><pre class="code-pre "><code langs=""><div class="secondary-code-label " title="Output">Output</div>Query OK, 1 row affected (0.00 sec)
</code></pre>
<p>Next, switch to the <code><span class="highlight">test_db</span></code> database to start working directly on the <code><span class="highlight">test_db</span></code> database:</p>
<pre class="code-pre custom_prefix"><code langs=""><ul class="prefixed"><li class="line" prefix="mysql&gt;">Use <span class="highlight">test_db;</span>
</li></ul></code></pre><pre class="code-pre "><code langs=""><div class="secondary-code-label " title="Output">Output</div>Database changed
</code></pre>
<p>Now create a <code>products</code> table. The table will hold your sample products—for this tutorial you&rsquo;ll require only two columns for the data. The <code>product_id</code> column will serve as the primary key to uniquely identify each record. You&rsquo;ll use the <code>product_name</code> field to differentiate each item by name:</p>
<pre class="code-pre custom_prefix"><code langs=""><ul class="prefixed"><li class="line" prefix="mysql&gt;">Create table products (product_id BIGINT PRIMARY KEY, product_name VARCHAR(50) NOT NULL ) Engine = InnoDB;
</li></ul></code></pre><pre class="code-pre "><code langs=""><div class="secondary-code-label " title="Output">Output</div>Query OK, 0 rows affected (0.02 sec)
</code></pre>
<p>To add ten test products to the <code>products</code> table run the following SQL statements:</p>
<pre class="code-pre custom_prefix"><code langs=""><ul class="prefixed"><li class="line" prefix="mysql&gt;">Insert into products(product_id, product_name) values ('1', 'WIRELESS MOUSE');
</li><li class="line" prefix="mysql&gt;">Insert into products(product_id, product_name) values ('2', 'BLUETOOTH SPEAKER');
</li><li class="line" prefix="mysql&gt;">Insert into products(product_id, product_name) values ('3', 'GAMING KEYBOARD');
</li><li class="line" prefix="mysql&gt;">Insert into products(product_id, product_name) values ('4', '320GB FAST SSD');
</li><li class="line" prefix="mysql&gt;">Insert into products(product_id, product_name) values ('5', '17 INCHES TFT');
</li><li class="line" prefix="mysql&gt;">Insert into products(product_id, product_name) values ('6', 'SPECIAL HEADPHONES');
</li><li class="line" prefix="mysql&gt;">Insert into products(product_id, product_name) values ('7', 'HD GRAPHIC CARD');
</li><li class="line" prefix="mysql&gt;">Insert into products(product_id, product_name) values ('8', '80MM THERMAL PRINTER');
</li><li class="line" prefix="mysql&gt;">Insert into products(product_id, product_name) values ('9', 'HDMI TO VGA CONVERTER');
</li><li class="line" prefix="mysql&gt;">Insert into products(product_id, product_name) values ('10', 'FINGERPRINT SCANNER');
</li></ul></code></pre>
<p>You&rsquo;ll see this output:</p>
<pre class="code-pre "><code langs=""><div class="secondary-code-label " title="Output">Output</div>Query OK, 1 row affected (0.02 sec)
</code></pre>
<p>Verify that the products were inserted to the table by running:</p>
<pre class="code-pre custom_prefix"><code langs=""><ul class="prefixed"><li class="line" prefix="mysql&gt;">select * from products;
</li></ul></code></pre>
<p>You&rsquo;ll see the products in your output within the two columns:</p>
<pre class="code-pre "><code langs=""><div class="secondary-code-label " title="Output">Output</div>+------------+-----------------------+
| product_id | product_name          |
+------------+-----------------------+
|          1 | WIRELESS MOUSE        |
|          2 | BLUETOOTH SPEAKER     |
|          3 | GAMING KEYBOARD       |
|          4 | 320GB FAST SSD        |
|          5 | 17 INCHES TFT         |
|          6 | SPECIAL HEADPHONES    |
|          7 | HD GRAPHIC CARD       |
|          8 | 80MM THERMAL PRINTER  |
|          9 | HDMI TO VGA CONVERTER |
|         10 | FINGERPRINT SCANNER   |
+------------+-----------------------+
10 rows in set (0.00 sec)
</code></pre>
<p>Exit MySQL:</p>
<pre class="code-pre custom_prefix"><code langs=""><ul class="prefixed"><li class="line" prefix="mysql&gt;">quit;
</li></ul></code></pre>
<p>With the sample database, table, and test data in place, you can now create a PHP script to display data on a web page.</p>

<h2 id="step-2-—-displaying-mysql-records-without-pagination">Step 2 — Displaying MySQL Records Without Pagination</h2>

<p>Now you&rsquo;ll create a PHP script that connects to the MySQL database that you created in the previous step and list the products in a web browser. In this step, your PHP code will run without any form of pagination to demonstrate how non-split records show on a single page. Although you only have ten records for testing purposes in this tutorial, seeing the records without pagination will demonstrate why segmenting data will ultimately create a better user experience and put less burden on the server.</p>

<p>Create the PHP script file in the document root of your website with the following command:</p>
<pre class="code-pre command"><code langs=""><ul class="prefixed"><li class="line" prefix="$">sudo nano /var/www/html/pagination_test.php
</li></ul></code></pre>
<p>Then add the following content to the file. Remember to replace <code><span class="highlight">PASSWORD</span></code> with the correct value of the password that you assigned to the <code><span class="highlight">test_user</span></code> in the previous step:</p>
<div class="code-label " title="/var/www/html/pagination_test.php">/var/www/html/pagination_test.php</div><pre class="code-pre "><code class="code-highlight language-php">&lt;?php

try {

    $pdo = new PDO("mysql:host=localhost;dbname=test_db", "test_user", "<span class="highlight">PASSWORD</span>");
    $pdo-&gt;setAttribute(PDO::ATTR_ERRMODE, PDO::ERRMODE_EXCEPTION);
    $pdo-&gt;setAttribute(PDO::ATTR_EMULATE_PREPARES,false);

    $sql="select * from products";

    $stmt = $pdo-&gt;prepare($sql);

    $stmt-&gt;execute();

    echo "&lt;table border='1' align='center'&gt;";

    while ( ($row = $stmt-&gt;fetch(PDO::FETCH_ASSOC) ) !== false) {
        echo "&lt;tr&gt;";

        echo "&lt;td&gt;".$row['product_id']."&lt;/td&gt;";

        echo "&lt;td&gt;".$row['product_name']."&lt;/td&gt;";

        echo "&lt;/tr&gt;";

    }

    echo "&lt;/table&gt;";

}

  catch(PDOException $e)

{
    echo  $e-&gt;getMessage();
}

?&gt;
</code></pre>
<p>Save the file by pressing <code>CTRL+X</code>, <code>Y</code>, and <code>ENTER</code>.</p>

<p>In this script you&rsquo;re connecting to the MySQL database using the <a href="https://www.php.net/manual/en/book.pdo.php">PDO (PHP Data Object)</a> library with the database credentials that you created in Step 1.</p>

<p>PDO is a light-weight interface for connecting to databases. The data access layer is more portable and can work on different databases with just minor code rewrites. PDO has greater security since it supports <a href="https://www.php.net/manual/en/pdo.prepared-statements.php"><em>prepared statements</em></a>—a feature for making queries run faster in a secure way.</p>

<p>Then, you instruct the PDO API to execute the <code>select * from products</code> statement and list products in an HTML table without pagination. The line <code>$pdo-&gt;setAttribute(PDO::ATTR_EMULATE_PREPARES,false);</code> ensures that the data types are returned as they appear in the database. This means that PDO will return the <code>product_id</code> as an integer and the <code>product_name</code> as a string. <code>$pdo-&gt;setAttribute(PDO::ATTR_ERRMODE, PDO::ERRMODE_EXCEPTION);</code> instructs PDO to throw an exception if an error is encountered. For easier debugging you&rsquo;re catching the error inside the PHP <code>try{}...catch{}</code> block.</p>

<p>To execute the <code>/var/www/html/pagination_test.php</code> PHP script file that you&rsquo;ve created, visit the following URL replacing <code><span class="highlight">your-server-IP</span></code> with the public IP address of your server:</p>
<pre class="code-pre "><code langs="">http://<span class="highlight">your-server-IP</span>/pagination_test.php
</code></pre>
<p>You&rsquo;ll see a page with a table of your products.</p>

<p><img src="https://assets.digitalocean.com/articles/mysql_pagination1804/step2a.png" alt="MySQL Records Displayed with a PHP script - No Pagination"></p>

<p>Your PHP script is working as expected; listing all products on one page. If you had thousands of products, this would result in a long loop as the products are fetched from the database and rendered on the PHP page.</p>

<p>To overcome this limitation, you will modify the PHP script and include the MySQL <code>LIMIT</code> clause and some navigation links at the bottom of the table to add pagination functionality.</p>

<h2 id="step-3-—-implementing-pagination-with-php">Step 3 — Implementing Pagination with PHP</h2>

<p>In this step your goal is to split the test data into multiple and manageable pages. This will not only enhance readability but also use the resources of the server more efficiently. You will modify the PHP script that you created in the previous step to accommodate pagination.</p>

<p>To do this, you&rsquo;ll be implementing the MySQL <code>LIMIT</code> clause. Before adding this to the script, let&rsquo;s see an example of the MySQL <code>LIMIT</code> syntax:</p>
<pre class="code-pre custom_prefix"><code langs=""><ul class="prefixed"><li class="line" prefix="mysql&gt;">Select <span class="highlight">[column1, column2, column n...]</span> from <span class="highlight">[table name]</span> LIMIT <span class="highlight">offset</span>, <span class="highlight">records</span>;
</li></ul></code></pre>
<p>The <code>LIMIT</code> clause takes two arguments as shown toward the end of this statement. The <code>offset</code> value is the number of records to skip before the first row. <code>records</code> sets the maximum number of records to display per page.</p>

<p>To test pagination, you&rsquo;ll display three records per page. To get the total number of pages, you must divide the total records from your table with the rows that you want to display per page. You then round the resulting value to the nearest integer using PHP <code>Ceil</code> function as shown in the following PHP code snippet example:</p>
<pre class="code-pre "><code class="code-highlight language-php">$total_pages=ceil($total_records/$per_page);
</code></pre>
<p>Following is the modified version of the PHP script with the full pagination code. To include the pagination and navigation codes, open the <code>/var/www/html/pagination_test.php</code> file:</p>
<pre class="code-pre command"><code langs=""><ul class="prefixed"><li class="line" prefix="$">sudo nano /var/www/html/pagination_test.php
</li></ul></code></pre>
<p>Then, add the following highlighted code to your file:</p>
<div class="code-label " title="/var/www/html/pagination_test.php">/var/www/html/pagination_test.php</div><pre class="code-pre "><code langs="">&lt;?php

try {

    $pdo = new PDO("mysql:host=localhost;dbname=test_db", "test_user", "PASSWORD");
    $pdo-&gt;setAttribute(PDO::ATTR_ERRMODE, PDO::ERRMODE_EXCEPTION);
    $pdo-&gt;setAttribute(PDO::ATTR_EMULATE_PREPARES,false);

    <span class="highlight">/* Begin Paging Info */</span>

    <span class="highlight">$page=1;</span>

    <span class="highlight">if (isset($_GET['page'])) {</span>
        <span class="highlight">$page=filter_var($_GET['page'], FILTER_SANITIZE_NUMBER_INT);</span>
    <span class="highlight">}</span>

    <span class="highlight">$per_page=3;</span>

    <span class="highlight">$sqlcount="select count(*) as total_records from products";</span>
    <span class="highlight">$stmt = $pdo-&gt;prepare($sqlcount);</span>
    <span class="highlight">$stmt-&gt;execute();</span>
    <span class="highlight">$row = $stmt-&gt;fetch();</span>
    <span class="highlight">$total_records= $row['total_records'];</span>

    <span class="highlight">$total_pages=ceil($total_records/$per_page);</span>

    <span class="highlight">$offset=($page-1)*$per_page;</span>

    <span class="highlight">/* End Paging Info */</span>

    $sql="select * from products limit <span class="highlight">$offset,$per_page</span>";

    $stmt = $pdo-&gt;prepare($sql);

    $stmt-&gt;execute();


    echo "&lt;table border='1' align='center'&gt;";

    while ( ($row = $stmt-&gt;fetch(PDO::FETCH_ASSOC) ) !== false) {
        echo "&lt;tr&gt;";

        echo "&lt;td&gt;".$row['product_id']."&lt;/td&gt;";

        echo "&lt;td&gt;".$row['product_name']."&lt;/td&gt;";

        echo "&lt;/tr&gt;";

    }

    echo "&lt;/table&gt;";

    <span class="highlight">/* Begin Navigation */</span>

    <span class="highlight">echo "&lt;table border='1' align='center'&gt;";</span>

    <span class="highlight">echo "&lt;tr&gt;";</span>

    <span class="highlight">if( $page-1&gt;=1) {</span>
        <span class="highlight">echo "&lt;td&gt;&lt;a href=".$_SERVER['PHP_SELF']."?page=".($page-1)."&gt;Previous&lt;/a&gt;&lt;/td&gt;";</span>
    <span class="highlight">}</span>

    <span class="highlight">if( $page+1&lt;=$total_pages) {</span>
        <span class="highlight">echo "&lt;td&gt;&lt;a href=".$_SERVER['PHP_SELF']."?page=".($page+1)."&gt;Next&lt;/a&gt;&lt;/td&gt;";</span>
    <span class="highlight">}</span>

    <span class="highlight">echo "&lt;/tr&gt;";</span>

    <span class="highlight">echo "&lt;/table&gt;";</span>

    <span class="highlight">/* End Navigation */</span>

}

catch(PDOException $e) {
        echo  $e-&gt;getMessage();
}

?&gt;
</code></pre>
<p>In your file you&rsquo;ve used additional parameters to execute paging:</p>

<ul>
<li><code>$page</code> : This variable holds the current page in your script. When moving between the pages, your script retrieves a URL parameter named <code>page</code> using the <code>$_GET['page']</code> variable.</li>
<li><code>$per_page</code>: This variable holds the maximum records that you want to be displayed per page. In your case, you want to list three products on each page.</li>
<li><code>$total_records</code>: Before you list the products, you&rsquo;re executing a SQL statement to get a total count of records in your target table and assigning it to the <code>$total_records</code> variable.</li>
<li><code>$offset</code>: This variable represents the total records to skip before the first row. This value is calculated dynamically by your PHP script using the formula <code>$offset=($page-1)*$per_page</code>. You may adapt this formula to your PHP pagination projects. Remember you can change the <code>$per_page</code> variable to suit your needs. For instance, you might change it to a value of <code>50</code> to display fifty items per page if you&rsquo;re running a website or another amount for a mobile device.</li>
</ul>

<p>Again, visit your IP address in a browser and replace <code><span class="highlight">your_server_ip</span></code> with the public IP address of your server:</p>
<pre class="code-pre "><code langs="">http://<span class="highlight">your_server_ip</span>/pagination_test.php
</code></pre>
<p>You&rsquo;ll now see some navigation buttons at the bottom of the page. On the first page, you will not get a <strong>Previous</strong> button. The same case happens on the last page where you will not get the <strong>Next</strong> page button. Also, note how the <code>page</code> URL parameter changes as you visit each page.</p>

<p><img src="https://assets.digitalocean.com/articles/mysql_pagination1804/step3a.png" alt="MySQL Records Displayed with a PHP script with Pagination - Page 1"></p>

<p><img src="https://assets.digitalocean.com/articles/mysql_pagination1804/step3b.png" alt="MySQL Records Displayed with a PHP script with Pagination - Page 2"></p>

<p><img src="https://assets.digitalocean.com/articles/mysql_pagination1804/step3c.png" alt="Final page of MySQL Records Displayed with a PHP script with Pagination - Page 4"></p>

<p>The navigation links at the bottom of the page are achieved using the following PHP code snippet from your file:</p>
<div class="code-label " title="/var/www/html/pagination_test.php">/var/www/html/pagination_test.php</div><pre class="code-pre "><code class="code-highlight language-php">. . .
    if( $page-1&gt;=1) {
        echo "&lt;td&gt;&lt;a href=".$_SERVER['PHP_SELF']."?page=".($page-1)."&gt;Previous&lt;/a&gt;&lt;/td&gt;";
    }

    if( $page+1&lt;=$total_pages) {
        echo "&lt;td&gt;&lt;a href=".$_SERVER['PHP_SELF']."?page=".($page+1)."&gt;Next&lt;/a&gt;&lt;/td&gt;";
    }
. . .
</code></pre>
<p>Here, the <code>$page</code> variable represents the current page number. Then, to get the previous page, the code will minus <code>1</code> from the variable. So, if you&rsquo;re on page 2, the formula <code>(2-1)</code> will give you a result of <code>1</code> and this will be the previous page to appear in the link. However, keep in mind that it will only show the previous page if there is a result greater or equal to <code>1</code>.</p>

<p>Similarly, to get to the next page, you add one to the <code>$page</code> variable and you must also make sure that the <code>$page</code> result that we append to the <code>page</code> URL parameter is not greater than the total pages that you&rsquo;ve calculated in your PHP code.</p>

<p>At this point, your PHP script is working with pagination and you are able to implement the MySQL <code>LIMIT</code> clause for better record navigation.</p>

<h2 id="conclusion">Conclusion</h2>

<p>In this tutorial, you implemented paging in MySQL with PHP on an Ubuntu 18.04 server. You can use these steps with a larger recordset using the PHP script to include pagination. By using pagination on your website or application you can create better user navigation and optimum resource utilization on your server.</p>

<p>From here you could consider further optimization for your database and other database tasks with these tutorials:</p>

<ul>
<li><a href="https://www.digitalocean.com/community/tutorials/how-to-optimize-mysql-with-query-cache-on-ubuntu-18-04">How To Optimize MySQL with Query Cache on Ubuntu 18.04</a></li>
<li><a href="https://www.digitalocean.com/community/tutorials/introduction-to-queries-mysql">An Introduction to Queries in MySQL</a></li>
<li><a href="https://www.digitalocean.com/community/tutorial_series/how-to-troubleshoot-issues-in-mysql">How to Troubleshoot Issues in MySQL</a></li>
</ul>
