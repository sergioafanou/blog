---
layout: post
title: How To Connect to a Managed Database on Ubuntu 18.04
network: digitalocean
date: August 26, 2019 at 10:39PM
url: https://www.digitalocean.com/community/tutorials/how-to-connect-to-managed-database-ubuntu-18-04
image: https://assets.digitalocean.com/articles/pma_managed_db/dpkg_mysql_apt_config_alt2.png
tags: docker
feedtitle: DigitalOcean Community Tutorials
feedurl: https://www.digitalocean.com/community/tutorials
author: DigitalOcean
---
<h3 id="introduction">Introduction</h3>

<p><a href="https://www.digitalocean.com/community/tutorials/understanding-managed-databases">Managed databases</a> have a number of benefits over self-managed databases, including automated updates, simplified scaling, and high availability. If you&rsquo;re new to working with managed databases, though, the best way to perform certain tasks — like connecting to the database — may not be self-evident.</p>

<p>In this guide, we will go over how to install client programs for a variety of database management systems (DBMSs), including <a href="https://www.postgresql.org/">PostgreSQL</a>, <a href="https://www.mysql.com/">MySQL</a>, and <a href="https://redis.io/">Redis</a>, on an Ubuntu 18.04 server. We&rsquo;ll also explain how to use these programs to connect to a managed database instance.</p>

<p><span class='note'><strong>Note:</strong> The instructions outlined in this guide were tested with <a href="https://www.digitalocean.com/products/managed-databases/">DigitalOcean Managed Databases</a>, but they should generally work for managed databases from any cloud provider. If, however, you run into issues connecting to a database provisioned from another provider, you should consult their documentation for help.<br></span></p>

<h2 id="prerequisites">Prerequisites</h2>

<p>To follow the instructions detailed in this guide, you will need:</p>

<ul>
<li>Access to a server running Ubuntu 18.04. This server should have a non-root user with administrative privileges and a firewall configured with <code>ufw</code>. To set this up, follow our <a href="https://www.digitalocean.com/community/tutorials/initial-server-setup-with-ubuntu-18-04">Initial Server Setup Guide for Ubuntu 18.04</a>.</li>
<li>A managed database instance. This tutorial provides instructions on how to connect to a variety of database management systems, specifically PostgreSQL, MySQL, and Redis. To provision a DigitalOcean Managed Database, review our documentation for the DBMS of your choice:

<ul>
<li><a href="https://www.digitalocean.com/docs/databases/postgresql/how-to/create/">PostgreSQL</a></li>
<li><a href="https://www.digitalocean.com/docs/databases/mysql/how-to/create/">MySQL</a></li>
<li><a href="https://www.digitalocean.com/docs/databases/redis/how-to/create/">Redis</a></li>
</ul></li>
</ul>

<p>Once you have these in place, jump to whichever section aligns with your DBMS.</p>

<h2 id="connecting-to-a-managed-postgresql-database">Connecting to a Managed PostgreSQL Database</h2>

<p>To connect to a managed PostgreSQL database, you can use <code>psql</code>, the standard command line client for Postgres. It&rsquo;s open-source, maintained by the PostgreSQL Development Group, and is usually included when you download the PostgreSQL server. However, you can install <code>psql</code> by itself by installing the <code>postgresql-client</code> package with APT.</p>

<p>If you&rsquo;ve not done so recently, update your server&rsquo;s package index:</p>
<pre class="code-pre command"><code langs=""><ul class="prefixed"><li class="line" prefix="$">sudo apt update
</li></ul></code></pre>
<p>Then run the following command to install <code>psql</code>:</p>
<pre class="code-pre command"><code langs=""><ul class="prefixed"><li class="line" prefix="$">sudo apt install postgresql-client
</li></ul></code></pre>
<p>APT will ask you to confirm that you want to install the package. Do so by pressing <code>ENTER</code>. </p>

<p>Following that, you can connect to your managed Postgres database without any need for further configuration. For example, you might invoke <code>psql</code> with the following flags:</p>

<ul>
<li><code>-U</code>, the PostgreSQL user you want to connect as</li>
<li><code>-h</code>, the managed database&rsquo;s hostname or IP address</li>
<li><code>-p</code>, the TCP port on which the managed database is listening for connections</li>
<li><code>-d</code>, the specific database you want to connect to</li>
<li><code>-v</code>, short for &ldquo;variable,&rdquo; precedes other connection variables, followed by an equal sign (<code>=</code>) and the variables&rsquo; values. For example, if you want to validate the database&rsquo;s CA certificate when you connect, you would include <code>-v sslmode=require</code> in your command</li>
<li><code>-W</code>, which tells <code>psql</code> to prompt you for the PostgreSQL user&rsquo;s password. Note that you could precede the <code>psql</code> command with <code>PGPASSWORD=<span class="highlight">password</span></code>, but it&rsquo;s generally considered more secure to not include passwords on the command line</li>
</ul>

<p>With these flags included, the <code>psql</code> command&rsquo;s syntax would look like this:</p>
<pre class="code-pre command"><code langs=""><ul class="prefixed"><li class="line" prefix="$">psql -U <span class="highlight">user</span> -h <span class="highlight">host</span> -p <span class="highlight">port</span> -d <span class="highlight">database</span> -v <span class="highlight">variable</span>=<span class="highlight">value</span> -W
</li></ul></code></pre>
<p>Alternatively, if your managed database provider offers a <a href="https://en.wikipedia.org/wiki/Uniform_Resource_Identifier">uniform resource identifer</a> (URI) for connecting, you might use the following syntax:</p>
<pre class="code-pre command"><code langs=""><ul class="prefixed"><li class="line" prefix="$">psql postgresql://<span class="highlight">username</span>:<span class="highlight">password</span>@<span class="highlight">host</span>:<span class="highlight">port</span>/<span class="highlight">database</span>?<span class="highlight">option_1</span>=<span class="highlight">value</span>&amp;<span class="highlight">option_n</span>=<span class="highlight">value</span>
</li></ul></code></pre>
<span class='note'><p>
<strong>Note:</strong> If you&rsquo;re connecting to a DigitalOcean Managed Database, you can find all of this connection information in your <strong>Cloud Control Panel</strong>. Click on <strong>Databases</strong> in the left-hand sidebar menu, then click on the database you want to connect to and scroll down to find its <strong>Connection Details</strong> section. From there, you do one of the following:</p>

<ul>
<li>Select the <strong>Connection parameters</strong> option and copy the relevant fields individually into the <code>psql</code> syntax detailed previously</li>
<li>Select the <strong>Connection String</strong> option and copy a ready-made connection URI you can paste into the connection URI syntax outlined above</li>
<li>Select the <strong>Flags</strong> option and copy a ready-to-use <code>psql</code> command that you can paste into your terminal to make the connection</li>
</ul>

<p></p></span>

<p>With that, you&rsquo;re ready to begin using with your managed PostgreSQL instance. For more information on how to interact with PostgreSQL, see our guide on <a href="https://www.digitalocean.com/community/tutorials/how-to-manage-sql-database-cheat-sheet">How to Manage an SQL Database</a>. You may also find our <a href="https://www.digitalocean.com/community/tutorials/introduction-to-queries-postgresql">Introduction to Queries in PostgreSQL</a> useful.</p>

<h2 id="connecting-to-a-managed-mysql-database">Connecting to a Managed MySQL Database</h2>

<p>To connect to a managed MySQL database, you can use the official MySQL database client. On Ubuntu, this client is typically installed by downloading the <code>mysql-client</code> package through APT. If you&rsquo;re using the default Ubuntu repositories, though, this will install version 5.7 of the program. </p>

<p>In order to access a DigitalOcean Managed MySQL database, you will need to install version 8.0 or above. To do so, you must first add the MySQL software repository before installing the package.</p>

<span class='note'><p>
<strong>Note:</strong> If you don&rsquo;t need to install the latest version of <code>mysql-client</code>, you can just update your server&rsquo;s package index and install <code>mysql-client</code> without adding the MySQL software repository:</p>
<pre class="code-pre command"><code langs=""><ul class="prefixed"><li class="line" prefix="$">sudo apt update
</li><li class="line" prefix="$">sudo apt install mysql-client
</li></ul></code></pre>
<p>If you aren&rsquo;t sure whether you need the latest version of <code>mysql-client</code>, you should consult your cloud provider&rsquo;s managed databases documentation.<br></p></span>

<p>Begin by navigating to <a href="https://dev.mysql.com/downloads/repo/apt/">the <strong>MySQL APT Repository</strong> page</a> in your web browser. Find the <strong>Download</strong> button in the lower-right corner and click through to the next page. This page will prompt you to log in or sign up for an Oracle web account. You can skip that and instead look for the link that says <strong>No thanks, just start my download</strong>. Right-click the link and select <strong>Copy Link Address</strong> (this option may be worded differently, depending on your browser).</p>

<p>Now you&rsquo;re ready to download the file. On your server, move to a directory you can write to:</p>
<pre class="code-pre command"><code langs=""><ul class="prefixed"><li class="line" prefix="$">cd /tmp
</li></ul></code></pre>
<p>Download the file using <code>curl</code>, remembering to paste the address you just copied in place of the highlighted portion of the following command. You also need to pass two command line flags to <code>curl</code>. <code>-O</code> instructs <code>curl</code> to output to a file instead of standard output. The <code>L</code> flag makes <code>curl</code> follow HTTP redirects, which is necessary in this case because the address you copied actually redirects to another location before the file downloads:</p>
<pre class="code-pre command"><code langs=""><ul class="prefixed"><li class="line" prefix="$">curl -OL <span class="highlight">https://dev.mysql.com/get/mysql-apt-config_0.8.13-1_all.deb</span>
</li></ul></code></pre>
<p>The file should now be downloaded in your current directory. List the files to make sure:</p>
<pre class="code-pre command"><code langs=""><ul class="prefixed"><li class="line" prefix="$">ls
</li></ul></code></pre>
<p>You will see the filename listed in the output:</p>
<pre class="code-pre "><code langs=""><div class="secondary-code-label " title="Output">Output</div>mysql-apt-config_<span class="highlight">0.8.13-1</span>_all.deb
. . .
</code></pre>
<p>Now you can add the MySQL APT repository to your system&rsquo;s repository list. The <code>dpkg</code> command is used to install, remove, and inspect <code>.deb</code> software packages. The following command includes the <code>-i</code> flag, indicating that you&rsquo;d like to install from the specified file:</p>
<pre class="code-pre command"><code langs=""><ul class="prefixed"><li class="line" prefix="$">sudo dpkg -i mysql-apt-config*
</li></ul></code></pre>
<p>During the installation, you&rsquo;ll be presented with a configuration screen where you can specify which version of MySQL you&rsquo;d prefer, along with an option to install repositories for other MySQL-related tools. The defaults will add the repository information for the latest stable version of MySQL and nothing else. This is what we want, so use the down arrow to navigate to the <code>Ok</code> menu option and hit <code>ENTER</code>.</p>

<p><img src="https://assets.digitalocean.com/articles/pma_managed_db/dpkg_mysql_apt_config_alt2.png" alt="Selecting mysql-apt-config configuration options"></p>

<p>Following that, the package will finish adding the repository. Refresh your <code>apt</code> package cache to make the new software packages available:</p>
<pre class="code-pre command"><code langs=""><ul class="prefixed"><li class="line" prefix="$">sudo apt update
</li></ul></code></pre>
<p>Next, you can clean up your system a bit and delete the file you downloaded, as you won&rsquo;t need it in the future:</p>
<pre class="code-pre command"><code langs=""><ul class="prefixed"><li class="line" prefix="$">rm mysql-apt-config*
</li></ul></code></pre>
<span class='note'><p>
<strong>Note:</strong> If you ever need to update the configuration of these repositories, run the following command to select your new options:</p>
<pre class="code-pre command"><code langs=""><ul class="prefixed"><li class="line" prefix="$">sudo dpkg-reconfigure mysql-apt-config
</li></ul></code></pre>
<p>After selecting your new options, run the following command to refresh your package cache:</p>
<pre class="code-pre command"><code langs=""><ul class="prefixed"><li class="line" prefix="$">sudo apt update
</li></ul></code></pre>
<p></p></span>

<p>Now that you&rsquo;ve added the MySQL repositories, you&rsquo;re ready to install the actual MySQL client software. Do so with the following <code>apt</code> command:</p>
<pre class="code-pre command"><code langs=""><ul class="prefixed"><li class="line" prefix="$">sudo apt install mysql-client
</li></ul></code></pre>
<p>Once that command finishes, check the software version number to ensure that you have the latest release:</p>
<pre class="code-pre command"><code langs=""><ul class="prefixed"><li class="line" prefix="$">mysql --version
</li></ul></code></pre><pre class="code-pre "><code langs=""><div class="secondary-code-label " title="Output">Output</div>mysql  Ver <span class="highlight">8.0.17</span>-cluster for Linux on x86_64 (MySQL Community Server - GPL)
</code></pre>
<p>After you&rsquo;ve installed the <code>mysql-client</code> package, you can access your managed database by running the <code>mysql</code> command with the following flags as arguments:</p>

<ul>
<li><code>-u</code>, the MySQL user you want to connect as</li>
<li><code>-p</code>, tells <code>mysql</code> to prompt for the user&rsquo;s password. You could include your password directly in the connection command following the <code>-p</code> flag (without a space, as in <code>-p<span class="highlight">password</span></code>) but, for security reasons, this is generally not recommended</li>
<li><code>-h</code>, the database&rsquo;s hostname or IP address</li>
<li><code>-P</code>, the TCP port on which MySQL is listening for connections</li>
<li><code>-D</code>, the specific database you want to connect to</li>
</ul>

<p>Using these flags, the <code>mysql</code> syntax will look like this:</p>
<pre class="code-pre command"><code langs=""><ul class="prefixed"><li class="line" prefix="$">mysql -u <span class="highlight">user</span> -p -h <span class="highlight">host</span> -P <span class="highlight">port</span> -D <span class="highlight">database</span>
</li></ul></code></pre>
<p>Alternatively, if you have a connection URI you can use to connect, you would use a syntax like this:</p>
<pre class="code-pre command"><code langs=""><ul class="prefixed"><li class="line" prefix="$">mysql mysql://<span class="highlight">user</span>:<span class="highlight">password</span>@<span class="highlight">host</span>:<span class="highlight">port</span>/<span class="highlight">database</span>?<span class="highlight">option_1</span>=<span class="highlight">value</span>&amp;<span class="highlight">option_n</span>=<span class="highlight">value</span>
</li></ul></code></pre>
<span class='note'><p>
<strong>Note:</strong> If you&rsquo;re connecting to a DigitalOcean Managed Database, you can find all of this connection information in your <strong>Cloud Control Panel</strong>. Click on <strong>Databases</strong> in the left-hand sidebar menu, then click on the database you want to connect to and scroll down to find its <strong>Connection Details</strong> section. From there, you do one of the following:</p>

<ul>
<li>Select the <strong>Connection parameters</strong> option and copy the relevant fields individually into the <code>mysql</code> syntax outlined previously</li>
<li>Select the <strong>Connection String</strong> option and copy a ready-made connection URI you can paste into the connection string detailed above</li>
<li>Select the <strong>Flags</strong> option and copy a ready-to-use <code>mysql</code> command that you can paste into your terminal to make the connection</li>
</ul>

<p></p></span>

<p>With that, you&rsquo;re ready to begin using with your managed MySQL instance. For more information on how to interact with MySQL, see our guide on <a href="https://www.digitalocean.com/community/tutorials/how-to-manage-sql-database-cheat-sheet">How to Manage an SQL Database</a>. You may also find our <a href="https://www.digitalocean.com/community/tutorials/introduction-to-queries-mysql">Introduction to Queries in MySQL</a> useful.</p>

<h3 id="a-note-regarding-password-authentication-in-mysql-8">A Note Regarding Password Authentication in MySQL 8</h3>

<p>In MySQL 8.0 and newer, the default authentication plugin is <code>caching_sha2_password</code>. As of this writing, though, PHP does not support <code>caching_sha2_password</code>. If you plan on using your managed MySQL database with an application that uses PHP, such as WordPress or phpMyAdmin, this may lead to issues when the application attempts to connect to the database.</p>

<p>If you have access to the database&rsquo;s configuration file, you could add a setting to force it to use a PHP-supported authentication plugin — for example, <code>mysql_native_password</code> — by default:</p>
<div class="code-label " title="Example MySQL Configuration File">Example MySQL Configuration File</div><pre class="code-pre "><code langs="">[mysqld]
default-authentication-plugin=<span class="highlight">mysql_native_password</span>
</code></pre>
<p>However, some managed database providers — including DigitalOcean — do not make the database configuration file available to end users. In this case, you could connect to the database and run an <code>ALTER USER</code> command for any existing MySQL users which need to connect to the database, but can&rsquo;t do so with the <code>caching_sha2_password</code> plugin:</p>
<pre class="code-pre custom_prefix"><code langs=""><ul class="prefixed"><li class="line" prefix="mysql&gt;">ALTER USER <span class="highlight">user</span> IDENTIFIED WITH mysql_native_password BY '<span class="highlight">password</span>';
</li></ul></code></pre>
<p>Of course, you can set new users to authenticate with <code>mysql_native_password</code> by specifying the plugin in their respective <code>CREATE USER</code> statements:</p>
<pre class="code-pre custom_prefix"><code langs=""><ul class="prefixed"><li class="line" prefix="mysql&gt;">CREATE USER <span class="highlight">user</span> IDENTIFIED WITH mysql_native_password BY '<span class="highlight">password</span>';
</li></ul></code></pre>
<p>If you&rsquo;re using a DigitalOcean Managed Database, be aware that if you configure a user to authenticate with a plugin other than <code>caching_sha2_password</code> then you won&rsquo;t be able to see that user&rsquo;s password in your Cloud Control Panel. For this reason, you should make sure you note down the passwords of any users that authenticate with <code>mysql_native_password</code> or other plugins in a secure location.</p>

<h2 id="connecting-to-a-managed-redis-database">Connecting to a Managed Redis Database</h2>

<p>When you install Redis locally, it comes with <code>redis-cli</code>, the Redis command line interface. You can use <code>redis-cli</code> to connect to a remote, managed Redis instance, but it doesn&rsquo;t natively support TLS/SSL connections. For that reason, it&rsquo;s recommended that you use an alternative Redis client to enable secure connections to Redis. </p>

<p>For DigitalOcean Managed Redis Databases, we recommend that you install Redli, an open-source, interactive Redis terminal. To do so, navigate to the <a href="https://github.com/IBM-Cloud/redli/releases"><strong>Releases Page</strong></a> on the Redli GitHub project and locate the <strong>Assets</strong> table for the latest release. As of this writing, this will be version 0.4.4. </p>

<p>There, find the link for the file ending in <code>linux_amd64.tar.gz</code>.  This link points to an archive file known as a <em>tarball</em> that, when extracted, will create a few files on your system. Right-click this link and select <strong>Copy link address</strong> (this option may differ depending on your web browser). </p>

<p>On your server, move to a directory you can write to:</p>
<pre class="code-pre command"><code langs=""><ul class="prefixed"><li class="line" prefix="$">cd /tmp
</li></ul></code></pre>
<p>Then, paste the link into the following <code>wget</code> command, replacing the highlighted URL. This command will download the file to your server:</p>
<pre class="code-pre command"><code langs=""><ul class="prefixed"><li class="line" prefix="$">wget <span class="highlight">https://github.com/IBM-Cloud/redli/releases/download/v0.4.4/redli_0.4.4_linux_amd64.tar.gz</span>
</li></ul></code></pre>
<p>Once the file has been downloaded to your server, extract the tarball:</p>
<pre class="code-pre command"><code langs=""><ul class="prefixed"><li class="line" prefix="$">tar xvf redli_<span class="highlight">0.4.4</span>_linux_amd64.tar.gz
</li></ul></code></pre>
<p>This will create the following files on your server:</p>
<pre class="code-pre "><code langs=""><div class="secondary-code-label " title="Output">Output</div>LICENSE.txt
README.md
redli
</code></pre>
<p>The <code>redli</code> file is the Redli <a href="https://en.wikipedia.org/wiki/Binary_file"><em>binary file</em></a>. Move it to the <code>/usr/local/bin</code> directory, the location where Ubuntu looks for executable files:</p>
<pre class="code-pre comand"><code langs="">sudo mv redli /usr/local/bin/
</code></pre>
<p>At this point, you can clean up your system a bit and remove the tarball:</p>
<pre class="code-pre command"><code langs=""><ul class="prefixed"><li class="line" prefix="$">rm redli <span class="highlight">0.4.4</span>_linux_amd64.tar.gz
</li></ul></code></pre>
<p>Now you can use Redli to connect to your managed Redis instance. You could do so by running the <code>redli</code> command followed by these flags:</p>

<ul>
<li><code>-h</code>, the host to connect to. This can either be a hostname or an IP address</li>
<li><code>-a</code>, the password used to authenticate to the Redis instance</li>
<li><code>-p</code>, the port to connect to</li>
</ul>

<p>With these flags included, the <code>redli</code> syntax would be as follows. Note that this example also includes the <code>--tls</code> option, which allows you to connect to a managed Redis database over TLS/SSL without the need for a tunnel:</p>
<pre class="code-pre command"><code langs=""><ul class="prefixed"><li class="line" prefix="$">redli --tls -h <span class="highlight">host</span> -a <span class="highlight">password</span> -p <span class="highlight">port</span>
</li></ul></code></pre>
<p>One benefit that Redli has over <code>redis-cli</code> is that it understands the <code>rediss</code> protocol, which is used to designate a URI pointing to a Redis database. This allows you to use a connection string to access your database:</p>
<pre class="code-pre command"><code langs=""><ul class="prefixed"><li class="line" prefix="$">redli --tls -u rediss://<span class="highlight">user</span>:<span class="highlight">password</span>@<span class="highlight">host</span>:<span class="highlight">port</span>
</li></ul></code></pre>
<p>Note that this example includes the <code>-u</code> flag, which specifies that the following argument will be a connection URI.</p>

<span class='note'><p>
<strong>Note:</strong> If you&rsquo;re connecting to a DigitalOcean Managed Database, you can find all of this connection information in your <strong>Cloud Control Panel</strong>. Click on <strong>Databases</strong> in the left-hand sidebar menu, then click on the database you want to connect to and scroll down to find the <strong>Connection Details</strong> section. From there, you do one of the following:</p>

<ul>
<li>Select the <strong>Connection parameters</strong> option and copy the relevant fields individually into the <code>redli</code> syntax detailed previously</li>
<li>Select the <strong>Connection String</strong> option and copy a ready-made connection URI that you can use with the connection string syntax outlined above</li>
<li>Select the <strong>Flags</strong> option and copy a ready-to-use <code>redli</code> command that you can paste into your terminal to make the connection</li>
</ul>

<p></p></span>

<p>Following that, you can begin interacting with your managed Redis instance.</p>

<h2 id="conclusion">Conclusion</h2>

<p>As a relatively new development in cloud services, many practices that are well known for self-managed databases aren&rsquo;t widely or comprehensively documented for databases managed by cloud providers. One of the most fundamental of these practices, accessing the database, may not be immediately clear to those new to working with managed databases. Our goal for this tutorial is that it helps get you started as you begin using a managed database for storing data.</p>

<p>For more information on working with databases, we encourage you to check out our variety of <a href="https://www.digitalocean.com/community/tags/databases?type=tutorials">database-related content</a>, including tutorials focused directly on <a href="https://www.digitalocean.com/community/tags/postgresql?type=tutorials">PostgreSQL</a>, <a href="https://www.digitalocean.com/community/tags/mysql?type=tutorials">MySQL</a>, and <a href="https://www.digitalocean.com/community/tags/redis?type=tutorials">Redis</a>.</p>

<p>To learn more about DigitalOcean Managed Databases, please see our <a href="https://www.digitalocean.com/docs/databases/">Managed Databases product documentation</a>.</p>
