---
layout: post
title: Настройка Jupyter Notebook с помощью Python 3 в Ubuntu 18.04
network: digitalocean
date: January 24, 2020 at 04:35AM
url: https://www.digitalocean.com/community/tutorials/how-to-set-up-jupyter-notebook-with-python-3-on-ubuntu-18-04-ru
image: https://assets.digitalocean.com/articles/jupyter_notebook/set_hostname_putty.png
tags: docker
feedtitle: DigitalOcean Community Tutorials
feedurl: https://www.digitalocean.com/community/tutorials
author: DigitalOcean
---
<h3 id="Введение">Введение</h3>

<p>Веб-приложение с открытым исходным кодом, <a href="http://jupyter.org/">Jupyter Notebook</a>, позволяет создавать и обмениваться интерактивными кодом, визуализациями и многим другим. Этот инструмент можно использовать с несколькими языками программирования, включая Python, Julia, R, Haskell и Ruby. Он часто используется для работы с данными, статистическими моделями и машинным обучением.</p>

<p>Из этого обучающего руководства вы узнаете, как выполнить настройку Jupyter Notebook для запуска на сервере с Ubuntu 18.04, а также научитесь подключаться к блокноту и использовать его. Блокноты Jupyter (или просто блокноты) — это документы, генерируемые приложением Jupyter Notebook, которые содержат компьютерный код и форматированные текстовые элементы (параграф, цитаты, изображения, ссылки и т.д.), которые помогают отображать и делиться воспроизводимые разработки.</p>

<p>К концу этого руководства вы сможете запускать код Python 3 с помощью Jupyter Notebook, запущенном на удаленном сервере.</p>

<h2 id="Предварительные-требования">Предварительные требования</h2>

<p>Для прохождения этого обучающего модуля вам потребуется новый экземпляр сервера Ubuntu 18.04 с базовым брандмауэром и пользователем с привилегиями sudo и без привилегий root. Чтобы узнать, как настроить такой сервер, воспользуйтесь нашим <a href="https://www.digitalocean.com/community/tutorials/initial-server-setup-with-ubuntu-18-04">руководством по начальной настройке сервера</a>.</p>

<h2 id="Шаг-1-—-Настройка-python">Шаг 1 — Настройка Python</h2>

<p>Для начала процесса настройки мы установим зависимости, которые нам потребуется для нашей среды программирования Python, из репозиториев Ubuntu. В Ubuntu 18.04 уже предустановлена версия Python 3.6. Для установки дополнительных компонентов мы немного позднее используем диспетчер пакетов Python pip.</p>

<p>Сначала нам нужно обновить локальный индекс пакетов <code>apt</code>, а затем загрузить и установить пакеты:</p>
<pre class="code-pre command"><code langs=""><ul class="prefixed"><li class="line" prefix="$">sudo apt update
</li></ul></code></pre>
<p>Затем установите pip и заголовочные файлы Python, которые используются определенными зависимостями Jupyter:</p>
<pre class="code-pre command"><code langs=""><ul class="prefixed"><li class="line" prefix="$">sudo apt install python3-pip python3-dev
</li></ul></code></pre>
<p>Теперь мы можем перейти к настройке виртуальной среды Python, куда мы будем устанавливать Jupyter.</p>

<h2 id="Шаг-2-—-Создание-виртуальной-среды-python-для-jupyter">Шаг 2 — Создание виртуальной среды Python для Jupyter</h2>

<p>Теперь, когда у нас есть Python 3, а заголовочные файлы и pip готовы к запуску, мы можем создать виртуальную среду Python для управления нашими проектами. Мы установим Jupyter в эту виртуальную среду.</p>

<p>Для этого нам потребуется доступ к <code>virtualenv</code>, который мы можем установить с помощью pip.</p>

<p>Обновите pip и установите пакет с помощью следующей команды:</p>
<pre class="code-pre command"><code langs=""><ul class="prefixed"><li class="line" prefix="$">sudo -H pip3 install --upgrade pip
</li><li class="line" prefix="$">sudo -H pip3 install virtualenv
</li></ul></code></pre>
<p>Флаг <code>-H</code> гарантирует, что политика безопасности устанавливает переменную среды <code>home</code> в домашнюю директорию пользователя.</p>

<p>После установки <code>virtualenv</code> мы можем начать формирование нашей среды. Создайте каталог для файлов нашего проекта и перейдите в этот каталог. Мы назовем ее <code>my_project_dir</code>, но вы должны использовать имя, которое понятно вам и согласуется с тем, над чем вы работаете.</p>
<pre class="code-pre command"><code langs=""><ul class="prefixed"><li class="line" prefix="$">mkdir ~/<span class="highlight">my_project_dir</span>
</li><li class="line" prefix="$">cd ~/<span class="highlight">my_project_dir</span>
</li></ul></code></pre>
<p>В директории проекта мы создадим виртуальную среду Python. Для целей данного руководства мы назовем ее <code>my_project_env</code>, но вы должны использовать название, соответствующее вашему проекту.</p>
<pre class="code-pre command"><code langs=""><ul class="prefixed"><li class="line" prefix="$">virtualenv <span class="highlight">my_project_env</span>
</li></ul></code></pre>
<p>Эта команда создаст каталог <code><span class="highlight">my_project_env</span></code> в каталоге <code><span class="highlight">my_project_dir</span></code>. В этот каталог будут установлены локальная версия Python и локальная версия pip. Мы можем использовать ее для установки и настройки изолированной среды Python для Jupyter.</p>

<p>Перед созданием Jupyter нам потребуется активировать виртуальную среду. Для этого можно использовать следующую команду:</p>
<pre class="code-pre command"><code langs=""><ul class="prefixed"><li class="line" prefix="$">source <span class="highlight">my_project_env</span>/bin/activate
</li></ul></code></pre>
<p>Командная строка изменится, показывая, что теперь вы работаете в виртуальной среде Python. Она будет выглядеть примерно так: <code>(<span class="highlight">my_project_env</span>)<span class="highlight">user</span>@<span class="highlight">host</span>:~/<span class="highlight">my_project_dir</span>$</code>.</p>

<p>Теперь вы можете выполнить установку Jupyter в эту виртуальную среду.</p>

<h2 id="Шаг-3-—-Установка-jupyter">Шаг 3 — Установка Jupyter</h2>

<p>При запущенной виртуальной среде установите Jupyter с помощью локального экземпляра pip.</p>

<p><span class='note'><strong>Примечание:</strong> если виртуальная среда активна (когда перед командной строкой стоит (<code>my_project_env</code>)), необходимо использовать <code>pip</code> вместо <code>pip3</code>, даже если вы используете Python 3. Копия инструмента в виртуальной среде всегда имеет имя <code>pip</code> вне зависимости от версии Python.<br></span></p>
<pre class="code-pre command"><code langs=""><ul class="prefixed"><li class="line" prefix="$">pip install jupyter
</li></ul></code></pre>
<p>В данный момент вы успешно установили все программное обеспечение, необходимое для запуска Jupyter. Теперь мы можем запустить сервер Notebook.</p>

<h2 id="Шаг-4-—-Запуск-jupyter-notebook">Шаг 4 — Запуск Jupyter Notebook</h2>

<p>Теперь у вас есть все, что нужно для запуска Jupyter Notebook! Для его запуска воспользуйтесь следующей командой:</p>
<pre class="code-pre custom_prefix"><code langs=""><ul class="prefixed"><li class="line" prefix="(my_project_env)sammy@your_server:~/my_project_dir$">jupyter notebook
</li></ul></code></pre>
<p>Журнал активности Jupyter Notebook будет выведен в командной строке. При запуске Jupyter Notebook  будет использоваться порт с конкретным номером. Первый Notebook, который вы будете запускать, обычно использует порт <code><span class="highlight">8888</span></code>. Чтобы проверить, какой номер порта использует Jupyter, см. вывод команды, которую вы использовали для запуска:</p>
<pre class="code-pre "><code langs=""><div class="secondary-code-label " title="Output">Output</div>[I 21:23:21.198 NotebookApp] Writing notebook server cookie secret to /run/user/1001/jupyter/notebook_cookie_secret
[I 21:23:21.361 NotebookApp] Serving notebooks from local directory: /home/<span class="highlight">sammy</span>/<span class="highlight">my_project_dir</span>
[I 21:23:21.361 NotebookApp] The Jupyter Notebook is running at:
[I 21:23:21.361 NotebookApp] http://localhost:<span class="highlight">8888</span>/?token=<span class="highlight">1fefa6ab49a498a3f37c959404f7baf16b9a2eda3eaa6d72</span>
[I 21:23:21.361 NotebookApp] Use Control-C to stop this server and shut down all kernels (twice to skip confirmation).
[W 21:23:21.361 NotebookApp] No web browser found: could not locate runnable browser.
[C 21:23:21.361 NotebookApp]

    Copy/paste this URL into your browser when you connect for the first time,
    to login with a token:
        http://localhost:<span class="highlight">8888</span>/?token=<span class="highlight">1fefa6ab49a498a3f37c959404f7baf16b9a2eda3eaa6d72</span>
</code></pre>
<p>Если вы запускаете Jupyter Notebook на локальном компьютере (а не на сервере), вы можете перейти к отображаемому URL-адресу для подключения к Jupyter Notebook. Если вы запускаете Jupyter Notebook на сервере, вам нужно будет подключаться к серверу с помощью туннеля SSH, как указано в следующем разделе.</p>

<p>В данный момент вы можете сохранить соединение SSH открытым и поддерживать Jupyter Notebook в рабочем состоянии, или закрыть приложение и снова запустить его после настройки туннеля SSH. Давайте завершим процесс Jupyter Notebook. Мы запустим его снова после настройки туннеля SSH. Чтобы остановить процесс Jupyter Notebook, нажмите <code>CTRL+C</code>, введите <code>Y</code>, а затем <code>ENTER</code> для подтверждения. В результате будет отображен следующий вывод:</p>
<pre class="code-pre "><code langs=""><div class="secondary-code-label " title="Output">Output</div>[C 21:28:28.512 NotebookApp] Shutdown confirmed
[I 21:28:28.512 NotebookApp] Shutting down 0 kernels
</code></pre>
<p>Теперь мы настроим туннель SSH, чтобы получить доступ к Notebook.</p>

<h2 id="Шаг-5-—-Подключение-к-серверу-с-помощью-туннеля-ssh">Шаг 5 — Подключение к серверу с помощью туннеля SSH</h2>

<p>В этом разделе мы узнаем, как подключиться к веб-интерфейсу Jupyter Notebook с помощью туннеля SSH. Поскольку Jupyter Notebook будет работать на конкретном порту на сервере (например, <code>:8888</code>, <code>:8889</code> и т. д.), туннель SSH позволяет безопасно подключаться к порту сервера.</p>

<p>В следующих двух подразделах описано, как создать туннель SSH в (1) Mac или Linux и в (2) Windows. См. подраздел для вашего локального компьютера.</p>

<h3 id="Туннель-ssh-в-mac-или-linux">Туннель SSH в Mac или Linux</h3>

<p>Если вы используете Mac или Linux, шаги, которые необходимо выполнить для создания туннеля SSH, аналогичны шагам, которые выполняются при входе на удаленный сервер с помощью SSH, за исключением дополнительных параметров в команде <code>ssh</code>. В этом подразделе будут показаны дополнительные параметры, необходимые команде <code>ssh</code> для успешного создания туннеля.</p>

<p>Создание туннелей SSH может быть осуществлено с помощью следующей команды SSH, которую необходимо ввести в новом окне локальной командной строки:</p>
<pre class="code-pre command local-environment"><code langs=""><ul class="prefixed"><li class="line" prefix="$">ssh -L <span class="highlight">8888</span>:localhost:<span class="highlight">8888</span> <span class="highlight">your_server_username</span>@<span class="highlight">your_server_ip</span>
</li></ul></code></pre>
<p>Команда <code>ssh</code> открывает соединение SSH, но <code>-L</code> указывает, что данный порт на локальном хосте (клиент) будет отправляться на заданный хост и порт на удаленном конце (сервер). Это значит, что бы ни было запущено на втором порту (например, <code><span class="highlight">8888</span></code>) на сервере, оно появится на первом порту (например, <code><span class="highlight">8888</span></code>) на локальном компьютере.</p>

<p>Вы можете изменить порт <code><span class="highlight">8888</span></code> на один из ваших портов, чтобы избежать использования порта, который уже используется другим процессом.</p>

<p><code><span class="highlight">server_username</span></code> — это ваше имя пользователя (например, <span class="highlight">sammy</span>) на сервере, который вы создали, а <code><span class="highlight">your_server_ip</span></code> — это IP-адрес вашего сервера.</p>

<p>Например, для имени пользователя <code><span class="highlight">sammy</span></code> и адреса сервера <code><span class="highlight">203.0.113.0</span></code>, команда будет выглядеть следующим образом:</p>
<pre class="code-pre command local-environment"><code langs=""><ul class="prefixed"><li class="line" prefix="$">ssh -L <span class="highlight">8888</span>:localhost:<span class="highlight">8888</span> <span class="highlight">sammy</span>@<span class="highlight">203.0.113.0</span>
</li></ul></code></pre>
<p>Если после запуска команды <code>ssh -L</code> не появится ошибок, вы можете перейти в среду программирования и запустить Jupyter Notebook:</p>
<pre class="code-pre custom_prefix"><code langs=""><ul class="prefixed"><li class="line" prefix="(my_project_env)sammy@your_server:~/my_project_dir$">jupyter notebook
</li></ul></code></pre>
<p>Вы получите вывод с URL-адресом. В веб-браузере на локальном компьютере откройте веб-интерфейс Jupyter Notebook с URL-адресом, который начинается с <code>http://localhost:8888</code>. Убедитесь, что номер маркера включен, либо введите строку с номером маркера при запросе в <code>http://localhost:8888</code>.</p>

<h3 id="Создание-туннелей-ssh-с-использованием-windows-и-putty">Создание туннелей SSH с использованием Windows и PuTTY</h3>

<p>Если вы используете Windows, вы можете создать туннель SSH с помощью <a href="https://www.putty.org/">Putty</a>.</p>

<p>Введите URL-адрес сервера или IP-адрес в качестве имени хоста, как показано ниже:</p>

<p><img src="https://assets.digitalocean.com/articles/jupyter_notebook/set_hostname_putty.png" alt="Задайте имя хоста для туннеля SSH"></p>

<p>Далее нажмите <strong>SSH</strong> в нижней части левой панели, чтобы расширить меню, а затем нажмите <strong>Tunnels</strong> (Туннели). Введите локальный номер порта, который вы хотите использовать для доступа к Jupyter на локальном компьютере. Выберите <code><span class="highlight">8000</span></code> или выше, чтобы избежать использования портов, которые уже используются другими службами, и задайте назначение localhost: <code><span class="highlight">8888</span></code>, где <code><span class="highlight">:8888</span></code> — номер порта, на котором запущен Jupyter Notebook.</p>

<p>Затем нажмите кнопку <strong>Add</strong> (Добавить), после чего порты должны появиться в списке <strong>Forwarded ports</strong> (Перенаправляемые порты):</p>

<p><img src="https://assets.digitalocean.com/articles/jupyter_notebook/forwarded_ports_putty.png" alt="Список перенаправляемых портов"></p>

<p>После этого нажмите кнопку <strong>Open</strong> (Открыть) для подключения к серверу через SSH и туннель с нужными портами. Перейдите на <code>http://localhost:<span class="highlight">8000</span></code> (или любой порт на выбор) в веб-браузере для подключения к Jupyter Notebook, запущенному на сервере. Убедитесь, что номер маркера включен, либо введите строку с номером маркера при запросе в <code>http://localhost:8000</code>.</p>

<h2 id="Шаг-6-—-Использование-jupyter-notebook">Шаг 6 — Использование Jupyter Notebook</h2>

<p>В этом разделе рассматриваются базовые принципы использования Jupyter Notebook. Если у вас нет запущенного Jupyter Notebook, запустите его с помощью команды <code>jupyter notebook</code>.</p>

<p>Теперь вы должны быть подключены к нему с помощью браузера. Jupyter Notebook — это очень мощный инструмент с множеством функций. В этом разделе будет описан ряд базовых функций, необходимых для начала использования Notebook. Jupyter Notebook будет отображать все файлы и папки в директории, в которой он запущен, поэтому, если вы работаете над проектом, убедитесь, что вы можете запустить его из директории проекта.</p>

<p>Чтобы создать новый файл Notebook, выберите <strong>New</strong> (Новый) &gt; <strong>Python 3</strong> в выпадающем меню в верхнем правом углу:</p>

<p><img src="https://assets.digitalocean.com/articles/eng_python/JupyterNotebookPy3/jupyter-notebook-new.png" alt="Создайте новый блокнот Python 3"></p>

<p>В результате откроется Notebook. Теперь мы можем запустить код Python в ячейке или изменить ячейку на разметку. Например, измените первую ячейку, чтобы она могла принимать разметку, нажмите <strong>Cell</strong> (Ячейка) &gt; <strong>Cell Type</strong> (Тип ячейки) &gt; <strong>Markdown</strong> (Разметка) в верхней панели навигации. Теперь мы можем добавлять записи с помощью разметки и даже включать уравнения, созданные в  <a href="https://www.latex-project.org/">LaTeX</a>, поместив их между символами <code>$$</code>. Например, введите в ячейку следующее после ее переключения на разметку:</p>
<pre class="code-pre "><code langs=""># First Equation

Let us now implement the following equation:
$$ y = x^2$$

where $x = 2$
</code></pre>
<p>Чтобы преобразовать разметку в расширенный текстовый формат, нажмите <code>CTRL + ENTER</code>, и получите следующий результат:</p>

<p><img src="https://assets.digitalocean.com/articles/jupyter_notebook/jupyter_markdown.png" alt="результат разметки"></p>

<p>Вы можете использовать ячейки разметки для заметок и документирования программного кода. Давайте реализуем это уравнение и распечатаем результат. Нажмите на верхнюю ячейку, а затем нажмите <code>ALT+ENTER</code> чтобы добавить ячейку ниже. Введите в новую ячейку следующий код.</p>
<pre class="code-pre "><code class="code-highlight language-python">x = 2
y = x**2
print(y)
</code></pre>
<p>Для запуска кода нажмите <code>CTRL+ENTER</code>. Вы получите следующие результаты:</p>

<p><img src="https://assets.digitalocean.com/articles/jupyter_notebook/jupyter_python.png" alt="результаты первого уравнения"></p>

<p>Теперь вы можете <a href="https://www.digitalocean.com/community/tutorials/how-to-import-modules-in-python-3">импортировать модули</a> и использовать Notebook, как и любую другую среду разработки Python!</p>

<h2 id="Заключение">Заключение</h2>

<p>Поздравляем! Теперь вы можете писать воспроизводимый код Python и записи в Markdown с помощью Jupyter Notebook. Для быстрого ознакомления с интерфейсом Jupyter Notebook выберите <strong>Help</strong> (Справка) &gt; <strong>User Interface Tour</strong> (Знакомство с пользовательским интерфейсом) в верхнем меню навигации.</p>

<p>Здесь вы можете запустить проект анализа данных и визуализации, ознакомившись со статьей <a href="https://www.digitalocean.com/community/tutorials/data-analysis-and-visualization-with-pandas-and-jupyter-notebook-in-python-3">Анализ данных и визуализация с pandas и Jupyter Notebook в Python 3</a>.</p>

<p>Если вы хотите узнать больше, ознакомьтесь с нашей серией статей <a href="https://www.digitalocean.com/community/tutorial_series/time-series-visualization-and-forecasting">Визуализация временных рядов и прогнозирование</a>.</p>
