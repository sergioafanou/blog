---
layout: post
title: How To Deploy a Go Web Application Using Nginx on Ubuntu 18.04
network: digitalocean
date: July 23, 2019 at 09:40PM
url: https://www.digitalocean.com/community/tutorials/how-to-deploy-a-go-web-application-using-nginx-on-ubuntu-18-04
image: https://assets.digitalocean.com/articles/66224/Hello_World.png
tags: docker
feedtitle: DigitalOcean Community Tutorials
feedurl: https://www.digitalocean.com/community/tutorials
author: DigitalOcean
---
<p><em>The author selected the <a href="https://www.brightfunds.org/funds/tech-education">Tech Education Fund</a> to receive a donation as part of the <a href="https://do.co/w4do-cta">Write for DOnations</a> program.</em></p>

<h3 id="introduction">Introduction</h3>

<p><a href="https://golang.org/">Go</a> is a general-purpose programming language that is gradually becoming one of the most popular web back-end programming languages. By focusing on simplicity, the designers of Go created a language that is both easy to learn and faster than many other languages for web applications, leveraging efficient features like its ability to handle multiple requests at a time due to its concurrency. Because of this, deploying a web application in Go will be useful to many back-end developers.</p>

<p><a href="https://www.nginx.com/">Nginx</a> is one of the most popular web servers in the world due to its lightweight resource usage and its reliability under load. Many of the largest and most highly trafficked sites on the internet depend on Nginx to serve their content. In deployment, Nginx is often used as a load balancer or a reverse proxy to increase security and make the application more robust. In conjunction with a Go web back-end, Nginx can serve up a powerful and fast web application. </p>

<p>In this tutorial, you will build a <code>Hello World</code> web application in Go and deploy it on an Ubuntu 18.04 server using Nginx as a reverse proxy.</p>

<h2 id="prerequisites">Prerequisites</h2>

<p>To follow this tutorial, you will need the following:</p>

<ul>
<li>One Ubuntu 18.04 server set up by following this <a href="https://www.digitalocean.com/community/tutorials/initial-server-setup-with-ubuntu-18-04">initial server setup for Ubuntu 18.04 tutorial</a>, including a sudo non-root user and a firewall.</li>
<li>The <a href="https://www.digitalocean.com/community/tutorial_series/how-to-code-in-go">Go</a> programming language installed by following <a href="https://www.digitalocean.com/community/tutorials/how-to-install-go-and-set-up-a-local-programming-environment-on-ubuntu-18-04">How To Install Go and Set Up a Local Programming Environment on Ubuntu 18.04</a>.</li>
<li><a href="https://www.nginx.com/">Nginx</a> installed by following <a href="https://www.digitalocean.com/community/tutorials/how-to-install-nginx-on-ubuntu-18-04">How To Install Nginx on Ubuntu 18.04</a>. Do not follow <a href="https://www.digitalocean.com/community/tutorials/how-to-install-nginx-on-ubuntu-18-04#step-5-%E2%80%93-setting-up-server-blocks-(recommended)"><strong>Step 5 – Setting Up Server Blocks</strong></a>; you will create an Nginx server block later on in this tutorial.</li>
<li>A domain name pointed at your server, as described in <a href="https://www.digitalocean.com/community/tutorials/how-to-set-up-a-host-name-with-digitalocean">How To Set Up a Host Name with DigitalOcean</a>. This tutorial will use <code><span class="highlight">your_domain</span></code> throughout. This is necessary to obtain an SSL certificate for your website, so you can securely serve your application with TLS encryption.</li>
</ul>

<p>Additionally, in order to achieve a production-grade deployment of your Go web application, it's important that you keep your server secure by installing a TLS/SSL certificate. This step is <strong>strongly encouraged</strong>. To secure your Go web application, follow <a href="https://www.digitalocean.com/community/tutorials/how-to-secure-nginx-with-let-s-encrypt-on-ubuntu-18-04">How To Secure Nginx with Let's Encrypt on Ubuntu 18.04</a> after <strong>Step 3</strong> of this tutorial to obtain the free TLS/SSL certificate.</p>

<h2 id="step-1-—-building-the-go-web-application">Step 1 — Building the Go Web Application</h2>

<p>In this step, you will build a sample Go web application that displays <code>Hello World</code> at <code><span class="highlight">your_domain</span></code> and greets the user at <code><span class="highlight">your_domain</span>/greet/</code>. If you would like to learn more about the basics of programming in Go, check out our <a href="https://www.digitalocean.com/community/tutorials/how-to-write-your-first-program-in-go">How To Write Your First Program in Go</a> article.</p>

<p>First, create a new directory in your <a href="https://www.digitalocean.com/community/tutorials/understanding-the-gopath"><code>GOPATH</code></a> directory to hold the source file. You can name the folder whatever you like, but this tutorial will use <code><span class="highlight">go-web</span></code>:</p>
<pre class="code-pre command"><code langs=""><ul class="prefixed"><li class="line" prefix="$">mkdir $GOPATH/<span class="highlight">go-web</span>
</li></ul></code></pre>
<p>Following the file structure suggested in the prerequisite tutorial <a href="https://www.digitalocean.com/community/tutorials/how-to-install-go-and-set-up-a-local-programming-environment-on-ubuntu-18-04">How To Install Go and Set Up a Local Programming Environment on Ubuntu 18.04</a>, this will give your directory the path of <code>~/go/go-web</code>.</p>

<p>Next, run the following to change directory to your newly created folder in your <code>GOPATH</code>:</p>
<pre class="code-pre command"><code langs=""><ul class="prefixed"><li class="line" prefix="$">cd $GOPATH/go-web
</li></ul></code></pre>
<p>Use <code>nano</code> or your preferred text editor to create a file named <code>main.go</code>, which will contain the source code for your web application:</p>
<pre class="code-pre command"><code langs=""><ul class="prefixed"><li class="line" prefix="$">nano main.go
</li></ul></code></pre>
<p>To create the functionality of the <code>Hello World</code> application, add the following Go code into the newly created <code>main.go</code> file:</p>
<div class="code-label " title="~/go/go-web/main.go">~/go/go-web/main.go</div><pre class="code-pre "><code class="code-highlight language-go">package main

import (
    "fmt"
    "net/http"
)

func main() {
    http.HandleFunc("/", func(w http.ResponseWriter, r *http.Request) {
        fmt.Fprintf(w, "Hello World")
    })

    http.HandleFunc("/greet/", func(w http.ResponseWriter, r *http.Request) {
        name := r.URL.Path[len("/greet/"):]
        fmt.Fprintf(w, "Hello %s\n", name)
    })

    http.ListenAndServe(":9990", nil)
}
</code></pre>
<p>Now let's go through what the preceding code snippet will do, starting from the first line.</p>

<p>First, you wrote the entry point into your application:</p>
<div class="code-label " title="~/go/go-web/main.go">~/go/go-web/main.go</div><pre class="code-pre "><code class="code-highlight language-go">package main
...
</code></pre>
<p>The <code>package main</code> tells the Go compiler to compile this file as an executable program instead of as a shared library.</p>

<p>Next, you have the <code>import</code> statements:</p>
<div class="code-label " title="~/go/go-web/main.go">~/go/go-web/main.go</div><pre class="code-pre "><code class="code-highlight language-go">...

import (
    "fmt"
    "net/http"
)
...
</code></pre>
<p>This snippet imports the necessary modules required for this code to work, which include the standard <code>fmt</code> package and the <code>net/http</code> package for your web server.</p>

<p>The next snippet creates your first route in the <code>main</code> function, which is the entry point of any Go application:</p>
<div class="code-label " title="~/go/go-web/main.go">~/go/go-web/main.go</div><pre class="code-pre "><code class="code-highlight language-go">...
func main () {
    http.HandleFunc("/", func(w http.ResponseWriter, r *http.Request) {
        fmt.Fprintf(w, "Hello World")
    })
  ...
}
...
</code></pre>
<p>A parent route <code>/</code> is created within <code>func main</code>, which will return the text <code>Hello World</code> when requested.</p>

<p>The second route as shown in the following snippet accepts a URL parameter, in this case a name, to display accompanied by a greeting.</p>
<div class="code-label " title="~/go/go-web/main.go">~/go/go-web/main.go</div><pre class="code-pre "><code class="code-highlight language-go">...
func main () {
  ...
    http.HandleFunc("/greet/", func(w http.ResponseWriter, r *http.Request) {
        name := r.URL.Path[len("/greet/"):]
        fmt.Fprintf(w, "Hello %s\n", name)
    })
...
}
...
</code></pre>
<p>This uses Go's <code>URL.Path</code> to store the value right after <code>/greet/</code> and pass it down as the name from the URL parameter.</p>

<p>Finally, you instantiate your server:</p>
<div class="code-label " title="~/go/go-web/main.go">~/go/go-web/main.go</div><pre class="code-pre "><code class="code-highlight language-go">...
func main () {
  ...
  http.ListenAndServe(":9990", nil)
}
</code></pre>
<p>The preceding snippet starts the server and exposes your application via port <code>9990</code> using Go's inbuilt <code>http</code> server.</p>

<p>Once you are finished examining the code in <code>main.go</code>, save the file and quit your text editor.</p>

<p>Next, build the binary executable of your application by running:</p>
<pre class="code-pre command"><code langs=""><ul class="prefixed"><li class="line" prefix="$">go build main.go
</li></ul></code></pre>
<p>The preceding command will compile <code>main.go</code> to produce an executable titled <code>main</code>.</p>

<p>You have created your sample Go web application. Next, you will create a systemd unit file to keep your application running in the background even when you are not accessing your server.</p>

<h2 id="step-2-—-creating-a-systemd-unit-file">Step 2 — Creating a Systemd Unit File</h2>

<p>In this step, you will create a <a href="https://www.digitalocean.com/community/tutorials/understanding-systemd-units-and-unit-files">systemd</a> unit file to keep your application running in the background even when a user logs out of the server. This will make your application persistent, bringing you one step closer to a production-grade deployment.</p>

<p>First, create a new file in <code>/lib/systemd/system</code> directory named <code>goweb.service</code> using <code>nano</code> or you preferred text editor:</p>
<pre class="code-pre command"><code langs=""><ul class="prefixed"><li class="line" prefix="$">sudo nano /lib/systemd/system/goweb.service
</li></ul></code></pre>
<p>To set the parameters of the service, add the following snippet into the file.</p>
<div class="code-label " title="/lib/systemd/system/goweb.service">/lib/systemd/system/goweb.service</div><pre class="code-pre text"><code langs="">[Unit]
Description=goweb

[Service]
Type=simple
Restart=always
RestartSec=5s
ExecStart=/home/<span class="highlight">user</span>/go/go-web/main

[Install]
WantedBy=multi-user.target
</code></pre>
<p>The <code>ExecStart=/home/<span class="highlight">user</span>/go/go-web/main</code> variable specifies that the point of entry for this service is through the <code>main</code> executable located in the <code>/home/<span class="highlight">user</span>/go/go-web</code> directory, where <code><span class="highlight">user</span></code> is the server non-root sudo account username. <code>Restart=always</code> ensures that systemd will always try to restart the program if it stops. On the next line, <code>RestartSec=5s</code> sets a five-second wait time between restart attempts. <code>WantedBy=multi-user.target</code> specifies in what state your server will enable the service.</p>

<p>Save and exit the file.</p>

<p>Now that you've written the service unit file, start your Go web service by running:</p>
<pre class="code-pre command"><code langs=""><ul class="prefixed"><li class="line" prefix="$">sudo service goweb start
</li></ul></code></pre>
<p>To confirm if the service is running, use the following command:</p>
<pre class="code-pre command"><code langs=""><ul class="prefixed"><li class="line" prefix="$">sudo service goweb status
</li></ul></code></pre>
<p>You'll receive the following output:</p>
<pre class="code-pre text"><code langs=""><div class="secondary-code-label " title="Output">Output</div>● goweb.service - goweb
   Loaded: loaded (/lib/systemd/system/goweb.service; disabled; vendor preset: enabled)
   Active: active (running) since Wed 2019-07-17 23:28:57 UTC; 6s ago
 Main PID: 1891 (main)
    Tasks: 4 (limit: 1152)
   CGroup: /system.slice/goweb.service
           └─1891 /home/<span class="highlight">user</span>/go/go-web/main
</code></pre>
<p>To learn more about working with systemd unit file, take a look at <a href="https://www.digitalocean.com/community/tutorials/understanding-systemd-units-and-unit-files">Understanding Systemd Units and Unit Files</a>.</p>

<p>Now that you have your application up and running, you can set up the Nginx reverse proxy.</p>

<h2 id="step-3-—-setting-up-a-reverse-proxy-with-nginx">Step 3 — Setting Up a Reverse Proxy with Nginx</h2>

<p>In this step, you will create an Nginx server block and set up an Nginx reverse proxy to expose your application to the internet.</p>

<p>First, change your working directory to the Nginx <code>sites-available</code> directory:</p>
<pre class="code-pre command"><code langs=""><ul class="prefixed"><li class="line" prefix="$">cd /etc/nginx/sites-available
</li></ul></code></pre>
<p>Create a new file with the name of the domain on which you wish to expose your application. This tutorial will use <code><span class="highlight">your_domain</span></code>:</p>
<pre class="code-pre command"><code langs=""><ul class="prefixed"><li class="line" prefix="$">sudo nano <span class="highlight">your_domain</span>
</li></ul></code></pre>
<p>Add the following lines into the file to establish the settings for <code><span class="highlight">your_domain</span></code>:</p>
<div class="code-label " title="/etc/nginx/sites-available/your_domain">/etc/nginx/sites-available/your_domain</div><pre class="code-pre "><code langs="">server {
    server_name <span class="highlight">your_domain</span> <span class="highlight">www.your_domain</span>;

    location / {
        proxy_pass http://localhost:9990;
    }
}
</code></pre>
<p>This Nginx server block uses <a href="http://nginx.org/en/docs/http/ngx_http_proxy_module.html#proxy_pass"><code>proxy_pass</code></a> to serve the Go web application on your server's IP address indicated as <code>localhost</code> to make it run on port <code>9990</code>. <code>server_name</code> indicates the domain name mapped to your IP address, in this case <code><span class="highlight">your_domain</span></code> and <code><span class="highlight">www.your_domain</span></code>.</p>

<p>Next, create a symlink of this Nginx configuration in the <code>sites-enabled</code> folder by running the following command:</p>
<pre class="code-pre command"><code langs=""><ul class="prefixed"><li class="line" prefix="$">sudo ln -s /etc/nginx/sites-available/<span class="highlight">your_domain</span> /etc/nginx/sites-enabled/<span class="highlight">your_domain</span>
</li></ul></code></pre>
<p>A symlink is a shortcut of a file in another location. The newly created shortcut will always reference the original file to adjust to updates when edits are made to it. Nginx requires a copy of the configuration in both directories.</p>

<p>Next, reload your Nginx configurations by running the reload command:</p>
<pre class="code-pre command"><code langs=""><ul class="prefixed"><li class="line" prefix="$">sudo nginx -s reload
</li></ul></code></pre>
<p>To make sure that your deployment is working, visit <code>http://<span class="highlight">your_domain</span></code> in your browser. You will be greeted with a <strong>Hello World</strong> text string.</p>

<p><span class='note'><strong>Note:</strong> As mentioned in the Prerequisites section, at this point it is recommended to enable SSL/TLS on your server. This will make sure that all communication between the application and its visitors will be encrypted, which is especially important if the application asks for sensitive information such as a login or password. Follow <a href="https://www.digitalocean.com/community/tutorials/how-to-secure-nginx-with-let-s-encrypt-on-ubuntu-18-04">How To Secure Nginx with Let's Encrypt on Ubuntu 18.04</a> now to obtain a free SSL certificate for Nginx on Ubuntu 18.04. After obtaining your SSL/TLS certificates, come back and complete this tutorial.<br></span></p>

<p>You have now set up the Nginx reverse proxy to expose your application at your domain name, and secured your Go web application with SSL/TLS. In the next step, you will be testing your application over a secure connection.</p>

<h2 id="step-4-—-testing-the-application">Step 4 — Testing the Application</h2>

<p>In this step, you will test your application over a secure connection to make sure everything is working.</p>

<p>Open your preferred web browser, visit <code>https://<span class="highlight">your_domain</span></code>: </p>

<p><img src="https://assets.digitalocean.com/articles/66224/Hello_World.png" alt="Hello World Page Display"></p>

<p>You will receive a simple <code>Hello World</code> message. Receiving this message when using <code>https://</code> in the URL indicates that your application is being served over a secure connection.</p>

<p>Next, try visiting the second route <code>https://<span class="highlight">your_domain</span>/greet/<span class="highlight">your-name</span></code>, replacing <code><span class="highlight">your-name</span></code> with whichever name you want your app to greet:</p>

<p><img src="https://assets.digitalocean.com/articles/66224/Greet.png" alt="Greeting Page Display"></p>

<p>The application will return a simple greeting along with <code><span class="highlight">your-name</span></code>, which is based on the parameter passed to the URL.</p>

<p>Once you have received these results, you have successfully deployed your Go web application.</p>

<h2 id="conclusion">Conclusion</h2>

<p>In this tutorial, you created a simple web application with Go using its standard libraries, set up a reverse proxy using Nginx, and used a SSL certificate on your domain to secure your app. To learn more about Go, check their <a href="https://golang.org/doc/">official documentation</a>. Also, you can look at our series <a href="https://www.digitalocean.com/community/tutorial_series/how-to-code-in-go">How To Code in Go</a> to learn more about programming in this efficient language.</p>
