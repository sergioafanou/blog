---
layout: post
title: –û—Ç–ø—Ä–∞–≤–∫–∞ push-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –∏–∑ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π Django
network: digitalocean
date: January 24, 2020 at 04:34AM
url: https://www.digitalocean.com/community/tutorials/how-to-send-web-push-notifications-from-django-applications-ru
image: https://assets.digitalocean.com/articles/django_push_18_04/web_push_final.png
tags: docker
feedtitle: DigitalOcean Community Tutorials
feedurl: https://www.digitalocean.com/community/tutorials
author: DigitalOcean
---
<p><em>–ê–≤—Ç–æ—Ä –≤—ã–±—Ä–∞–ª <a href="https://www.brightfunds.org/funds/open-internet-free-speech">—Ñ–æ–Ω–¥ Open Internet/Free Speech</a> –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –ø–æ–∂–µ—Ä—Ç–≤–æ–≤–∞–Ω–∏—è –≤ —Ä–∞–º–∫–∞—Ö –ø—Ä–æ–≥—Ä–∞–º–º—ã <a href="https://do.co/w4do-cta">Write for DOnations</a></em>.</p>

<h3 id="–í–≤–µ–¥–µ–Ω–∏–µ">–í–≤–µ–¥–µ–Ω–∏–µ</h3>

<p>–ò–Ω—Ç–µ—Ä–Ω–µ—Ç –ø–æ—Å—Ç–æ—è–Ω–Ω–æ –º–µ–Ω—è–µ—Ç—Å—è, –∏ —Ç–µ–ø–µ—Ä—å –æ–Ω –º–æ–∂–µ—Ç –ø–æ–ª—É—á–∏—Ç—å —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏, –∫–æ—Ç–æ—Ä—ã–µ —Ä–∞–Ω–µ–µ –±—ã–ª–∏ –¥–æ—Å—Ç—É–ø–Ω—ã —Ç–æ–ª—å–∫–æ –Ω–µ–ø–æ—Å—Ä–µ–¥—Å—Ç–≤–µ–Ω–Ω–æ –Ω–∞ –º–æ–±–∏–ª—å–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞—Ö. –ü–æ—è–≤–ª–µ–Ω–∏–µ –≤ JavaScript –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞ <a href="https://developers.google.com/web/fundamentals/primers/service-workers/">service worker</a> –¥–∞–µ—Ç –≤–µ–±—É —Ç–∞–∫–∏–µ –Ω–æ–≤—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏, –∫–∞–∫ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ —Ñ–æ–Ω–æ–≤–æ–π —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏, –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—Ñ—Ñ–ª–∞–π–Ω –∏ –æ—Ç–ø—Ä–∞–≤–∫–∞ <a href="https://developer.mozilla.org/en/docs/Web/API/Push_API">push-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π</a>.</p>

<p>Push-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –ø–æ–∑–≤–æ–ª—è—é—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º –ø—Ä–∏–Ω–∏–º–∞—Ç—å –Ω–æ–≤–æ—Å—Ç–∏ –æ—Ç –º–æ–±–∏–ª—å–Ω—ã—Ö –∏ –≤–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π. –¢–∞–∫–∂–µ –æ–Ω–∏ –ø–æ–∑–≤–æ–ª—è—é—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—Ç—å –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ —Å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–º–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è–º–∏, –∏—Å–ø–æ–ª—å–∑—É—è –ø–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∏ —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω—ã–π –∫–æ–Ω—Ç–µ–Ω—Ç.</p>

<p>–í —ç—Ç–æ–º –æ–±—É—á–∞—é—â–µ–º —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–µ –≤—ã –Ω–∞—Å—Ç—Ä–æ–∏—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ Django –≤ Ubuntu 18.04, –∫–æ—Ç–æ—Ä–æ–µ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç push-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –≤ —Å–ª—É—á–∞–µ –ª—é–±–æ–π –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏, –∫–æ—Ç–æ—Ä–∞—è —Ç—Ä–µ–±—É–µ—Ç –æ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –ø–æ—Å–µ—â–µ–Ω–∏—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è. –î–ª—è —Å–æ–∑–¥–∞–Ω–∏—è —ç—Ç–∏—Ö —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –≤—ã –±—É–¥–µ—Ç–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø–∞–∫–µ—Ç <a href="https://github.com/safwanrahman/django-webpush">Django-Webpush</a> –∏ –¥–æ–ª–∂–Ω—ã –±—É–¥–µ—Ç–µ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å –∏ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å service worker –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –¥–ª—è –∫–ª–∏–µ–Ω—Ç–∞. –†–∞–±–æ—Ç–∞—é—â–µ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è–º–∏ –±—É–¥–µ—Ç –≤—ã–≥–ª—è–¥–µ—Ç—å —Å–ª–µ–¥—É—é—â–∏–º –æ–±—Ä–∞–∑–æ–º:</p>

<p><img src="https://assets.digitalocean.com/articles/django_push_18_04/web_push_final.png" alt="–ò—Ç–æ–≥–æ–≤—ã–π –≤–∏–¥ push-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è"></p>

<h2 id="–ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—ã–µ-—Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è">–ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è</h2>

<p>–î–ª—è –ø—Ä–æ—Ö–æ–∂–¥–µ–Ω–∏—è —ç—Ç–æ–≥–æ –æ–±—É—á–∞—é—â–µ–≥–æ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–∞ –≤–∞–º –ø–æ—Ç—Ä–µ–±—É–µ—Ç—Å—è —Å–ª–µ–¥—É—é—â–µ–µ:</p>

<ul>
<li>–°–µ—Ä–≤–µ—Ä Ubuntu 18.04 —Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º –±–µ–∑ –ø—Ä–∞–≤ root –∏ –∞–∫—Ç–∏–≤–Ω—ã–º –±—Ä–∞–Ω–¥–º–∞—É—ç—Ä–æ–º. –í—ã –º–æ–∂–µ—Ç–µ –≤–æ—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è —É–∫–∞–∑–∞–Ω–∏—è–º–∏ –∏–∑ <a href="https://www.digitalocean.com/community/tutorials/initial-server-setup-with-ubuntu-18-04">—Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–∞ –ø–æ –Ω–∞—á–∞–ª—å–Ω–æ–π –Ω–∞—Å—Ç—Ä–æ–π–∫–µ —Å–µ—Ä–≤–µ—Ä–∞</a> –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ —Å–æ–∑–¥–∞–Ω–∏–∏ —Å–µ—Ä–≤–µ—Ä–∞ Ubuntu 18.04.</li>
<li><code>pip</code> –∏ <code>venv</code>, —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ –≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–∏ —Å –¥–∞–Ω–Ω—ã–º–∏ <a href="https://www.digitalocean.com/community/tutorials/how-to-install-the-django-web-framework-on-ubuntu-18-04#install-with-pip-in-a-virtual-environment">—É–∫–∞–∑–∞–Ω–∏—è–º–∏</a>.</li>
<li>–ü—Ä–æ–µ–∫—Ç Django —Å –∏–º–µ–Ω–µ–º <code><span class="highlight">djangopush</span></code>, —Å–æ–∑–¥–∞–Ω–Ω—ã–π –≤ –¥–æ–º–∞—à–Ω–µ–π –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ –∏ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π –≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–∏ —Å —É–∫–∞–∑–∞–Ω–∏—è–º–∏ <a href="https://www.digitalocean.com/community/tutorials/how-to-install-the-django-web-framework-on-ubuntu-18-04#creating-a-sample-project">—Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–∞ –ø–æ —Å–æ–∑–¥–∞–Ω–∏—é –ø—Ä–∏–º–µ—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞ Django –≤ Ubuntu 18.04</a>. –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ <a href="https://www.digitalocean.com/community/tutorials/how-to-install-the-django-web-framework-on-ubuntu-18-04#modifying-allowed_hosts-in-the-django-settings">–¥–æ–±–∞–≤—å—Ç–µ IP-–∞–¥—Ä–µ—Å –≤–∞—à–µ–≥–æ —Å–µ—Ä–≤–µ—Ä–∞ –≤ –¥–∏—Ä–µ–∫—Ç–∏–≤—É <code>ALLOWED_HOSTS</code></a> —Ñ–∞–π–ª–∞ <code>settings.py</code>.</li>
</ul>

<h2 id="–®–∞–≥-1-‚Äî-–£—Å—Ç–∞–Ω–æ–≤–∫–∞-django-webpush-–∏-–ø–æ–ª—É—á–µ–Ω–∏–µ-vapid-–∫–ª—é—á–µ–π">–®–∞–≥ 1 ‚Äî –£—Å—Ç–∞–Ω–æ–≤–∫–∞ Django-Webpush –∏ –ø–æ–ª—É—á–µ–Ω–∏–µ VAPID –∫–ª—é—á–µ–π</h2>

<p>Django-Webpush ‚Äî —ç—Ç–æ –ø–∞–∫–µ—Ç, –ø–æ–∑–≤–æ–ª—è—é—â–∏–π —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∞–º –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å –∏ –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å push-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è Django. –ú—ã –±—É–¥–µ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —ç—Ç–æ—Ç –ø–∞–∫–µ—Ç –¥–ª—è –∑–∞–ø—É—Å–∫–∞ –∏ –æ—Ç–ø—Ä–∞–≤–∫–∏ push-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –∏–∑ –Ω–∞—à–µ–≥–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è. –ù–∞ —ç—Ç–æ–º —à–∞–≥–µ –≤—ã —É—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ Django-Webpush –∏ –ø–æ–ª—É—á–∏—Ç–µ –∫–ª—é—á–∏ <em>–¥–æ–±—Ä–æ–≤–æ–ª—å–Ω–æ–π –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ —Å–µ—Ä–≤–µ—Ä–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è (Voluntary Application Server Identification, VAPID)</em>, –∫–æ—Ç–æ—Ä—ã–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã –¥–ª—è –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ –≤–∞—à–µ–≥–æ —Å–µ—Ä–≤–µ—Ä–∞ –∏ –æ–±–µ—Å–ø–µ—á–µ–Ω–∏—è —É–Ω–∏–∫–∞–ª—å–Ω–æ—Å—Ç–∏ –∫–∞–∂–¥–æ–≥–æ –∑–∞–ø—Ä–æ—Å–∞.</p>

<p>–í—ã –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –¥–æ–ª–∂–Ω—ã –Ω–∞—Ö–æ–¥–∏—Ç—å—Å—è –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ –ø—Ä–æ–µ–∫—Ç–∞ <code>~/<span class="highlight">djangopush</span></code>, –∫–æ—Ç–æ—Ä–∞—è –±—ã–ª–∞ —Å–æ–∑–¥–∞–Ω–∞ –Ω–∞ —ç—Ç–∞–ø–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –ø—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—ã—Ö —Ç—Ä–µ–±–æ–≤–∞–Ω–∏–π:</p>
<pre class="code-pre command"><code langs=""><ul class="prefixed"><li class="line" prefix="$">cd ~/<span class="highlight">djangopush</span>
</li></ul></code></pre>
<p>–ê–∫—Ç–∏–≤–∏—Ä—É–π—Ç–µ –≤–∞—à—É –≤–∏—Ä—Ç—É–∞–ª—å–Ω—É—é —Å—Ä–µ–¥—É:</p>
<pre class="code-pre command"><code langs=""><ul class="prefixed"><li class="line" prefix="$">source <span class="highlight">my_env</span>/bin/activate
</li></ul></code></pre>
<p>–û–±–Ω–æ–≤–∏—Ç–µ –≤–µ—Ä—Å–∏—é <code>pip</code> –¥–ª—è –≥–∞—Ä–∞–Ω—Ç–∏–∏ –µ–µ –∞–∫—Ç—É–∞–ª—å–Ω–æ—Å—Ç–∏:</p>
<pre class="code-pre custom_prefix"><code langs=""><ul class="prefixed"><li class="line" prefix="(my_env) $">pip install --upgrade pip
</li></ul></code></pre>
<p>–£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ Django-Webpush:</p>
<pre class="code-pre custom_prefix"><code langs=""><ul class="prefixed"><li class="line" prefix="(my_env) $">pip install django-webpush
</li></ul></code></pre>
<p>–ü–æ—Å–ª–µ —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –ø–∞–∫–µ—Ç–∞ –¥–æ–±–∞–≤—å—Ç–µ –µ–≥–æ –≤ —Å–ø–∏—Å–æ–∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π –≤ —Ñ–∞–π–ª–µ <code>settings.py</code>. –û—Ç–∫—Ä–æ–π—Ç–µ —Ñ–∞–π–ª <code>settings.py</code>:</p>
<pre class="code-pre custom_prefix"><code langs=""><ul class="prefixed"><li class="line" prefix="(my_env) $">nano ~/djangopush/djangopush/settings.py
</li></ul></code></pre>
<p>–î–æ–±–∞–≤—å—Ç–µ <code>webpush</code> –≤ —Å–ø–∏—Å–æ–∫ <code>INSTALLED_APPS</code>:</p>
<div class="code-label " title="~/djangopush/djangopush/settings.py">~/djangopush/djangopush/settings.py</div><pre class="code-pre "><code langs="">...

INSTALLED_APPS = [
    ...<span class="highlight">,</span>
   <span class="highlight"> 'webpush',</span>
]
...
</code></pre>
<p>–°–æ—Ö—Ä–∞–Ω–∏—Ç–µ —Ñ–∞–π–ª –∏ –∑–∞–∫—Ä–æ–π—Ç–µ —Ä–µ–¥–∞–∫—Ç–æ—Ä.</p>

<p>–ó–∞–ø—É—Å—Ç–∏—Ç–µ <a href="https://docs.djangoproject.com/en/2.0/topics/migrations/">–º–∏–≥—Ä–∞—Ü–∏—é</a> –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ –¥–ª—è –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π, –∫–æ—Ç–æ—Ä—ã–µ –≤—ã –≤–Ω–µ—Å–ª–∏ –≤ —Å—Ö–µ–º—É –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö:</p>
<pre class="code-pre custom_prefix"><code langs=""><ul class="prefixed"><li class="line" prefix="(my_env) $">python manage.py migrate
</li></ul></code></pre>
<p>–í—ã–≤–æ–¥ –±—É–¥–µ—Ç –≤—ã–≥–ª—è–¥–µ—Ç—å —Å–ª–µ–¥—É—é—â–∏–º –æ–±—Ä–∞–∑–æ–º –ø—Ä–∏ —É—Å–ª–æ–≤–∏–∏ —É—Å–ø–µ—à–Ω–æ–≥–æ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –º–∏–≥—Ä–∞—Ü–∏–∏:</p>
<pre class="code-pre "><code langs=""><div class="secondary-code-label " title="Output">Output</div>Operations to perform:
  Apply all migrations: admin, auth, contenttypes, sessions, webpush
Running migrations:
  Applying webpush.0001_initial... OK
</code></pre>
<p>–°–ª–µ–¥—É—é—â–∏–π —à–∞–≥ –ø–æ –Ω–∞—Å—Ç—Ä–æ–π–∫–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π ‚Äî –ø–æ–ª—É—á–µ–Ω–∏–µ –∫–ª—é—á–µ–π VAPID. –≠—Ç–∏ –∫–ª—é—á–∏ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –¥–ª—è –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ —Å–µ—Ä–≤–µ—Ä–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –∏ –º–æ–≥—É—Ç –ø—Ä–∏–º–µ–Ω—è—Ç—å—Å—è –¥–ª—è —Å–Ω–∏–∂–µ–Ω–∏—è —Å–µ–∫—Ä–µ—Ç–Ω–æ—Å—Ç–∏ –¥–ª—è URL-–∞–¥—Ä–µ—Å–æ–≤ –ø–æ–¥–ø–∏—Å–∫–∏, –ø–æ—Å–∫–æ–ª—å–∫—É –æ–Ω–∏ –æ–≥—Ä–∞–Ω–∏—á–∏–≤–∞—é—Ç –ø–æ–¥–ø–∏—Å–∫—É –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã–º —Å–µ—Ä–≤–µ—Ä–æ–º.</p>

<p>–ß—Ç–æ–±—ã –ø–æ–ª—É—á–∏—Ç—å –∫–ª—é—á–∏ VAPID, –ø–µ—Ä–µ–π–¥–∏—Ç–µ –∫ –≤–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏—é <a href="https://web-push-codelab.glitch.me/">wep-push-codelab</a>. –ó–¥–µ—Å—å –≤—ã –ø–æ–ª—É—á–∏—Ç–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∫–ª—é—á–∏. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ –∑–∞–∫—Ä—ã—Ç—ã–µ –∏ –æ—Ç–∫—Ä—ã—Ç—ã–µ –∫–ª—é—á–∏.</p>

<p>–î–∞–ª–µ–µ —Å–æ–∑–¥–∞–π—Ç–µ –Ω–æ–≤—É—é –∑–∞–ø–∏—Å—å –≤ —Ñ–∞–π–ª–µ <code>settings.py</code> –¥–ª—è –≤–∞—à–∏—Ö –¥–∞–Ω–Ω—ã—Ö –æ VAPID. –û—Ç–∫—Ä–æ–π—Ç–µ —Ñ–∞–π–ª:</p>
<pre class="code-pre custom_prefix"><code langs=""><ul class="prefixed"><li class="line" prefix="(my_env) $">nano ~/djangopush/djangopush/settings.py
</li></ul></code></pre>
<p>–î–∞–ª–µ–µ –¥–æ–±–∞–≤—å—Ç–µ –Ω–æ–≤—É—é –¥–∏—Ä–µ–∫—Ç–∏–≤—É —Å –∏–º–µ–Ω–µ–º <code>WEBPUSH_SETTINGS</code> —Å –ø—É–±–ª–∏—á–Ω—ã–º–∏ –∏ —á–∞—Å—Ç–Ω—ã–º–∏ VAPID –∫–ª—é—á–∞–º–∏ –∏ –≤–∞—à –∞–¥—Ä–µ—Å —ç–ª–µ–∫—Ç—Ä–æ–Ω–Ω–æ–π –ø–æ—á—Ç—ã –ø–æ–¥ <code>AUTH_PASSWORD_VALIDATORS:</code></p>
<div class="code-label " title="~/djangopush/djangopush/settings.py">~/djangopush/djangopush/settings.py</div><pre class="code-pre "><code class="code-highlight language-python">...

AUTH_PASSWORD_VALIDATORS = [
    ...
]

<span class="highlight">WEBPUSH_SETTINGS = {</span>
   <span class="highlight">"VAPID_PUBLIC_KEY": "your_vapid_public_key",</span>
   <span class="highlight">"VAPID_PRIVATE_KEY": "your_vapid_private_key",</span>
   <span class="highlight">"VAPID_ADMIN_EMAIL": "admin@example.com"</span>
<span class="highlight">}</span>

# Internationalization
# https://docs.djangoproject.com/en/2.0/topics/i18n/

...
</code></pre>
<p>–ù–µ –∑–∞–±—É–¥—å—Ç–µ –∑–∞–º–µ–Ω–∏—Ç—å –∑–Ω–∞—á–µ–Ω–∏—è <code><span class="highlight">your_vapid_public_key</span></code>, <code><span class="highlight">your_vapid_private_key</span></code> –∏ <code><span class="highlight">admin@example.com</span></code> –Ω–∞ –≤–∞—à–∏ –¥–∞–Ω–Ω—ã–µ. –í–∞—à –∞–¥—Ä–µ—Å —ç–ª–µ–∫—Ç—Ä–æ–Ω–Ω–æ–π –ø–æ—á—Ç—ã –±—É–¥–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ –≤–∞–º —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –ø—Ä–∏ –Ω–∞–ª–∏—á–∏–∏ –ø—Ä–æ–±–ª–µ–º –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ push-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π.</p>

<p>–î–∞–ª–µ–µ –º—ã –Ω–∞—Å—Ç—Ä–æ–∏–º –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è, –∫–æ—Ç–æ—Ä—ã–µ –±—É–¥—É—Ç –æ—Ç–æ–±—Ä–∞–∂–∞—Ç—å –¥–æ–º–∞—à–Ω—é—é —Å—Ç—Ä–∞–Ω–∏—Ü—É –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –∏ –∑–∞–ø—É—Å–∫–∞—Ç—å –æ—Ç–ø—Ä–∞–≤–∫—É push-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –ø–æ–¥–ø–∏—Å–∞–≤—à–∏–º—Å—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º.</p>

<h2 id="–®–∞–≥-2-‚Äî-–ù–∞—Å—Ç—Ä–æ–π–∫–∞-–ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–π">–®–∞–≥ 2 ‚Äî –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–π</h2>

<p>–ù–∞ —ç—Ç–æ–º —à–∞–≥–µ –º—ã –Ω–∞—Å—Ç—Ä–æ–∏–º –±–∞–∑–æ–≤–æ–µ <a href="https://docs.djangoproject.com/en/2.1/topics/http/views/"><em>–ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ</em></a> <code>home</code> —Å <a href="https://docs.djangoproject.com/en/2.1/ref/request-response/#django.http.HttpRequest">–æ–±—ä–µ–∫—Ç–æ–º-–æ—Ç–≤–µ—Ç–æ–º <code>HttpResponse</code></a> –¥–ª—è –Ω–∞—à–µ–π –¥–æ–º–∞—à–Ω–µ–π —Å—Ç—Ä–∞–Ω–∏—Ü—ã, –∞ —Ç–∞–∫–∂–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ <code>send_push</code>. –ü—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è ‚Äî —ç—Ç–æ —Ñ—É–Ω–∫—Ü–∏–∏, –∫–æ—Ç–æ—Ä—ã–µ –±—É–¥—É—Ç –≤–æ–∑–≤—Ä–∞—â–∞—Ç—å –¥–ª—è –≤–µ–±-–∑–∞–ø—Ä–æ—Å–æ–≤. –ü—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ <code>send_push</code> –±—É–¥–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –±–∏–±–ª–∏–æ—Ç–µ–∫—É Django-Webpush –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ push-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π, –∫–æ—Ç–æ—Ä—ã–µ –±—É–¥—É—Ç —Å–æ–¥–µ—Ä–∂–∞—Ç—å –¥–∞–Ω–Ω—ã–µ, –≤–≤–µ–¥–µ–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º –Ω–∞ –¥–æ–º–∞—à–Ω–µ–π —Å—Ç—Ä–∞–Ω–∏—Ü–µ.</p>

<p>–ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ –ø–∞–ø–∫—É <code>~/djangopush/djangopush</code>:</p>
<pre class="code-pre custom_prefix"><code langs=""><ul class="prefixed"><li class="line" prefix="(my_env) $">cd ~/djangopush/djangopush
</li></ul></code></pre>
<p>–ó–∞–ø—É—Å–∫ <code>ls</code> –≤–Ω—É—Ç—Ä–∏ –ø–∞–ø–∫–∏ –±—É–¥–µ—Ç –æ—Ç–æ–±—Ä–∞–∂–∞—Ç—å –æ—Å–Ω–æ–≤–Ω—ã–µ —Ñ–∞–π–ª—ã –ø—Ä–æ–µ–∫—Ç–∞:</p>
<pre class="code-pre "><code langs=""><div class="secondary-code-label " title="Output">Output</div>/__init__.py
/settings.py
/urls.py
/wsgi.py
</code></pre>
<p>–§–∞–π–ª—ã –≤ —ç—Ç–æ–π –ø–∞–ø–∫–µ –≥–µ–Ω–µ—Ä–∏—Ä—É—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —É—Ç–∏–ª–∏—Ç–æ–π <code>django-admin</code>, –∫–æ—Ç–æ—Ä—É—é –≤—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∏ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –≤–∞—à–µ–≥–æ –ø—Ä–æ–µ–∫—Ç–∞ –≤ –ø—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—ã—Ö —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è—Ö. –§–∞–π–ª <code>settings.py</code> —Å–æ–¥–µ—Ä–∂–∏—Ç –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –¥–ª—è –≤—Å–µ–≥–æ –ø—Ä–æ–µ–∫—Ç–∞, —Ç–∞–∫–∏–µ –∫–∞–∫ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –∏ —Å—Ç–∞—Ç–∏—á–Ω—ã–π –∫–æ—Ä–Ω–µ–≤–æ–π –∫–∞—Ç–∞–ª–æ–≥. –§–∞–π–ª <code>urls.py</code> —Å–æ–¥–µ—Ä–∂–∏—Ç –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é URL –¥–ª—è –ø—Ä–æ–µ–∫—Ç–∞. –ó–¥–µ—Å—å –≤—ã –±—É–¥–µ—Ç–µ –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞—Ç—å –º–∞—Ä—à—Ä—É—Ç—ã —Å–æ–≥–ª–∞—Å–Ω–æ —Å–æ–∑–¥–∞–Ω–Ω—ã–º –≤–∞–º–∏ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è–º.</p>

<p>–°–æ–∑–¥–∞–π—Ç–µ –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ <code>~/djangopush/djangopush</code> —Å –Ω–æ–≤—ã–π —Ñ–∞–π–ª –∏–º–µ–Ω–µ–º <code>views.py</code>, –∫–æ—Ç–æ—Ä—ã–π –±—É–¥–µ—Ç —Ö—Ä–∞–Ω–∏—Ç—å –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è –¥–ª—è –≤–∞—à–µ–≥–æ –ø—Ä–æ–µ–∫—Ç–∞:</p>
<pre class="code-pre custom_prefix"><code langs=""><ul class="prefixed"><li class="line" prefix="(my_env) $">nano ~/djangopush/djangopush/views.py
</li></ul></code></pre>
<p>–ü–µ—Ä–≤–æ–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ, –∫–æ—Ç–æ—Ä–æ–µ –º—ã —Å–æ–∑–¥–∞–¥–∏–º, ‚Äî —ç—Ç–æ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ <code>home</code>, –∫–æ—Ç–æ—Ä–æ–µ –±—É–¥–µ—Ç –æ—Ç–æ–±—Ä–∞–∂–∞—Ç—å –¥–æ–º–∞—à–Ω—é—é —Å—Ç—Ä–∞–Ω–∏—Ü—É, —Å –∫–æ—Ç–æ—Ä–æ–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ —Å–º–æ–≥—É—Ç –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å push-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è. –î–æ–±–∞–≤—å—Ç–µ –≤ —Ñ–∞–π–ª —Å–ª–µ–¥—É—é—â–∏–π –∫–æ–¥:</p>
<div class="code-label " title="~/djangopush/djangopush/views.py">~/djangopush/djangopush/views.py</div><pre class="code-pre "><code class="code-highlight language-python">from django.http.response import HttpResponse
from django.views.decorators.http import require_GET

@require_GET
def home(request):
    return HttpResponse('&lt;h1&gt;Home Page&lt;h1&gt;')
</code></pre>
<p>–ü—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ <code>home</code> –æ—Ñ–æ—Ä–º–ª—è–µ—Ç—Å—è —Å –ø–æ–º–æ—â—å—é –¥–µ–∫–æ—Ä–∞—Ç–æ—Ä–∞ <code>require_GET</code>, –æ–≥—Ä–∞–Ω–∏—á–∏–≤–∞—é—â–µ–≥–æ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ —Ç–æ–ª—å–∫–æ –¥–ª—è –∑–∞–ø—Ä–æ—Å–æ–≤ GET. –ö–∞–∫ –ø—Ä–∞–≤–∏–ª–æ, –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –æ—Ç–≤–µ—Ç –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –ø–æ—Å—Ç—É–ø–∞—é—â–µ–≥–æ –∑–∞–ø—Ä–æ—Å–∞. –≠—Ç–æ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –ø—Ä–æ—Å—Ç–æ–π HTML —Ç–µ–≥ –≤ –∫–∞—á–µ—Å—Ç–≤–µ –æ—Ç–≤–µ—Ç–∞.</p>

<p>–î–∞–ª–µ–µ –º—ã —Å–æ–∑–¥–∞–¥–∏–º –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ <code>send_push</code>, –∫–æ—Ç–æ—Ä–æ–µ –±—É–¥–µ—Ç –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è —Å –ø–æ–º–æ—â—å—é –ø–∞–∫–µ—Ç–∞ <code>django-webpush</code>. –û–Ω–æ –±—É–¥–µ—Ç –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–æ —Ç–æ–ª—å–∫–æ –∑–∞–ø—Ä–æ—Å–∞–º–∏ POST –∏ –±—É–¥–µ—Ç –≤—ã–≤–µ–¥–µ–Ω–æ –∏–∑-–ø–æ–¥ –∑–∞—â–∏—Ç—ã –æ—Ç <a href="https://docs.djangoproject.com/en/2.0/ref/csrf/">*–º–µ–∂—Å–∞–π—Ç–æ–≤–æ–π –ø–æ–¥–¥–µ–ª–∫–∏ –∑–∞–ø—Ä–æ—Å–∞ *(CSRF)</a>. –≠—Ç–æ –ø–æ–∑–≤–æ–ª–∏—Ç –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ —Å –ø–æ–º–æ—â—å—é <a href="https://www.getpostman.com/postman">Postman</a> –∏–ª–∏ –ª—é–±–æ–π –¥—Ä—É–≥–æ–π —Å–ª—É–∂–±—ã RESTful. –û–¥–Ω–∞–∫–æ –≤ —Ä–µ–∞–ª—å–Ω–æ–º —Ä–∞–±–æ—á–µ–º –ø—Ä–æ–µ–∫—Ç–µ –≤—ã –¥–æ–ª–∂–Ω—ã —É–¥–∞–ª–∏—Ç—å —ç—Ç–æ—Ç –¥–µ–∫–æ—Ä–∞—Ç–æ—Ä, —á—Ç–æ–±—ã –∑–∞—â–∏—Ç–∏—Ç—å –≤–∞—à–∏ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è –æ—Ç CSRF.</p>

<p>–ß—Ç–æ–±—ã —Å–æ–∑–¥–∞—Ç—å –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ <code>send_push</code>, –Ω—É–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å —Å–ª–µ–¥—É—é—â–∏–µ –∏–º–ø–æ—Ä—Ç—ã, —á—Ç–æ–±—ã –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å –æ—Ç–≤–µ—Ç—ã JSON –∏ –ø–æ–ª—É—á–∏—Ç—å –¥–æ—Å—Ç—É–ø –∫ —Ñ—É–Ω–∫—Ü–∏–∏ <code>send_user_notification</code> –≤ –±–∏–±–ª–∏–æ—Ç–µ–∫–µ <code>webpush</code>:</p>
<div class="code-label " title="~/djangopush/djangopush/views.py">~/djangopush/djangopush/views.py</div><pre class="code-pre "><code class="code-highlight language-python">from django.http.response import <span class="highlight">JsonResponse</span>, HttpResponse
from django.views.decorators.http import require_GET, <span class="highlight">require_POST</span>
<span class="highlight">from django.shortcuts import get_object_or_404</span>
<span class="highlight">from django.contrib.auth.models import User</span>
<span class="highlight">from django.views.decorators.csrf import csrf_exempt</span>
<span class="highlight">from webpush import send_user_notification</span>
<span class="highlight">import json</span>
</code></pre>
<p>–î–∞–ª–µ–µ –¥–æ–±–∞–≤—å—Ç–µ –¥–µ–∫–æ—Ä–∞—Ç–æ—Ä <code>require_POST</code>, –∫–æ—Ç–æ—Ä—ã–π –±—É–¥–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ç–µ–ª–æ –∑–∞–ø—Ä–æ—Å–∞, –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º, –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –∏ –æ—Ç–ø—Ä–∞–≤–∫–∏ push-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è:</p>
<div class="code-label " title="~/djangopush/djangopush/views.py">~/djangopush/djangopush/views.py</div><pre class="code-pre "><code class="code-highlight language-python">@require_GET
def home(request):
    ...


@require_POST
@csrf_exempt
def send_push(request):
    try:
        body = request.body
        data = json.loads(body)

        if 'head' not in data or 'body' not in data or 'id' not in data:
            return JsonResponse(status=400, data={"message": "Invalid data format"})

        user_id = data['id']
        user = get_object_or_404(User, pk=user_id)
        payload = {'head': data['head'], 'body': data['body']}
        send_user_notification(user=user, payload=payload, ttl=1000)

        return JsonResponse(status=200, data={"message": "Web push successful"})
    except TypeError:
        return JsonResponse(status=500, data={"message": "An error occurred"})
</code></pre>
<p>–ú—ã –±—É–¥–µ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥–≤–∞ –¥–µ–∫–æ—Ä–∞—Ç–æ—Ä–∞ –¥–ª—è –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è <code>send_push</code>: –¥–µ–∫–æ—Ä–∞—Ç–æ—Ä <code>require_POST</code>, –æ–≥—Ä–∞–Ω–∏—á–∏–≤–∞—é—â–∏–π –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ —Ç–æ–ª—å–∫–æ –¥–ª—è –∑–∞–ø—Ä–æ—Å–æ–≤ POST, –∏ –¥–µ–∫–æ—Ä–∞—Ç–æ—Ä <code>csrf_exempt</code>, –≤—ã–≤–æ–¥—è—â–∏–π –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ –∏–∑-–ø–æ–¥ –∑–∞—â–∏—Ç—ã –æ—Ç CSRF.</p>

<p>–≠—Ç–æ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ –æ–∂–∏–¥–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ POST –∏ –¥–µ–ª–∞–µ—Ç —Å–ª–µ–¥—É—é—â–µ–µ: –ø–æ–ª—É—á–∞–µ—Ç <code>body</code> –∑–∞–ø—Ä–æ—Å–∞ –∏ —Å –ø–æ–º–æ—â—å—é –ø–∞–∫–µ—Ç–∞ <a href="https://docs.python.org/3/library/json.html">json</a> –¥–µ—Å–µ—Ä–∏–∞–ª–∏–∑—É–µ—Ç –¥–æ–∫—É–º–µ–Ω—Ç JSON –∏ –ø–æ–ª—É—á–∞–µ—Ç –æ–±—ä–µ–∫—Ç Python, –∏—Å–ø–æ–ª—å–∑—É—è <a href="https://docs.python.org/3.6/library/json.html"><code>json.loads</code></a>. <code>json.loads</code> –ø–æ–ª—É—á–∞–µ—Ç —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –¥–æ–∫—É–º–µ–Ω—Ç JSON –∏ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤—ã–≤–∞–µ—Ç –µ–≥–æ –≤ –æ–±—ä–µ–∫—Ç Python.</p>

<p>–ü—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ –æ–∂–∏–¥–∞–µ—Ç, —á—Ç–æ —É –ø–æ–ª—è –æ–±—ä–µ–∫—Ç–∞ –∑–∞–ø—Ä–æ—Å–∞ –±—É–¥—É—Ç —Ç—Ä–∏ —Å–≤–æ–π—Å—Ç–≤–∞:</p>

<ul>
<li><code>head</code>: –∑–∞–≥–æ–ª–æ–≤–æ–∫ push-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è.</li>
<li><code>body</code>: —Ç–µ–ª–æ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è.</li>
<li><code>id</code>: <code>id</code> –æ—Ç–ø—Ä–∞–≤–∏–≤—à–µ–≥–æ –∑–∞–ø—Ä–æ—Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.</li>
</ul>

<p>–ï—Å–ª–∏ –∫–∞–∫–æ–µ-–ª–∏–±–æ –∏–∑ —Ç—Ä–µ–±—É–µ–º—ã—Ö —Å–≤–æ–π—Å—Ç–≤ –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç, –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ –±—É–¥–µ—Ç –≤–æ–∑–≤—Ä–∞—â–∞—Ç—å <code>JSONResponse</code> —Å–æ —Å—Ç–∞—Ç—É—Å–æ–º 404 &ldquo;Not Found&rdquo;. –ï—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å –¥–∞–Ω–Ω—ã–º –æ—Å–Ω–æ–≤–Ω—ã–º –∫–ª—é—á–æ–º —Å—É—â–µ—Å—Ç–≤—É–µ—Ç, –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ –±—É–¥–µ—Ç –≤–æ–∑–≤—Ä–∞—â–∞—Ç—å <code>user</code> —Å —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–º –æ—Å–Ω–æ–≤–Ω—ã–º –∫–ª—é—á–æ–º, –∏—Å–ø–æ–ª—å–∑—É—è <a href="https://docs.djangoproject.com/en/2.1/topics/http/shortcuts/#get-object-or-404">—Ñ—É–Ω–∫—Ü–∏—é <code>get_object_or_404</code></a> –∏–∑ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ <code>django.shortcuts</code>. –ï—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç, —Ñ—É–Ω–∫—Ü–∏—è –±—É–¥–µ—Ç –≤–æ–∑–≤—Ä–∞—â–∞—Ç—å –æ—à–∏–±–∫—É 404.</p>

<p>–¢–∞–∫–∂–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Ñ—É–Ω–∫—Ü–∏—é <code>send_user_notification</code> –∏–∑ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ <code>webpush</code>. –≠—Ç–∞ —Ñ—É–Ω–∫—Ü–∏—è –ø—Ä–∏–Ω–∏–º–∞–µ—Ç —Ç—Ä–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞:</p>

<ul>
<li><code>User: –ø–æ–ª—É—á–∞—Ç–µ–ª—å push-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è.</code></li>
<li><code>payload</code>: –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è, –∫–æ—Ç–æ—Ä–∞—è –≤–∫–ª—é—á–∞–µ—Ç <code>head</code> –∏ <code>body</code> —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è.</li>
<li><code>ttl: –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –≤—Ä–µ–º—è –≤ —Å–µ–∫—É–Ω–¥–∞—Ö, –≤ —Ç–µ—á–µ–Ω–∏–µ –∫–æ—Ç–æ—Ä–æ–≥–æ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ —Å–ª–µ–¥—É–µ—Ç —Ö—Ä–∞–Ω–∏—Ç—å, –µ—Å–ª–∏ –ø–æ–ª—å–∑</code>–æ–≤–∞—Ç–µ–ª—å –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –æ—Ñ—Ñ–ª–∞–π–Ω.</li>
</ul>

<p>–ü—Ä–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–∏ –æ—à–∏–±–æ–∫ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç <code>JSONResponse</code> —Å–æ —Å—Ç–∞—Ç—É—Å–æ–º 200 &ldquo;Success&rdquo; –∏ –æ–±—ä–µ–∫—Ç–æ–º –¥–∞–Ω–Ω—ã—Ö. –ü—Ä–∏ –≤–æ–∑–Ω–∏–∫–Ω–æ–≤–µ–Ω–∏–∏ –æ—à–∏–±–∫–∏ <code>KeyError</code> –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ –±—É–¥–µ—Ç –≤–æ–∑–≤—Ä–∞—â–∞—Ç—å —Å—Ç–∞—Ç—É—Å 500 &ldquo;Internal Server Error&rdquo;. –û—à–∏–±–∫–∞ <code>KeyError</code> –≤–æ–∑–Ω–∏–∫–∞–µ—Ç –ø—Ä–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–∏ –∑–∞–ø—Ä–æ—à–µ–Ω–Ω–æ–≥–æ –∫–ª—é—á–∞ –æ–±—ä–µ–∫—Ç–∞.</p>

<p>–ù–∞ —Å–ª–µ–¥—É—é—â–µ–º —à–∞–≥–µ –º—ã —Å–æ–∑–¥–∞–¥–∏–º —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–µ –º–∞—Ä—à—Ä—É—Ç—ã URL –¥–ª—è –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–π, –∫–æ—Ç–æ—Ä—ã–µ –º—ã —Å–æ–∑–¥–∞–ª–∏.</p>

<h2 id="–®–∞–≥-3-‚Äî-–†–∞–∑–º–µ—Ç–∫–∞-url-–∞–¥—Ä–µ—Å–æ–≤-–¥–ª—è-–ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–π">–®–∞–≥ 3 ‚Äî –†–∞–∑–º–µ—Ç–∫–∞ URL-–∞–¥—Ä–µ—Å–æ–≤ –¥–ª—è –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–π</h2>

<p>Django –ø–æ–∑–≤–æ–ª—è–µ—Ç —Å–æ–∑–¥–∞–≤–∞—Ç—å <a href="https://docs.djangoproject.com/en/2.0/topics/http/urls/">URL-–∞–¥—Ä–µ—Å–∞</a>, –∫–æ—Ç–æ—Ä—ã–µ –±—É–¥—É—Ç –ø–æ–¥–∫–ª—é—á–∞—Ç—å—Å—è –∫ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è–º —Å –ø–æ–º–æ—â—å—é –º–æ–¥—É–ª—è Python —Å –∏–º–µ–Ω–µ–º <code>URLconf</code>. –≠—Ç–æ—Ç –º–æ–¥—É–ª—å —Ä–∞–∑–º–µ—á–∞–µ—Ç –≤—ã—Ä–∞–∂–µ–Ω–∏—è –º–∞—Ä—à—Ä—É—Ç–∞ URL –¥–ª—è —Ñ—É–Ω–∫—Ü–∏–π Python (–≤–∞—à–∏—Ö –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–π). –û–±—ã—á–Ω–æ —Ñ–∞–π–ª –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ URL –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –ø—Ä–æ–µ–∫—Ç–∞. –ù–∞ —ç—Ç–æ–º —à–∞–≥–µ –≤—ã –±—É–¥–µ—Ç–µ –æ–±–Ω–æ–≤–ª—è—Ç—å —ç—Ç–æ—Ç —Ñ–∞–π–ª –¥–ª—è –≤–∫–ª—é—á–µ–Ω–∏—è –Ω–æ–≤—ã—Ö –º–∞—Ä—à—Ä—É—Ç–æ–≤ –¥–ª—è –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–π, —Å–æ–∑–¥–∞–Ω–Ω—ã—Ö –Ω–∞ –ø—Ä–µ–¥—ã–¥—É—â–µ–º —à–∞–≥–µ, –∞ —Ç–∞–∫–∂–µ URL-–∞–¥—Ä–µ—Å–æ–≤ –¥–ª—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è <code>django-webpush</code>, –∫–æ—Ç–æ—Ä—ã–µ –±—É–¥—É—Ç –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è—Ç—å –∫–æ–Ω–µ—á–Ω—ã–µ —Ç–æ—á–∫–∏ –¥–ª—è –ø–æ–¥–ø–∏—Å–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –¥–ª—è push-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π.</p>

<p>–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è—Ö —Å–º. –≤ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–µ <a href="https://www.digitalocean.com/community/tutorials/how-to-create-django-views">–°–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–π Django</a>.</p>

<p>–û—Ç–∫—Ä–æ–π—Ç–µ <code>urls.py</code>:</p>
<pre class="code-pre custom_prefix"><code langs=""><ul class="prefixed"><li class="line" prefix="(my_env) $">nano ~/djangopush/djangopush/urls.py
</li></ul></code></pre>
<p>–§–∞–π–ª –±—É–¥–µ—Ç –≤—ã–≥–ª—è–¥–µ—Ç—å –ø—Ä–∏–º–µ—Ä–Ω–æ —Ç–∞–∫:</p>
<div class="code-label " title="~/djangopush/djangopush/urls.py">~/djangopush/djangopush/urls.py</div><pre class="code-pre "><code class="code-highlight language-python">
"""untitled URL Configuration

The `urlpatterns` list routes URLs to views. For more information please see:
    https://docs.djangoproject.com/en/2.1/topics/http/urls/
Examples:
Function views
    1. Add an import:  from my_app import views
    2. Add a URL to urlpatterns:  path('', views.home, name='home')
Class-based views
    1. Add an import:  from other_app.views import Home
    2. Add a URL to urlpatterns:  path('', Home.as_view(), name='home')
Including another URLconf
    1. Import the include() function: from django.urls import include, path
    2. Add a URL to urlpatterns:  path('blog/', include('blog.urls'))
"""
from django.contrib import admin
from django.urls import path

urlpatterns = [
    path('admin/', admin.site.urls),
]
</code></pre>
<p>–°–ª–µ–¥—É—é—â–∏–º —à–∞–≥–æ–º –±—É–¥–µ—Ç —Ä–∞–∑–º–µ—Ç–∫–∞ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–π —Å —Å–æ–∑–¥–∞–Ω–Ω—ã–º–∏ –≤–∞–º–∏ URL-–∞–¥—Ä–µ—Å–∞–º–∏. –í–æ-–ø–µ—Ä–≤—ã—Ö, –¥–æ–±–∞–≤—å—Ç–µ –∏–º–ø–æ—Ä—Ç <code>include</code>, —á—Ç–æ–±—ã –≥–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å, —á—Ç–æ –≤—Å–µ –º–∞—Ä—à—Ä—É—Ç—ã –¥–ª—è –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ Django-Webpush –±—É–¥—É—Ç –¥–æ–±–∞–≤–ª—è—Ç—å—Å—è –≤ –≤–∞—à –ø—Ä–æ–µ–∫—Ç:</p>
<div class="code-label " title="~/djangopush/djangopush/urls.py">~/djangopush/djangopush/urls.py</div><pre class="code-pre "><code class="code-highlight language-python">
"""webpushdjango URL Configuration
...
"""
from django.contrib import admin
from django.urls import path, <span class="highlight">include</span>
</code></pre>
<p>–î–∞–ª–µ–µ –∏–º–ø–æ—Ä—Ç–∏—Ä—É–π—Ç–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è, –∫–æ—Ç–æ—Ä—ã–µ –≤—ã —Å–æ–∑–¥–∞–ª–∏ –Ω–∞ –ø–æ—Å–ª–µ–¥–Ω–µ–º —à–∞–≥–µ, –∏ –æ–±–Ω–æ–≤–∏—Ç–µ —Å–ø–∏—Å–æ–∫ <code>urlpatterns</code> –¥–ª—è —Ä–∞–∑–º–µ—Ç–∫–∏ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–π:</p>
<div class="code-label " title="~/djangopush/djangopush/urls.py">~/djangopush/djangopush/urls.py</div><pre class="code-pre "><code class="code-highlight language-python">
"""webpushdjango URL Configuration
...
"""
from django.contrib import admin
from django.urls import path, <span class="highlight">include</span>

<span class="highlight">from .views import home, send_push</span>

urlpatterns = [
                  path('admin/', admin.site.urls),
                  <span class="highlight">path('', home),</span>
                  <span class="highlight">path('send_push', send_push),</span>
                  <span class="highlight">path('webpush/', include('webpush.urls')),</span>
              ]
</code></pre>
<p>–ó–¥–µ—Å—å —Å–ø–∏—Å–æ–∫ <code>urlpatterns</code> —Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–µ—Ç URL-–∞–¥—Ä–µ—Å–∞ –¥–ª—è –ø–∞–∫–µ—Ç–∞ <code>django-webpush</code> –∏ —Å–æ–ø–æ—Å—Ç–∞–≤–ª—è–µ—Ç –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è —Å URL-–∞–¥—Ä–µ—Å–∞–º–∏ <code>/send_push</code> –∏ <code>/home</code>.</p>

<p>–î–∞–≤–∞–π—Ç–µ –ø—Ä–æ–≤–µ—Ä–∏–º –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ <code>/home</code>, —á—Ç–æ–±—ã —É–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ –æ–Ω–æ —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–∞–¥–ª–µ–∂–∞—â–∏–º –æ–±—Ä–∞–∑–æ–º. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤—ã –Ω–∞—Ö–æ–¥–∏—Ç–µ—Å—å –≤ –∫–æ—Ä–Ω–µ–≤–æ–π –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ –ø—Ä–æ–µ–∫—Ç–∞:</p>
<pre class="code-pre custom_prefix"><code langs=""><ul class="prefixed"><li class="line" prefix="(my_env) $">cd ~/djangopush
</li></ul></code></pre>
<p>–ó–∞–ø—É—Å—Ç–∏—Ç–µ –≤–∞—à —Å–µ—Ä–≤–µ—Ä —Å –ø–æ–º–æ—â—å—é —Å–ª–µ–¥—É—é—â–µ–π –∫–æ–º–∞–Ω–¥—ã:</p>
<pre class="code-pre custom_prefix"><code langs=""><ul class="prefixed"><li class="line" prefix="(my_env) $">python manage.py runserver <span class="highlight">your_server_ip</span>:8000
</li></ul></code></pre>
<p>–ü–µ—Ä–µ–π–¥–∏—Ç–µ –ø–æ –∞–¥—Ä–µ—Å—É <code>http://<span class="highlight">your_server_ip</span>:8000</code>. –í—ã –¥–æ–ª–∂–Ω—ã —É–≤–∏–¥–µ—Ç—å —Å–ª–µ–¥—É—é—â—É—é –¥–æ–º–∞—à–Ω—é—é —Å—Ç—Ä–∞–Ω–∏—Ü—É:</p>

<p><img src="https://assets.digitalocean.com/articles/django_push_18_04/django_push_home.png" alt="–ü–µ—Ä–≤–æ–Ω–∞—á–∞–ª—å–Ω–æ–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ –¥–æ–º–∞—à–Ω–µ–π —Å—Ç—Ä–∞–Ω–∏—Ü—ã"></p>

<p>–í –¥–∞–Ω–Ω—ã–π –º–æ–º–µ–Ω—Ç –≤—ã –º–æ–∂–µ—Ç–µ –æ—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Å–µ—Ä–≤–µ—Ä —Å –ø–æ–º–æ—â—å—é –∫–Ω–æ–ø–æ–∫ <code>CTRL+C</code>, –ø–æ—Ç–æ–º—É —á—Ç–æ –º—ã –ø–µ—Ä–µ—Ö–æ–¥–∏–º –∫ —Å–æ–∑–¥–∞–Ω–∏—é —à–∞–±–ª–æ–Ω–æ–≤ –∏ –∏—Ö –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—é –≤ –Ω–∞—à–∏—Ö –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è—Ö —Å –ø–æ–º–æ—â—å—é —Ñ—É–Ω–∫—Ü–∏–∏ <code>render</code>.</p>

<h2 id="–®–∞–≥-4-‚Äî-–°–æ–∑–¥–∞–Ω–∏–µ-—à–∞–±–ª–æ–Ω–æ–≤">–®–∞–≥ 4 ‚Äî –°–æ–∑–¥–∞–Ω–∏–µ —à–∞–±–ª–æ–Ω–æ–≤</h2>

<p>–î–≤–∏–∂–æ–∫ —à–∞–±–ª–æ–Ω–æ–≤ Django –ø–æ–∑–≤–æ–ª—è–µ—Ç –æ–ø—Ä–µ–¥–µ–ª—è—Ç—å –æ—Ç–æ–±—Ä–∞–∂–∞–µ–º—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º —Å–ª–æ–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è —Å –ø–æ–º–æ—â—å—é —à–∞–±–ª–æ–Ω–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ –∞–Ω–∞–ª–æ–≥–∏—á–Ω—ã —Ñ–∞–π–ª–∞–º HTML. –ù–∞ —ç—Ç–æ–º —à–∞–≥–µ –≤—ã —Å–æ–∑–¥–∞–¥–∏—Ç–µ –∏ –æ—Ç–æ–±—Ä–∞–∑–∏—Ç–µ —à–∞–±–ª–æ–Ω –¥–ª—è –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è <code>home</code>.</p>

<p>–°–æ–∑–¥–∞–π—Ç–µ –ø–∞–ø–∫—É —Å –∏–º–µ–Ω–µ–º <code>templates</code> –≤ –∫–æ—Ä–Ω–µ–≤–æ–π –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ –≤–∞—à–µ–≥–æ –ø—Ä–æ–µ–∫—Ç–∞:</p>
<pre class="code-pre custom_prefix"><code langs=""><ul class="prefixed"><li class="line" prefix="(my_env) $">mkdir ~/djangopush/templates
</li></ul></code></pre>
<p>–ï—Å–ª–∏ –≤—ã –∑–∞–ø—É—Å—Ç–∏—Ç–µ –∫–æ–º–∞–Ω–¥—É <code>ls</code> –≤ –∫–æ—Ä–Ω–µ–≤–æ–π –ø–∞–ø–∫–µ –≤–∞—à–µ–≥–æ –ø—Ä–æ–µ–∫—Ç–∞ –≤ —Ç–µ–∫—É—â–∏–π –º–æ–º–µ–Ω—Ç, –≤—ã–≤–æ–¥ –±—É–¥–µ—Ç –≤—ã–≥–ª—è–¥–µ—Ç—å –ø—Ä–∏–º–µ—Ä–Ω–æ —Ç–∞–∫:</p>
<pre class="code-pre "><code langs=""><div class="secondary-code-label " title="Output">Output</div>/djangopush
/templates
db.sqlite3
manage.py
/my_env
</code></pre>
<p>–°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª <code>home.html</code> –≤ –ø–∞–ø–∫–µ <code>templates</code>:</p>
<pre class="code-pre custom_prefix"><code langs=""><ul class="prefixed"><li class="line" prefix="(my_env) $">nano ~/djangopush/templates/home.html
</li></ul></code></pre>
<p>–î–æ–±–∞–≤—å—Ç–µ —Å–ª–µ–¥—É—é—â–∏–π –≤ —Ñ–∞–π–ª –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è —Ñ–æ—Ä–º—ã, –≤ –∫–æ—Ç–æ—Ä—É—é –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ —Å–º–æ–≥—É—Ç –≤–≤–æ–¥–∏—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è push-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π:</p>
<pre class="code-pre "><code class="code-highlight language-html">{% load static %}
&lt;!DOCTYPE html&gt;
&lt;html lang="en"&gt;
&lt;head&gt;
    &lt;meta charset="UTF-8"&gt;
    &lt;meta name="viewport" content="width=device-width, initial-scale=1.0"&gt;
    &lt;meta http-equiv="X-UA-Compatible" content="ie=edge"&gt;
    &lt;meta name="vapid-key" content="{{ vapid_key }}"&gt;
    {% if user.id %}
        &lt;meta name="user_id" content="{{ user.id }}"&gt;
    {% endif %}
    &lt;title&gt;Web Push&lt;/title&gt;
    &lt;link href="https://fonts.googleapis.com/css?family=PT+Sans:400,700" rel="stylesheet"&gt;
&lt;/head&gt;

&lt;body&gt;
&lt;div&gt;
    &lt;form id="send-push__form"&gt;
        &lt;h3 class="header"&gt;Send a push notification&lt;/h3&gt;
        &lt;p class="error"&gt;&lt;/p&gt;
        &lt;input type="text" name="head" placeholder="Header: Your favorite airline üòç"&gt;
        &lt;textarea name="body" id="" cols="30" rows="10" placeholder="Body: Your flight has been cancelled üò±üò±üò±"&gt;&lt;/textarea&gt;
        &lt;button&gt;Send Me&lt;/button&gt;
    &lt;/form&gt;
&lt;/div&gt;
&lt;/body&gt;
&lt;/html&gt;
</code></pre>
<p><code>body</code> —Ñ–∞–π–ª–∞ –≤–∫–ª—é—á–∞–µ—Ç –≤ —Å–µ–±—è —Ñ–æ—Ä–º—É —Å –¥–≤—É–º—è –ø–æ–ª—è–º–∏: —ç–ª–µ–º–µ–Ω—Ç <code>input</code> –±—É–¥–µ—Ç —Ö—Ä–∞–Ω–∏—Ç—å –∑–∞–≥–æ–ª–æ–≤–æ–∫/–Ω–∞–∑–≤–∞–Ω–∏–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è, –∞ —ç–ª–µ–º–µ–Ω—Ç <code>textarea</code> –±—É–¥–µ—Ç —Ö—Ä–∞–Ω–∏—Ç—å —Ç–µ–ª–æ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è.</p>

<p>–í —Ä–∞–∑–¥–µ–ª–µ <code>head</code> –≤ —Ñ–∞–π–ª–µ –µ—Å—Ç—å –¥–≤–∞ —Ç–µ–≥–∞ <code>meta</code>, –∫–æ—Ç–æ—Ä—ã–µ –±—É–¥—É—Ç —Ö—Ä–∞–Ω–∏—Ç—å –ø—É–±–ª–∏—á–Ω—ã–π –∫–ª—é—á VAPID –∏ –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è. –≠—Ç–∏ –¥–≤–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ —Ç—Ä–µ–±—É—é—Ç—Å—è –¥–ª—è —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏ –æ—Ç–ø—Ä–∞–≤–∫–∏ –µ–º—É push-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è. –ó–¥–µ—Å—å —Ç—Ä–µ–±—É–µ—Ç—Å—è –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è, –ø–æ—Å–∫–æ–ª—å–∫—É –≤—ã –±—É–¥–µ—Ç–µ –Ω–∞–ø—Ä–∞–≤–ª—è—Ç—å –∑–∞–ø—Ä–æ—Å—ã AJAX –Ω–∞ —Å–µ—Ä–≤–µ—Ä, –∞ <code>id</code> –±—É–¥–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –¥–ª—è –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è. –ï—Å–ª–∏ —Ç–µ–∫—É—â–∏–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —è–≤–ª—è–µ—Ç—Å—è –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º, —à–∞–±–ª–æ–Ω –±—É–¥–µ—Ç —Å–æ–∑–¥–∞–≤–∞—Ç—å —Ç–µ–≥ <code>meta</code> —Å –µ–≥–æ <code>id</code> –≤ –∫–∞—á–µ—Å—Ç–≤–µ –∫–æ–Ω—Ç–µ–Ω—Ç–∞.</p>

<p>–°–ª–µ–¥—É—é—â–∏–º —à–∞–≥–æ–º –Ω—É–∂–Ω–æ —É–∫–∞–∑–∞—Ç—å Django, –≥–¥–µ –Ω—É–∂–Ω–æ —Ö—Ä–∞–Ω–∏—Ç—å –≤–∞—à–∏ —à–∞–±–ª–æ–Ω—ã. –î–ª—è —ç—Ç–æ–≥–æ –Ω—É–∂–Ω–æ –æ—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å —Ñ–∞–π–ª <code>settings.py</code> –∏ –æ–±–Ω–æ–≤–∏—Ç—å —Å–ø–∏—Å–æ–∫ <code>TEMPLATES</code>.</p>

<p>–û—Ç–∫—Ä–æ–π—Ç–µ —Ñ–∞–π–ª <code>settings.py</code>:</p>
<pre class="code-pre custom_prefix"><code langs=""><ul class="prefixed"><li class="line" prefix="(my_env) $">nano ~/djangopush/djangopush/settings.py
</li></ul></code></pre>
<p>–î–æ–±–∞–≤—å—Ç–µ —Å–ª–µ–¥—É—é—â–∏–µ –¥–∞–Ω–Ω—ã–µ –≤ —Å–ø–∏—Å–æ–∫ <code>DIRS</code> –¥–ª—è —É–∫–∞–∑–∞–Ω–∏—è –ø—É—Ç–∏ –∫ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ —à–∞–±–ª–æ–Ω–æ–≤:</p>
<div class="code-label " title="~/djangopush/djangopush/settings.py">~/djangopush/djangopush/settings.py</div><pre class="code-pre "><code class="code-highlight language-python">...
TEMPLATES = [
    {
        'BACKEND': 'django.template.backends.django.DjangoTemplates',
        'DIRS': [<span class="highlight">os.path.join(BASE_DIR, 'templates')</span>],
        'APP_DIRS': True,
        'OPTIONS': {
            'context_processors': [
                ...
            ],
        },
    },
]
...
</code></pre>
<p>–ó–∞—Ç–µ–º –≤ —Ñ–∞–π–ª–µ <code>views.py</code> –æ–±–Ω–æ–≤–∏—Ç–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ <code>home</code> –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è —à–∞–±–ª–æ–Ω–∞ <code>home.html</code>. –û—Ç–∫—Ä–æ–π—Ç–µ —Ñ–∞–π–ª:</p>
<pre class="code-pre custom_prefix"><code langs=""><ul class="prefixed"><li class="line" prefix="(my_env) $">nano ~/djangpush/djangopush/views.py
</li></ul></code></pre>
<p>–í–æ-–ø–µ—Ä–≤—ã—Ö, –¥–æ–±–∞–≤—å—Ç–µ —Ä—è–¥ –∏–º–ø–æ—Ä—Ç–æ–≤, –≤–∫–ª—é—á–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é <code>settings</code>, –∫–æ—Ç–æ—Ä–∞—è —Å–æ–¥–µ—Ä–∂–∏—Ç –≤—Å–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –ø—Ä–æ–µ–∫—Ç–∞ –∏–∑ —Ñ–∞–π–ª–∞ <code>settings.py</code> –∏ —Ñ—É–Ω–∫—Ü–∏—é <code>render</code> –∏–∑ <code>django.shortcuts</code>:</p>
<div class="code-label " title="~/djangopush/djangopush/views.py">~/djangopush/djangopush/views.py</div><pre class="code-pre "><code class="code-highlight language-python">...
from django.shortcuts import <span class="highlight">render</span>, get_object_or_404
...
import json
<span class="highlight">from django.conf import settings</span>

...
</code></pre>
<p>–î–∞–ª–µ–µ —É–¥–∞–ª–∏—Ç–µ –ø–µ—Ä–≤–æ–Ω–∞—á–∞–ª—å–Ω—ã–π –∫–æ–¥, –¥–æ–±–∞–≤–ª–µ–Ω–Ω—ã–π –≤ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ <code>home</code>, –∏ –¥–æ–±–∞–≤—å—Ç–µ —Å–ª–µ–¥—É—é—â–∏–µ –¥–∞–Ω–Ω—ã–µ, —É–∫–∞–∑—ã–≤–∞—é—â–∏–µ, –∫–∞–∫ —Å–æ–∑–¥–∞–Ω–Ω—ã–π –≤–∞–º–∏ —à–∞–±–ª–æ–Ω –±—É–¥–µ—Ç –æ—Ç–æ–±—Ä–∞–∂–∞—Ç—å—Å—è:</p>
<div class="code-label " title="~/djangopush/djangopush/views.py">~/djangopush/djangopush/views.py</div><pre class="code-pre "><code class="code-highlight language-python">...

<a href="https://www.digitalocean.com/community/users/require_get" class="username-tag">@require_GET</a>
def home(request):
   <span class="highlight">webpush_settings = getattr(settings, 'WEBPUSH_SETTINGS', {})</span>
   <span class="highlight">vapid_key = webpush_settings.get('VAPID_PUBLIC_KEY')</span>
   <span class="highlight">user = request.user</span>
   <span class="highlight">return render(request, 'home.html', {user: user, 'vapid_key': vapid_key})</span>
</code></pre>
<p>–ö–æ–¥ –ø—Ä–∏—Å–≤–∞–∏–≤–∞–µ—Ç –∑–Ω–∞—á–µ–Ω–∏—è –¥–ª—è —Å–ª–µ–¥—É—é—â–∏—Ö –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö:</p>

<ul>
<li><code>webpush_settings</code>: –¥–∞–Ω–Ω—ã–π –ø–∞—Ä–∞–º–µ—Ç—Ä –ø—Ä–∏—Å–≤–∞–∏–≤–∞–µ—Ç –∑–Ω–∞—á–µ–Ω–∏–µ –∞—Ç—Ä–∏–±—É—Ç–∞ <code>WEBPUSH_SETTINGS</code> –∏–∑ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ <code>settings</code>.</li>
<li><code>vapid_key:</code> —ç—Ç–æ—Ç —ç–ª–µ–º–µ–Ω—Ç –ø–æ–ª—É—á–∞–µ—Ç –∑–Ω–∞—á–µ–Ω–∏–µ <code>VAPID_PUBLIC_KEY</code> –∏–∑ –æ–±—ä–µ–∫—Ç–∞ <code>webpush_settings</code> –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ –∫–ª–∏–µ–Ω—Ç—É. –î–∞–Ω–Ω—ã–π –ø—É–±–ª–∏—á–Ω—ã–π –∫–ª—é—á —Å—Ä–∞–≤–Ω–∏–≤–∞–µ—Ç—Å—è —Å –∑–∞–∫—Ä—ã—Ç—ã–º –∫–ª—é—á–æ–º, —á—Ç–æ–±—ã —É–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ –∫–ª–∏–µ–Ω—Ç —Å –ø—É–±–ª–∏—á–Ω—ã–º –∫–ª—é—á–æ–º –º–æ–∂–µ—Ç –ø–æ–ª—É—á–∞—Ç—å push-—Å–æ–æ–±—â–µ–Ω–∏—è –æ—Ç —Å–µ—Ä–≤–µ—Ä–∞.</li>
<li><code>user</code>: —ç—Ç–∞ –ø–µ—Ä–µ–º–µ–Ω–∫–∞ –ø–æ—Å—Ç—É–ø–∞–µ—Ç –∏–∑ –≤—Ö–æ–¥—è—â–µ–≥–æ –∑–∞–ø—Ä–æ—Å–∞. –ö–æ–≥–¥–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –∑–∞–ø—Ä–æ—Å –Ω–∞ —Å–µ—Ä–≤–µ—Ä, –¥–∞–Ω–Ω—ã–µ —ç—Ç–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ –ø–æ–ª–µ <code>user</code>.</li>
</ul>

<p><a href="https://docs.djangoproject.com/en/2.1/topics/http/shortcuts/#render">–§—É–Ω–∫—Ü–∏—è <code>render</code></a> –±—É–¥–µ—Ç –≤–æ–∑–≤—Ä–∞—â–∞—Ç—å —Ñ–∞–π–ª HTML –∏ –æ–±—ä–µ–∫—Ç <a href="https://docs.djangoproject.com/en/2.1/ref/templates/api/#django.template.Context">context</a>, —Å–æ–¥–µ—Ä–∂–∞—â–∏–π —Ç–µ–∫—É—â–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏ –ø—É–±–ª–∏—á–Ω—ã–π –∫–ª—é—á VAPID. –ó–¥–µ—Å—å —Ç—Ä–µ–±—É—é—Ç—Å—è —Ç—Ä–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞: <code>–∑–∞–ø—Ä–æ—Å</code>, <code>—à–∞–±–ª–æ–Ω</code> –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –∏ –æ–±—ä–µ–∫—Ç, –∫–æ—Ç–æ—Ä—ã–π —Å–æ–¥–µ—Ä–∂–∏—Ç –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ, –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ –≤ —à–∞–±–ª–æ–Ω–µ.</p>

<p>–ü–æ—Å–ª–µ —Å–æ–∑–¥–∞–Ω–∏—è –Ω–∞—à–µ–≥–æ —à–∞–±–ª–æ–Ω–∞ –∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è <code>home</code> –º—ã –º–æ–∂–µ–º –ø–µ—Ä–µ–π—Ç–∏ –∫ –Ω–∞—Å—Ç—Ä–æ–π–∫–µ Django –¥–ª—è –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏—è —Å—Ç–∞—Ç–∏—á–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤.</p>

<h2 id="–®–∞–≥-5-‚Äî-–û–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ-—Å—Ç–∞—Ç–∏—á–Ω—ã—Ö-—Ñ–∞–π–ª–æ–≤">–®–∞–≥ 5 ‚Äî –û–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ —Å—Ç–∞—Ç–∏—á–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤</h2>

<p>–í–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è, –≤–∫–ª—é—á–∞—è CSS, JavaScript –∏ –¥—Ä—É–≥–∏–µ —Ñ–∞–π–ª—ã –æ–±—Ä–∞–∑–∞, –∫–æ—Ç–æ—Ä—ã–µ Django –≤–æ—Å–ø—Ä–∏–Ω–∏–º–∞–µ—Ç –≤ –∫–∞—á–µ—Å—Ç–≤–µ &ldquo;—Å—Ç–∞—Ç–∏—á–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤&rdquo;. Django –ø–æ–∑–≤–æ–ª—è–µ—Ç —Å–æ–±–∏—Ä–∞—Ç—å –≤—Å–µ —Å—Ç–∞—Ç–∏—á–Ω—ã–µ —Ñ–∞–π–ª—ã –∏–∑ –∫–∞–∂–¥–æ–≥–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –≤ –≤–∞—à–µ–º –ø—Ä–æ–µ–∫—Ç–µ –≤ –æ–¥–Ω–æ–º –º–µ—Å—Ç–µ, –∏–∑ –∫–æ—Ç–æ—Ä–æ–≥–æ –æ–Ω–∏ –±—É–¥—É—Ç –æ–±—Å–ª—É–∂–∏–≤–∞—Ç—å—Å—è. –≠—Ç–æ —Ä–µ—à–µ–Ω–∏–µ –Ω–∞–∑—ã–≤–∞–µ—Ç—Å—è <code>django.contrib.staticfiles</code>. –ù–∞ —ç—Ç–æ–º —à–∞–≥–µ –º—ã –æ–±–Ω–æ–≤–∏–º –Ω–∞—à–∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏, —á—Ç–æ–±—ã —É–∫–∞–∑–∞—Ç—å Django, –≥–¥–µ –Ω–∞—à–∏ —Å—Ç–∞—Ç–∏—á–Ω—ã–µ —Ñ–∞–π–ª—ã –±—É–¥—É—Ç —Ö—Ä–∞–Ω–∏—Ç—å—Å—è.</p>

<p>–û—Ç–∫—Ä–æ–π—Ç–µ —Ñ–∞–π–ª <code>settings.py</code>:</p>
<pre class="code-pre custom_prefix"><code langs=""><ul class="prefixed"><li class="line" prefix="(my_env) $">nano ~/djangopush/djangopush/settings.py
</li></ul></code></pre>
<p>–í —Ñ–∞–π–ª–µ <code>settings.py</code> –Ω—É–∂–Ω–æ —É–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ –∑–Ω–∞—á–µ–Ω–∏–µ <code>STATIC_URL</code> –±—ã–ª–æ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–æ:</p>
<div class="code-label " title="~/djangopush/djangopush/settings.py">~/djangopush/djangopush/settings.py</div><pre class="code-pre "><code class="code-highlight language-python">...
STATIC_URL = '/static/'
</code></pre>
<p>–î–∞–ª–µ–µ –¥–æ–±–∞–≤—å—Ç–µ —Å–ø–∏—Å–æ–∫ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–π —Å –Ω–∞–∑–≤–∞–Ω–∏–µ–º <code>STATICFILES_DIRS</code>, –≥–¥–µ Django –±—É–¥–µ—Ç –∏—Å–∫–∞—Ç—å —Å—Ç–∞—Ç–∏—á–Ω—ã–µ —Ñ–∞–π–ª—ã:</p>
<div class="code-label " title="~/djangopush/djangopush/settings.py">~/djangopush/djangopush/settings.py</div><pre class="code-pre "><code class="code-highlight language-python">...
STATIC_URL = '/static/'
<span class="highlight">STATICFILES_DIRS = [</span>
    <span class="highlight">os.path.join(BASE_DIR, "static"),</span>
<span class="highlight">]</span>
</code></pre>
<p>–¢–µ–ø–µ—Ä—å –≤—ã –º–æ–∂–µ—Ç–µ –¥–æ–±–∞–≤–∏—Ç—å <code>STATIC_URL</code> –≤ —Å–ø–∏—Å–æ–∫ –ø—É—Ç–µ–π, –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã—Ö –≤ —Ñ–∞–π–ª–µ <code>urls.py</code>.</p>

<p>–û—Ç–∫—Ä–æ–π—Ç–µ —Ñ–∞–π–ª:</p>
<pre class="code-pre custom_prefix"><code langs=""><ul class="prefixed"><li class="line" prefix="(my_env) $">nano ~/djangopush/djangopush/urls.py
</li></ul></code></pre>
<p>–î–æ–±–∞–≤—å—Ç–µ —Å–ª–µ–¥—É—é—â–∏–π –∫–æ–¥, –∫–æ—Ç–æ—Ä—ã–π –±—É–¥–µ—Ç –∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å  –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é <code>static</code> URL-–∞–¥—Ä–µ—Å–æ–≤ –∏ –æ–±–Ω–æ–≤–ª—è—Ç—å —Å–ø–∏—Å–æ–∫ <code>urlpatterns</code>. –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –∑–¥–µ—Å—å –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Å–≤–æ–π—Å—Ç–≤–∞ <code>STATIC_URL</code> –∏ <code>STATIC_ROOT</code>, –∫–æ—Ç–æ—Ä—ã–µ –º—ã –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–∏–ª–∏ –≤ —Ñ–∞–π–ª–µ <code>settings.py</code> –¥–ª—è –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏—è —Å—Ç–∞—Ç–∏—á–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤ –ø—Ä–æ–µ–∫—Ç–∞:</p>
<div class="code-label " title="~/djangopush/djangopush/urls.py">~/djangopush/djangopush/urls.py</div><pre class="code-pre "><code class="code-highlight language-python">
...
<span class="highlight">from django.conf import settings</span>
<span class="highlight">from django.conf.urls.static import static</span>

urlpatterns = [
    ...
] <span class="highlight"> + static(settings.STATIC_URL, document_root=settings.STATIC_ROOT)</span>
</code></pre>
<p>–ü–æ—Å–ª–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ —Å—Ç–∞—Ç–∏—á–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤ –º—ã –º–æ–∂–µ–º –ø–µ—Ä–µ–π—Ç–∏ –∫ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—é —Å—Ç–∏–ª—è –¥–æ–º–∞—à–Ω–µ–π —Å—Ç—Ä–∞–Ω–∏—Ü—ã –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è.</p>

<h2 id="–®–∞–≥-6-‚Äî-–û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ-—Å—Ç–∏–ª—è-–¥–æ–º–∞—à–Ω–µ–π-—Å—Ç—Ä–∞–Ω–∏—Ü—ã">–®–∞–≥ 6 ‚Äî –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Å—Ç–∏–ª—è –¥–æ–º–∞—à–Ω–µ–π —Å—Ç—Ä–∞–Ω–∏—Ü—ã</h2>

<p>–ü–æ—Å–ª–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –≤–∞—à–µ–≥–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –¥–ª—è –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏—è —Å—Ç–∞—Ç–∏—á–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤ –≤—ã –º–æ–∂–µ—Ç–µ —Å–æ–∑–¥–∞—Ç—å –≤–Ω–µ—à–Ω—é—é —Ç–∞–±–ª–∏—Ü—É —Å—Ç–∏–ª–µ–π –∏ –ø—Ä–∏–≤—è–∑–∞—Ç—å –µ–µ –∫ —Ñ–∞–π–ª—É <code>home.html</code> –¥–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —Å—Ç–∏–ª—è –¥–æ–º–∞—à–Ω–µ–π —Å—Ç—Ä–∞–Ω–∏—Ü—ã. –í—Å–µ –≤–∞—à–∏ —Å—Ç–∞—Ç–∏—á–Ω—ã–µ —Ñ–∞–π–ª—ã –±—É–¥—É—Ç —Ö—Ä–∞–Ω–∏—Ç—å—Å—è –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ <code>static</code> –∫–æ—Ä–Ω–µ–≤–æ–π –ø–∞–ø–∫–∏ –≤–∞—à–µ–≥–æ –ø—Ä–æ–µ–∫—Ç–∞.</p>

<p>–°–æ–∑–¥–∞–π—Ç–µ –ø–∞–ø–∫—É <code>static</code>, –∞ –≤–Ω—É—Ç—Ä–∏ –ø–∞–ø–∫–∏ <code>static</code> —Å–æ–∑–¥–∞–π—Ç–µ –ø–∞–ø–∫—É <code>css</code>:</p>
<pre class="code-pre custom_prefix"><code langs=""><ul class="prefixed"><li class="line" prefix="(my_env) $">mkdir -p ~/djangopush/static/css
</li></ul></code></pre>
<p>–û—Ç–∫—Ä–æ–π—Ç–µ —Ñ–∞–π–ª css —Å –∏–º–µ–Ω–µ–º <code>styles.css</code> –≤ –ø–∞–ø–∫–µ <code>css</code>:</p>
<pre class="code-pre custom_prefix"><code langs=""><ul class="prefixed"><li class="line" prefix="(my_env) $">nano ~/djangopush/static/css/styles.css
</li></ul></code></pre>
<p>–î–æ–±–∞–≤—å—Ç–µ —Å–ª–µ–¥—É—é—â–∏–µ —Å—Ç–∏–ª–∏ –¥–ª—è –¥–æ–º–∞—à–Ω–µ–π —Å—Ç—Ä–∞–Ω–∏—Ü—ã:</p>
<div class="code-label " title="~/djangopush/static/css/styles.css">~/djangopush/static/css/styles.css</div><pre class="code-pre "><code class="code-highlight language-css">
body {
    height: 100%;
    background: rgba(0, 0, 0, 0.87);
    font-family: 'PT Sans', sans-serif;
}

div {
    height: 100%;
    display: flex;
    align-items: center;
    justify-content: center;
}

form {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    width: 35%;
    margin: 10% auto;
}

form &gt; h3 {
    font-size: 17px;
    font-weight: bold;
    margin: 15px 0;
    color: orangered;
    text-transform: uppercase;
}

form &gt; .error {
    margin: 0;
    font-size: 15px;
    font-weight: normal;
    color: orange;
    opacity: 0.7;
}

form &gt; input, form &gt; textarea {
    border: 3px solid orangered;
    box-shadow: unset;
    padding: 13px 12px;
    margin: 12px auto;
    width: 80%;
    font-size: 13px;
    font-weight: 500;
}

form &gt; input:focus, form &gt; textarea:focus {
    border: 3px solid orangered;
    box-shadow: 0 2px 3px 0 rgba(0, 0, 0, 0.2);
    outline: unset;
}

form &gt; button {
    justify-self: center;
    padding: 12px 25px;
    border-radius: 0;
    text-transform: uppercase;
    font-weight: 600;
    background: orangered;
    color: white;
    border: none;
    font-size: 14px;
    letter-spacing: -0.1px;
    cursor: pointer;
}

form &gt; button:disabled {
    background: dimgrey;
    cursor: not-allowed;
}
</code></pre>
<p>–ü–æ—Å–ª–µ —Å–æ–∑–¥–∞–Ω–∏—è —Ç–∞–±–ª–∏—Ü—ã —Å—Ç–∏–ª–µ–π –≤—ã –º–æ–∂–µ—Ç–µ –ø—Ä–∏–≤—è–∑–∞—Ç—å –µ–µ –∫ —Ñ–∞–π–ª—É <code>home.html</code>, –∏—Å–ø–æ–ª—å–∑—É—è <a href="https://docs.djangoproject.com/en/2.1/ref/templates/builtins/#std:templatetag-static">—Ç–µ–≥–∏ —Å—Ç–∞—Ç–∏—á–Ω–æ–≥–æ —à–∞–±–ª–æ–Ω–∞</a>. –û—Ç–∫—Ä–æ–π—Ç–µ —Ñ–∞–π–ª <code>home.html</code>:</p>
<pre class="code-pre custom_prefix"><code langs=""><ul class="prefixed"><li class="line" prefix="(my_env) $">nano ~/djangopush/templates/home.html
</li></ul></code></pre>
<p>–û–±–Ω–æ–≤–∏—Ç–µ —Ä–∞–∑–¥–µ–ª <code>head</code> –¥–ª—è –≤–∫–ª—é—á–µ–Ω–∏—è –≤ –Ω–µ–≥–æ —Å—Å—ã–ª–∫–∏ –Ω–∞ –≤–Ω–µ—à–Ω—é—é —Ç–∞–±–ª–∏—Ü—É —Å—Ç–∏–ª–µ–π:</p>
<div class="code-label " title="~/djangopush/templates/home.html">~/djangopush/templates/home.html</div><pre class="code-pre "><code class="code-highlight language-html">
{% load static %}
&lt;!DOCTYPE html&gt;
&lt;html lang="en"&gt;

&lt;head&gt;
    ...
    <span class="highlight">&lt;link href="{% static '/css/styles.css' %}" rel="stylesheet"&gt;</span>
&lt;/head&gt;
&lt;body&gt;
    ...
&lt;/body&gt;
&lt;/html&gt;
</code></pre>
<p>–£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤—ã –Ω–∞—Ö–æ–¥–∏—Ç–µ—Å—å –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ –æ—Å–Ω–æ–≤–Ω–æ–≥–æ –ø—Ä–æ–µ–∫—Ç–∞, –∏ —Å–Ω–æ–≤–∞ –∑–∞–ø—É—Å—Ç–∏—Ç–µ –≤–∞—à —Å–µ—Ä–≤–µ—Ä –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ä–∞–±–æ—Ç—ã:</p>
<pre class="code-pre custom_prefix"><code langs=""><ul class="prefixed"><li class="line" prefix="(my_env) $">cd ~/djangopush
</li><li class="line" prefix="(my_env) $">python manage.py runserver <span class="highlight">your_server_ip</span>:8000
</li></ul></code></pre>
<p>–ü—Ä–∏ –ø–æ—Å–µ—â–µ–Ω–∏–∏ <code>http://<span class="highlight">your_server_ip</span>:8080</code> —Å—Ç—Ä–∞–Ω–∏—Ü–∞ –¥–æ–ª–∂–Ω–∞ –≤—ã–≥–ª—è–¥–µ—Ç—å —Å–ª–µ–¥—É—é—â–∏–º –æ–±—Ä–∞–∑–æ–º:</p>

<p><img src="https://assets.digitalocean.com/articles/django_push_18_04/push_styled_home.png" alt="–ü—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ –¥–æ–º–∞—à–Ω–µ–π —Å—Ç—Ä–∞–Ω–∏—Ü—ã"> –°–Ω–æ–≤–∞ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Å–æ—á–µ—Ç–∞–Ω–∏–µ –∫–ª–∞–≤–∏—à <code>CTRL+C</code> –¥–ª—è –æ—Å—Ç–∞–Ω–æ–≤–∫–∏ —Å–µ—Ä–≤–µ—Ä–∞.</p>

<p>–¢–µ–ø–µ—Ä—å, –∫–æ–≥–¥–∞ –≤—ã —É—Å–ø–µ—à–Ω–æ —Å–æ–∑–¥–∞–ª–∏ —Å—Ç—Ä–∞–Ω–∏—Ü—É <code>home.html</code> –∏ –¥–æ–±–∞–≤–∏–ª–∏ –¥–ª—è –Ω–µ–µ —Ç–∞–±–ª–∏—Ü—É —Å—Ç–∏–ª–µ–π, –≤—ã –º–æ–∂–µ—Ç–µ –æ—Ñ–æ—Ä–º–∏—Ç—å –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –ø–æ–¥–ø–∏—Å–∫—É –Ω–∞ push-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è, –∫–æ–≥–¥–∞ –±—ã –æ–Ω–∏ –Ω–∏ –ø–æ—Å–µ—Ç–∏–ª–∏ –¥–æ–º–∞—à–Ω—é—é —Å—Ç—Ä–∞–Ω–∏—Ü—É.</p>

<h2 id="–®–∞–≥-7-‚Äî-–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è-service-worker-–∏-–ø–æ–¥–ø–∏—Å–∫–∞-–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π-–Ω–∞-push-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è">–®–∞–≥ 7 ‚Äî –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è service worker –∏ –ø–æ–¥–ø–∏—Å–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –Ω–∞ push-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è</h2>

<p>Push-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –≤ –≤–µ–± –º–æ–≥—É—Ç —É–≤–µ–¥–æ–º–ª—è—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –æ –Ω–∞–ª–∏—á–∏–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π –¥–ª—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π, –Ω–∞ –∫–æ—Ç–æ—Ä—ã–µ –æ–Ω–∏ –ø–æ–¥–ø–∏—Å–∞–Ω—ã, –∏–ª–∏ –¥–ª—è –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è –æ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –≤—Å–ø–æ–º–Ω–∏—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ, –∫–æ—Ç–æ—Ä–æ–µ –æ–Ω–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∏ –≤ –ø—Ä–æ—à–ª–æ–º. –û–Ω–∏ –æ–ø–∏—Ä–∞—é—Ç—Å—è –Ω–∞ –¥–≤–µ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏, API <a href="https://developer.mozilla.org/en-US/docs/Web/API/Push_API">push</a> –∏ API <a href="https://developer.mozilla.org/en-US/docs/Web/API/Notifications_API">notifications</a>. –û–±–µ–∏–º —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏—è–º –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –Ω–∞–ª–∏—á–∏–µ service worker.</p>

<p>Push-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è, –∫–æ–≥–¥–∞ —Å–µ—Ä–≤–µ—Ä –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –¥–ª—è service worker, –∞ service worker –∏—Å–ø–æ–ª—å–∑—É–µ—Ç API —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è —ç—Ç–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏.</p>

<p>–ú—ã –±—É–¥–µ–º –ø–æ–¥–ø–∏—Å—ã–≤–∞—Ç—å –Ω–∞—à–∏—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –Ω–∞ push-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è, –∞ –∑–∞—Ç–µ–º –±—É–¥–µ–º –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –∏–∑ –ø–æ–¥–ø–∏—Å–∫–∏ –Ω–∞ —Å–µ—Ä–≤–µ—Ä –¥–ª—è –∏—Ö —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏.</p>

<p>–í –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ <code>static</code> —Å–æ–∑–¥–∞–π—Ç–µ –ø–∞–ø–∫—É —Å –∏–º–µ–Ω–µ–º <code>js</code>:</p>
<pre class="code-pre custom_prefix"><code langs=""><ul class="prefixed"><li class="line" prefix="(my_env) $">mkdir ~/djangopush/static/js
</li></ul></code></pre>
<p>–°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª —Å –∏–º–µ–Ω–µ–º <code>registerSw.js</code>:</p>
<pre class="code-pre custom_prefix"><code langs=""><ul class="prefixed"><li class="line" prefix="(my_env) $">nano ~/djangopush/static/js/registerSw.js
</li></ul></code></pre>
<p>–î–æ–±–∞–≤—å—Ç–µ —Å–ª–µ–¥—É—é—â–∏–π –∫–æ–¥, –∫–æ—Ç–æ—Ä—ã–π –ø—Ä–æ–≤–µ—Ä—è–µ—Ç, –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –ª–∏ service worker'—ã –≤ –±—Ä–∞—É–∑–µ—Ä–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è, –ø—Ä–µ–∂–¥–µ —á–µ–º –ø—ã—Ç–∞—Ç—å—Å—è —Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å service worker:</p>
<div class="code-label " title="~/djangopush/static/js/registerSw.js">~/djangopush/static/js/registerSw.js</div><pre class="code-pre "><code class="code-highlight language-javascript">
const registerSw = async () =&gt; {
    if ('serviceWorker' in navigator) {
        const reg = await navigator.serviceWorker.register('sw.js');
        initialiseState(reg)

    } else {
        showNotAllowed("You can't send push notifications ‚òπÔ∏èüò¢")
    }
};
</code></pre>
<p>–í–æ-–ø–µ—Ä–≤—ã—Ö, —Ñ—É–Ω–∫—Ü–∏—è <code>registerSw</code> –ø—Ä–æ–≤–µ—Ä—è–µ—Ç, –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –ª–∏ –±—Ä–∞—É–∑–µ—Ä service worker'—ã, –ø—Ä–µ–∂–¥–µ —á–µ–º —Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å –∏—Ö. –ü–æ—Å–ª–µ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –æ–Ω–∞ –≤—ã–∑—ã–≤–∞–µ—Ç —Ñ—É–Ω–∫—Ü–∏—é <code>initializeState</code> —Å –¥–∞–Ω–Ω—ã–º–∏ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏. –ï—Å–ª–∏ service worker'—ã –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç—Å—è –≤ –±—Ä–∞—É–∑–µ—Ä–µ, –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è —Ñ—É–Ω–∫—Ü–∏—è <code>showNotAllowed</code>.</p>

<p>–î–∞–ª–µ–µ –¥–æ–±–∞–≤—å—Ç–µ —Å–ª–µ–¥—É—é—â–∏–π –∫–æ–¥ –ø–æ–¥ —Ñ—É–Ω–∫—Ü–∏–µ–π <code>registerSw</code> –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ç–æ–≥–æ, –º–æ–∂–µ—Ç –ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø–æ–ª—É—á–∞—Ç—å push-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è, –ø—Ä–µ–∂–¥–µ —á–µ–º –ø—ã—Ç–∞—Ç—å—Å—è –ø–æ–¥–ø–∏—Å–∞—Ç—å –∏—Ö:</p>
<div class="code-label " title="~/djangopush/static/js/registerSw.js">~/djangopush/static/js/registerSw.js</div><pre class="code-pre "><code class="code-highlight language-javascript">
...

const initialiseState = (reg) =&gt; {
    if (!reg.showNotification) {
        showNotAllowed('Showing notifications isn\'t supported ‚òπÔ∏èüò¢');
        return
    }
    if (Notification.permission === 'denied') {
        showNotAllowed('You prevented us from showing notifications ‚òπÔ∏èü§î');
        return
    }
    if (!'PushManager' in window) {
        showNotAllowed("Push isn't allowed in your browser ü§î");
        return
    }
    subscribe(reg);
}

const showNotAllowed = (message) =&gt; {
    const button = document.querySelector('form&gt;button');
    button.innerHTML = `${message}`;
    button.setAttribute('disabled', 'true');
};
</code></pre>
<p>–§—É–Ω–∫—Ü–∏—è <code>initializeState</code> –ø—Ä–æ–≤–µ—Ä—è–µ—Ç —Å–ª–µ–¥—É—é—â–µ–µ:</p>

<ul>
<li>–ê–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–ª –ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –∏–ª–∏ –Ω–µ—Ç, –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è <code>reg.showNotification</code>.</li>
<li>–ü—Ä–µ–¥–æ—Å—Ç–∞–≤–∏–ª –ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—é —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–µ –Ω–∞ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –∏–ª–∏ –Ω–µ—Ç.</li>
<li>–ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –ª–∏ –±—Ä–∞—É–∑–µ—Ä API <code>PushManager</code> –∏–ª–∏ –Ω–µ—Ç. –ï—Å–ª–∏ –∫–∞–∫–∞—è-–ª–∏–±–æ –∏–∑ —ç—Ç–∏—Ö –ø—Ä–æ–≤–µ—Ä–æ–∫ –Ω–µ –±—É–¥–µ—Ç –ø—Ä–æ–π–¥–µ–Ω–∞, —Ñ—É–Ω–∫—Ü–∏—è <code>showNotAllowed</code> –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è, –∞ –ø–æ–¥–ø–∏—Å–∫–∞ –æ—Ç–º–µ–Ω—è–µ—Ç—Å—è.</li>
</ul>

<p>–§—É–Ω–∫—Ü–∏—è <code>showNotAllowed</code> –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ –Ω–∞ –∫–Ω–æ–ø–∫–µ –∏ –æ—Ç–∫–ª—é—á–∞–µ—Ç –µ–≥–æ, –µ—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –∏–º–µ–µ—Ç –ø—Ä–∞–≤–∞ –ø—Ä–∏–Ω–∏–º–∞—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è. –¢–∞–∫–∂–µ –æ–Ω–∞ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–µ —Å–æ–æ–±—â–µ–Ω–∏—è, –µ—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –æ–≥—Ä–∞–Ω–∏—á–∏–ª –¥–ª—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π, –ª–∏–±–æ –µ—Å–ª–∏ –±—Ä–∞—É–∑–µ—Ä –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç push-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è.</p>

<p>–ü–æ—Å–ª–µ —Ç–æ–≥–æ –∫–∞–∫ –º—ã —É–±–µ–¥–∏–º—Å—è, —á—Ç–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –º–æ–∂–µ—Ç –ø–æ–ª—É—á–∞—Ç—å push-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è, —Å–ª–µ–¥—É—é—â–∏–º —à–∞–≥–æ–º –±—É–¥–µ—Ç –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏—è –ø–æ–¥–ø–∏—Å–∫–∏ –Ω–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è —Å –ø–æ–º–æ—â—å—é –∫–æ–º–∞–Ω–¥—ã <code>pushManager</code>. –î–æ–±–∞–≤—å—Ç–µ —Å–ª–µ–¥—É—é—â–∏–π –∫–æ–¥ –ø–æ–¥ —Ñ—É–Ω–∫—Ü–∏–µ–π <code>showNotAllowed</code>:</p>
<div class="code-label " title="~/djangopush/static/js/registerSw.js">~/djangopush/static/js/registerSw.js</div><pre class="code-pre "><code class="code-highlight language-javascript">
...

function urlB64ToUint8Array(base64String) {
    const padding = '='.repeat((4 - base64String.length % 4) % 4);
    const base64 = (base64String + padding)
        .replace(/\-/g, '+')
        .replace(/_/g, '/');

    const rawData = window.atob(base64);
    const outputArray = new Uint8Array(rawData.length);
    const outputData = outputArray.map((output, index) =&gt; rawData.charCodeAt(index));

    return outputData;
}

const subscribe = async (reg) =&gt; {
    const subscription = await reg.pushManager.getSubscription();
    if (subscription) {
        sendSubData(subscription);
        return;
    }

    const vapidMeta = document.querySelector('meta[name="vapid-key"]');
    const key = vapidMeta.content;
    const options = {
        userVisibleOnly: true,
        // if key exists, create applicationServerKey property
        ...(key &amp;&amp; {applicationServerKey: urlB64ToUint8Array(key)})
    };

    const sub = await reg.pushManager.subscribe(options);
    sendSubData(sub)
};
</code></pre>
<p>–í—ã–∑–æ–≤ —Ñ—É–Ω–∫—Ü–∏–∏ <code>pushManager.getSubscription</code> –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ –¥–ª—è –∞–∫—Ç–∏–≤–Ω–æ–π –ø–æ–¥–ø–∏—Å–∫–∏. –ü—Ä–∏ –Ω–∞–ª–∏—á–∏–∏ –∞–∫—Ç–∏–≤–Ω–æ–π –ø–æ–¥–ø–∏—Å–∫–∏ —Ñ—É–Ω–∫—Ü–∏—è <code>sendSubData</code> –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è, –∞ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –ø–æ–¥–ø–∏—Å–∫–∏ –ø–µ—Ä–µ–¥–∞–µ—Ç—Å—è –≤ –∫–∞—á–µ—Å—Ç–≤–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞.</p>

<p>–ü—Ä–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–∏ –∞–∫—Ç–∏–≤–Ω–æ–π –ø–æ–¥–ø–∏—Å–∫–∏ –ø—É–±–ª–∏—á–Ω—ã–π –∫–ª—é—á VAPID, –∫–æ—Ç–æ—Ä—ã–π —à–∏—Ñ—Ä—É–µ—Ç—Å—è —Å –ø–æ–º–æ—â—å—é –∞–ª–≥–æ—Ä–∏—Ç–º–∞ Base64, –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤—ã–≤–∞–µ—Ç—Å—è –≤ Uint8Array —Å –ø–æ–º–æ—â—å—é —Ñ—É–Ω–∫—Ü–∏–∏ <code>urlB64TUint8Array</code>. –ó–∞—Ç–µ–º –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è —Ñ—É–Ω–∫—Ü–∏—è <code>pushManager.subscribe</code> —Å –ø—É–±–ª–∏—á–Ω—ã–º –∫–ª—é—á–æ–º VAPID –∏ –∑–Ω–∞—á–µ–Ω–∏–µ–º <code>userVisible</code> –≤ –∫–∞—á–µ—Å—Ç–≤–µ –æ–ø—Ü–∏–∏. –í—ã –º–æ–∂–µ—Ç–µ –æ–∑–Ω–∞–∫–æ–º–∏—Ç—å—Å—è —Å –¥–æ—Å—Ç—É–ø–Ω—ã–º–∏ –æ–ø—Ü–∏—è–º–∏ <a href="https://developers.google.com/web/fundamentals/push-notifications/subscribing-a-user#uservisibleonly_options">–∑–¥–µ—Å—å</a>.</p>

<p>–ü–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–π –ø–æ–¥–ø–∏—Å–∫–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —Å–ª–µ–¥—É—é—â–∏–º —à–∞–≥–æ–º –±—É–¥–µ—Ç –æ—Ç–ø—Ä–∞–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö –ø–æ–¥–ø–∏—Å–∫–∏ –Ω–∞ —Å–µ—Ä–≤–µ—Ä. –≠—Ç–∏ –¥–∞–Ω–Ω—ã–µ –±—É–¥—É—Ç –Ω–∞–ø—Ä–∞–≤–ª—è—Ç—å—Å—è –Ω–∞ –∫–æ–Ω–µ—á–Ω—É—é —Ç–æ—á–∫—É <code>webpush/save_information</code>, –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª–µ–Ω–Ω—É—é –ø–∞–∫–µ—Ç–æ–º <code>django-webpush</code>. –î–æ–±–∞–≤—å—Ç–µ —Å–ª–µ–¥—É—é—â–∏–π –∫–æ–¥ –ø–æ–¥ —Ñ—É–Ω–∫—Ü–∏–µ–π <code>subscribe:</code></p>
<div class="code-label " title="~/djangopush/static/js/registerSw.js">~/djangopush/static/js/registerSw.js</div><pre class="code-pre "><code class="code-highlight language-javascript">
...

const sendSubData = async (subscription) =&gt; {
    const browser = navigator.userAgent.match(/(firefox|msie|chrome|safari|trident)/ig)[0].toLowerCase();
    const data = {
        status_type: 'subscribe',
        subscription: subscription.toJSON(),
        browser: browser,
    };

    const res = await fetch('/webpush/save_information', {
        method: 'POST',
        body: JSON.stringify(data),
        headers: {
            'content-type': 'application/json'
        },
        credentials: "include"
    });

    handleResponse(res);
};

const handleResponse = (res) =&gt; {
    console.log(res.status);
};

registerSw();
</code></pre>
<p>–ö–æ–Ω–µ—á–Ω–æ–π —Ç–æ—á–∫–µ <code>save_information</code> —Ç—Ä–µ–±—É–µ—Ç—Å—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Å–æ—Å—Ç–æ—è–Ω–∏–∏ –ø–æ–¥–ø–∏—Å–∫–∏ (<code>subscribe</code> –∏ <code>unsubscribe</code>), –¥–∞–Ω–Ω—ã–µ –ø–æ–¥–ø–∏—Å–∫–∏ –∏ –±—Ä–∞—É–∑–µ—Ä. –ù–∞–∫–æ–Ω–µ—Ü, –º—ã –≤—ã–∑—ã–≤–∞–µ–º —Ñ—É–Ω–∫—Ü–∏—é <code>registerSw()</code> –¥–ª—è –∑–∞–ø—É—Å–∫–∞ –ø—Ä–æ—Ü–µ—Å—Å–∞ –ø–æ–¥–ø–∏—Å–∫–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.</p>

<p>–ó–∞–≤–µ—Ä—à–µ–Ω–Ω—ã–π —Ñ–∞–π–ª –≤—ã–≥–ª—è–¥–∏—Ç —Å–ª–µ–¥—É—é—â–∏–º –æ–±—Ä–∞–∑–æ–º:</p>
<div class="code-label " title="~/djangopush/static/js/registerSw.js">~/djangopush/static/js/registerSw.js</div><pre class="code-pre "><code class="code-highlight language-javascript">
const registerSw = async () =&gt; {
    if ('serviceWorker' in navigator) {
        const reg = await navigator.serviceWorker.register('sw.js');
        initialiseState(reg)

    } else {
        showNotAllowed("You can't send push notifications ‚òπÔ∏èüò¢")
    }
};

const initialiseState = (reg) =&gt; {
    if (!reg.showNotification) {
        showNotAllowed('Showing notifications isn\'t supported ‚òπÔ∏èüò¢');
        return
    }
    if (Notification.permission === 'denied') {
        showNotAllowed('You prevented us from showing notifications ‚òπÔ∏èü§î');
        return
    }
    if (!'PushManager' in window) {
        showNotAllowed("Push isn't allowed in your browser ü§î");
        return
    }
    subscribe(reg);
}

const showNotAllowed = (message) =&gt; {
    const button = document.querySelector('form&gt;button');
    button.innerHTML = `${message}`;
    button.setAttribute('disabled', 'true');
};

function urlB64ToUint8Array(base64String) {
    const padding = '='.repeat((4 - base64String.length % 4) % 4);
    const base64 = (base64String + padding)
        .replace(/\-/g, '+')
        .replace(/_/g, '/');

    const rawData = window.atob(base64);
    const outputArray = new Uint8Array(rawData.length);
    const outputData = outputArray.map((output, index) =&gt; rawData.charCodeAt(index));

    return outputData;
}

const subscribe = async (reg) =&gt; {
    const subscription = await reg.pushManager.getSubscription();
    if (subscription) {
        sendSubData(subscription);
        return;
    }

    const vapidMeta = document.querySelector('meta[name="vapid-key"]');
    const key = vapidMeta.content;
    const options = {
        userVisibleOnly: true,
        // if key exists, create applicationServerKey property
        ...(key &amp;&amp; {applicationServerKey: urlB64ToUint8Array(key)})
    };

    const sub = await reg.pushManager.subscribe(options);
    sendSubData(sub)
};

const sendSubData = async (subscription) =&gt; {
    const browser = navigator.userAgent.match(/(firefox|msie|chrome|safari|trident)/ig)[0].toLowerCase();
    const data = {
        status_type: 'subscribe',
        subscription: subscription.toJSON(),
        browser: browser,
    };

    const res = await fetch('/webpush/save_information', {
        method: 'POST',
        body: JSON.stringify(data),
        headers: {
            'content-type': 'application/json'
        },
        credentials: "include"
    });

    handleResponse(res);
};

const handleResponse = (res) =&gt; {
    console.log(res.status);
};

registerSw();
</code></pre>
<p>–î–∞–ª–µ–µ –¥–æ–±–∞–≤—å—Ç–µ —Ç–µ–≥ <code>script</code> –¥–ª—è —Ñ–∞–π–ª–∞ <code>registerSw.js</code> –≤ <code>home.html</code>. –û—Ç–∫—Ä–æ–π—Ç–µ —Ñ–∞–π–ª:</p>
<pre class="code-pre custom_prefix"><code langs=""><ul class="prefixed"><li class="line" prefix="(my_env) $">nano ~/djangopush/templates/home.html
</li></ul></code></pre>
<p>–î–æ–±–∞–≤—å—Ç–µ —Ç–µ–≥ <code>script</code> –ø–µ—Ä–µ–¥ –∑–∞–∫—Ä—ã–≤–∞—é—â–∏–º —Ç–µ–≥–æ–º —ç–ª–µ–º–µ–Ω—Ç–∞ <code>body</code>:</p>
<div class="code-label " title="~/djangopush/templates/home.html">~/djangopush/templates/home.html</div><pre class="code-pre "><code class="code-highlight language-html">
{% load static %}
&lt;!DOCTYPE html&gt;
&lt;html lang="en"&gt;

&lt;head&gt;
   ...
&lt;/head&gt;
&lt;body&gt;
   ...
   <span class="highlight">&lt;script src="{% static '/js/registerSw.js' %}"&gt;&lt;/script&gt;</span>
&lt;/body&gt;
&lt;/html&gt;
</code></pre>
<p>–ü–æ—Å–∫–æ–ª—å–∫—É service worker –µ—â–µ –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç, –µ—Å–ª–∏ –±—ã –≤—ã –æ—Å—Ç–∞–≤–∏–ª–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∑–∞–ø—É—â–µ–Ω–Ω—ã–º –∏–ª–∏ –ø–æ–ø—ã—Ç–∞–ª–∏—Å—å –∑–∞–ø—É—Å—Ç–∏—Ç—å –µ–≥–æ —Å–Ω–æ–≤–∞, —Ç–æ —É–≤–∏–¥–µ–ª–∏ –±—ã —Å–æ–æ–±—â–µ–Ω–∏–µ –æ–± –æ—à–∏–±–∫–µ. –î–∞–≤–∞–π—Ç–µ —É—Å—Ç—Ä–∞–Ω–∏–º —ç—Ç—É –ø—Ä–æ–±–ª–µ–º—É —Å –ø–æ–º–æ—â—å—é service worker.</p>

<h2 id="–®–∞–≥-8-‚Äî-–°–æ–∑–¥–∞–Ω–∏–µ-service-worker">–®–∞–≥ 8 ‚Äî –°–æ–∑–¥–∞–Ω–∏–µ service worker</h2>

<p>–î–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è push-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –≤–∞–º –ø–æ—Ç—Ä–µ–±—É–µ—Ç—Å—è –∞–∫—Ç–∏–≤–Ω—ã–π service worker, —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–π –Ω–∞ –¥–æ–º–∞—à–Ω–µ–π —Å—Ç—Ä–∞–Ω–∏—Ü–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è. –ú—ã —Å–æ–∑–¥–∞–¥–∏–º service worker, –∫–æ—Ç–æ—Ä—ã–π –ø—Ä–æ—Å–ª—É—à–∏–≤–∞–µ—Ç —Å–æ–±—ã—Ç–∏—è <code>push</code> –∏ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏—è –ø—Ä–∏ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏.</p>

<p>–ü–æ—Å–∫–æ–ª—å–∫—É –º—ã —Ö–æ—Ç–∏–º, —á—Ç–æ–±—ã service worker –ø–æ–∫—Ä—ã–≤–∞–ª –≤–µ—Å—å –¥–æ–º–µ–Ω, –Ω–∞–º –Ω—É–∂–Ω–æ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –µ–≥–æ –≤ –∫–æ—Ä–Ω–µ–≤–æ–π –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è. –í —Å—Ç–∞—Ç—å–µ –æ <a href="https://developers.google.com/web/fundamentals/primers/service-workers/#register_a_service_worker">—Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ service worker</a> –≤—ã –º–æ–∂–µ—Ç–µ –ø–æ–¥—Ä–æ–±–Ω–µ–µ –æ–∑–Ω–∞–∫–æ–º–∏—Ç—å—Å—è —Å –ø—Ä–æ—Ü–µ—Å—Å–æ–º. –°–æ–≥–ª–∞—Å–Ω–æ –Ω–∞—à–µ–º—É –ø–æ–¥—Ö–æ–¥—É –±—É–¥–µ—Ç —Å–æ–∑–¥–∞–Ω —Ñ–∞–π–ª <code>sw.js</code> –≤ –ø–∞–ø–∫–µ <code>templates</code>, –∫–æ—Ç–æ—Ä—ã–π –º—ã –ø–æ–∑–¥–Ω–µ–µ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–µ–º –≤ –∫–∞—á–µ—Å—Ç–≤–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è.</p>

<p>–°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª:</p>
<pre class="code-pre custom_prefix"><code langs=""><ul class="prefixed"><li class="line" prefix="(my_env) $">nano ~/djangopush/templates/sw.js
</li></ul></code></pre>
<p>–î–æ–±–∞–≤—å—Ç–µ —Å–ª–µ–¥—É—é—â–∏–π –∫–æ–¥, –∫–æ—Ç–æ—Ä—ã–π —É–∫–∞–∑—ã–≤–∞–µ—Ç service worker –Ω–∞ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç—å –ø—Ä–æ—Å–ª—É—à–∏–≤–∞–Ω–∏—è push —Å–æ–±—ã—Ç–∏–π:</p>
<div class="code-label " title="~/djangopush/templates/sw.js">~/djangopush/templates/sw.js</div><pre class="code-pre "><code class="code-highlight language-javascript">
// Register event listener for the 'push' event.
self.addEventListener('push', function (event) {
    // Retrieve the textual payload from event.data (a PushMessageData object).
    // Other formats are supported (ArrayBuffer, Blob, JSON), check out the documentation
    // on https://developer.mozilla.org/en-US/docs/Web/API/PushMessageData.
    const eventInfo = event.data.text();
    const data = JSON.parse(eventInfo);
    const head = data.head || 'New Notification üï∫üï∫';
    const body = data.body || 'This is default content. Your notification didn\'t have one üôÑüôÑ';

    // Keep the service worker alive until the notification is created.
    event.waitUntil(
        self.registration.showNotification(head, {
            body: body,
            icon: 'https://i.imgur.com/MZM3K5w.png'
        })
    );
});
</code></pre>
<p>Service worker —Å–ª–µ–¥–∏—Ç –∑–∞ –Ω–∞–ª–∏—á–∏–µ–º push —Å–æ–±—ã—Ç–∏—è. –í —Ñ—É–Ω–∫—Ü–∏–∏ –æ–±—Ä–∞—Ç–Ω–æ–≥–æ –≤—ã–∑–æ–≤–∞ –¥–∞–Ω–Ω—ã–µ <code>—Å–æ–±—ã—Ç–∏—è</code> –∫–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É—é—Ç—Å—è –≤ —Ç–µ–∫—Å—Ç. –ú—ã –∏—Å–ø–æ–ª—å–∑—É–µ–º —Å—Ç—Ä–æ–∫–∏ <code>title</code> –∏ <code>body</code>, –µ—Å–ª–∏ –≤ –¥–∞–Ω–Ω—ã—Ö —Å–æ–±—ã—Ç–∏—è –æ–Ω–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç. –§—É–Ω–∫—Ü–∏—è <code>showNotification</code> –ø–æ–ª—É—á–∞–µ—Ç –Ω–∞–∑–≤–∞–Ω–∏–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è, –∑–∞–≥–æ–ª–æ–≤–æ–∫ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –∏ –æ–±—ä–µ–∫—Ç <a href="https://developers.google.com/web/fundamentals/push-notifications/display-a-notification#visual_options">options</a> –≤ –∫–∞—á–µ—Å—Ç–≤–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤. –û–±—ä–µ–∫—Ç options —Å–æ–¥–µ—Ä–∂–∏—Ç –Ω–µ—Å–∫–æ–ª—å–∫–æ —Å–≤–æ–π—Å—Ç–≤ –¥–ª—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –≤–∏–∑—É–∞–ª—å–Ω—ã—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è.</p>

<p>–ß—Ç–æ–±—ã service worker –º–æ–≥ —Ä–∞–±–æ—Ç–∞—Ç—å –¥–ª—è –≤—Å–µ–≥–æ –¥–æ–º–µ–Ω–∞, –≤–∞–º –ø–æ—Ç—Ä–µ–±—É–µ—Ç—Å—è –≤—ã–ø–æ–ª–Ω–∏—Ç—å –µ–≥–æ —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –≤ –∫–æ—Ä–Ω–µ–≤–æ–π –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è. –ú—ã –±—É–¥–µ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å <a href="https://docs.djangoproject.com/en/2.1/topics/class-based-views/"><code>TemplateView</code></a> –¥–ª—è –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª–µ–Ω–∏—è service worker –¥–æ—Å—Ç—É–ø–∞ –∫–æ –≤—Å–µ–º—É –¥–æ–º–µ–Ω—É.</p>

<p>–û—Ç–∫—Ä–æ–π—Ç–µ —Ñ–∞–π–ª <code>urls.py</code>:</p>
<pre class="code-pre custom_prefix"><code langs=""><ul class="prefixed"><li class="line" prefix="(my_env) $">nano ~/djangopush/djangopush/urls.py
</li></ul></code></pre>
<p>–î–æ–±–∞–≤—å—Ç–µ –Ω–æ–≤–æ–µ –æ–±—ä—è–≤–ª–µ–Ω–∏–µ –∏–º–ø–æ—Ä—Ç–∞ –∏ –ø—É—Ç—å –≤ —Å–ø–∏—Å–æ–∫ <code>urlpatterns</code> –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è –Ω–∞ –æ—Å–Ω–æ–≤–µ –∫–ª–∞—Å—Å–æ–≤:</p>
<div class="code-label " title="~/djangopush/djangopush/urls.py">~/djangopush/djangopush/urls.py</div><pre class="code-pre "><code class="code-highlight language-python">...
<span class="highlight">from django.views.generic import TemplateView</span>

urlpatterns = [
                  ...<span class="highlight">,</span>
                  <span class="highlight">path('sw.js', TemplateView.as_view(template_name='sw.js', content_type='application/x-javascript'))</span>
              ] + static(settings.STATIC_URL, document_root=settings.STATIC_ROOT)
</code></pre>
<p>–ü—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è –Ω–∞ –æ—Å–Ω–æ–≤–µ –∫–ª–∞—Å—Å–æ–≤, —Ç–∞–∫–∏–µ –∫–∞–∫ <code>TemplateView</code>, –ø–æ–∑–≤–æ–ª—è—é—Ç —Å–æ–∑–¥–∞–≤–∞—Ç—å –≥–∏–±–∫–∏–µ –∏ –¥–æ—Å—Ç—É–ø–Ω—ã–µ –¥–ª—è –ø–æ–≤—Ç–æ—Ä–Ω–æ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è. –í —ç—Ç–æ–º —Å–ª—É—á–∞–µ –º–µ—Ç–æ–¥ <code>TemplateView.as_view</code> —Å–æ–∑–¥–∞–µ—Ç –ø—É—Ç—å –¥–ª—è service worker, –ø–µ—Ä–µ–¥–∞–≤ –Ω–µ–¥–∞–≤–Ω–æ —Å–æ–∑–¥–∞–Ω–Ω—ã–π service worker –≤ –∫–∞—á–µ—Å—Ç–≤–µ —à–∞–±–ª–æ–Ω–∞ –∏ <code>application/x-javascript</code> –≤ –∫–∞—á–µ—Å—Ç–≤–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞ <code>content_type</code> –¥–ª—è —à–∞–±–ª–æ–Ω–∞.</p>

<p>–í—ã —É–∂–µ —Å–æ–∑–¥–∞–ª–∏ service worker –∏ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–ª–∏ –µ–≥–æ –≤ –∫–∞—á–µ—Å—Ç–≤–µ –º–∞—Ä—à—Ä—É—Ç–∞. –î–∞–ª–µ–µ –≤—ã –Ω–∞—Å—Ç—Ä–æ–∏—Ç–µ —Ñ–æ—Ä–º—É –Ω–∞ –¥–æ–º–∞—à–Ω–µ–π —Å—Ç—Ä–∞–Ω–∏—Ü–µ –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ push-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π.</p>

<h2 id="–®–∞–≥-9-‚Äî-–û—Ç–ø—Ä–∞–≤–∫–∞-push-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π">–®–∞–≥ 9 ‚Äî –û—Ç–ø—Ä–∞–≤–∫–∞ push-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π</h2>

<p>–ò—Å–ø–æ–ª—å–∑—É—è —Ñ–æ—Ä–º—É –Ω–∞ –¥–æ–º–∞—à–Ω–µ–π —Å—Ç—Ä–∞–Ω–∏—Ü–µ, –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ —Å–º–æ–≥—É—Ç –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å push-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è, –ø–æ–∫–∞ –≤–∞—à —Å–µ—Ä–≤–µ—Ä –∑–∞–ø—É—â–µ–Ω. –¢–∞–∫–∂–µ –≤—ã –º–æ–∂–µ—Ç–µ –æ—Ç–ø—Ä–∞–≤–∏—Ç—å push-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è —Å –ø–æ–º–æ—â—å—é –ª—é–±–æ–π —Å–ª—É–∂–±—ã RESTful, –Ω–∞–ø—Ä–∏–º–µ—Ä, Postman. –ö–æ–≥–¥–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç push-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –∏–∑ —Ñ–æ—Ä–º—ã –Ω–∞ –¥–æ–º–∞—à–Ω–µ–π —Å—Ç—Ä–∞–Ω–∏—Ü–µ, –¥–∞–Ω–Ω—ã–µ –±—É–¥—É—Ç –≤–∫–ª—é—á–∞—Ç—å <code>head</code> –∏ <code>body</code>, –∞ —Ç–∞–∫–∂–µ <code>id</code> –ø–æ–ª—É—á–∞—Ç–µ–ª—è. –î–∞–Ω–Ω—ã–µ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω—ã —Å–ª–µ–¥—É—é—â–∏–º –æ–±—Ä–∞–∑–æ–º:</p>
<pre class="code-pre "><code class="code-highlight language-javascript">{
    head: "Title of the notification",
    body: "Notification body",
    id: "User's id"
}
</code></pre>
<p>–î–ª—è –ø—Ä–æ—Å–ª—É—à–∏–≤–∞–Ω–∏—è —Å–æ–±—ã—Ç–∏—è <code>submit</code> —Ñ–æ—Ä–º—ã –∏ –æ—Ç–ø—Ä–∞–≤–∫–∏ –¥–∞–Ω–Ω—ã—Ö, –∫–æ—Ç–æ—Ä—ã–µ –≤–≤–æ–¥–∏—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å, –Ω–∞ —Å–µ—Ä–≤–µ—Ä, –º—ã —Å–æ–∑–¥–∞–¥–∏–º —Ñ–∞–π–ª <code>site.js</code> –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ <code>~/djangopush/static/js</code>.</p>

<p>–û—Ç–∫—Ä–æ–π—Ç–µ —Ñ–∞–π–ª:</p>
<pre class="code-pre custom_prefix"><code langs=""><ul class="prefixed"><li class="line" prefix="(my_env) $">nano ~/djangopush/static/js/site.js
</li></ul></code></pre>
<p>–í–æ-–ø–µ—Ä–≤—ã—Ö, –¥–æ–±–∞–≤—å—Ç–µ –ø—Ä–æ—Å–ª—É—à–∏–≤–∞—Ç–µ–ª—è —Å–æ–±—ã—Ç–∏–π <code>submit</code> –≤ —Ñ–æ—Ä–º—É, —á—Ç–æ –ø–æ–∑–≤–æ–ª–∏—Ç –ø–æ–ª—É—á–∏—Ç—å –∑–Ω–∞—á–µ–Ω–∏—è –¥–ª—è –≤–≤–æ–¥–∏–º—ã—Ö –¥–∞–Ω–Ω—ã—Ö –≤ —Ñ–æ—Ä–º–µ –∏ –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è, –∫–æ—Ç–æ—Ä—ã–π —Ö—Ä–∞–Ω–∏—Ç—Å—è –≤ —Ç–µ–≥–µ <code>meta</code> –≤–∞—à–µ–≥–æ —à–∞–±–ª–æ–Ω–∞:</p>
<div class="code-label " title="~/djangopush/static/js/site.js">~/djangopush/static/js/site.js</div><pre class="code-pre "><code class="code-highlight language-javascript">
const pushForm = document.getElementById('send-push__form');
const errorMsg = document.querySelector('.error');

pushForm.addEventListener('submit', async function (e) {
    e.preventDefault();
    const input = this[0];
    const textarea = this[1];
    const button = this[2];
    errorMsg.innerText = '';

    const head = input.value;
    const body = textarea.value;
    const meta = document.querySelector('meta[name="user_id"]');
    const id = meta ? meta.content : null;
    ...
    // TODO: make an AJAX request to send notification
});
</code></pre>
<p>–§—É–Ω–∫—Ü–∏—è <code>pushForm</code> –ø–æ–ª—É—á–∞–µ—Ç <code>input</code>,  <code>textarea</code> –∏ <code>button</code> –≤–Ω—É—Ç—Ä–∏ —Ñ–æ—Ä–º—ã. –¢–∞–∫–∂–µ –æ–Ω–∞ –ø–æ–ª—É—á–∞–µ—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –∏–∑ —Ç–µ–≥–∞ <code>meta</code>, –≤–∫–ª—é—á–∞—è –∞—Ç—Ä–∏–±—É—Ç <code>user_id</code> –∏ –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è, –∫–æ—Ç–æ—Ä—ã–π —Ö—Ä–∞–Ω–∏—Ç—Å—è –≤ –∞—Ç—Ä–∏–±—É—Ç–µ <code>content</code> —Ç–µ–≥–∞. –ü–æ–ª—É—á–∏–≤ —ç—Ç—É –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é, –æ–Ω–∞ –º–æ–∂–µ—Ç –æ—Ç–ø—Ä–∞–≤–∏—Ç—å –∑–∞–ø—Ä–æ—Å POST –Ω–∞ –∫–æ–Ω–µ—á–Ω—É—é —Ç–æ—á–∫—É <code>/send_push</code> –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ.</p>

<p>–î–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ –∑–∞–ø—Ä–æ—Å–æ–≤ –Ω–∞ —Å–µ—Ä–≤–µ—Ä –º—ã –±—É–¥–µ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –Ω–∞—Ç–∏–≤–Ω—É—é API <a href="https://developer.mozilla.org/en/docs/Web/API/Fetch_API">Fetch</a>. –ú—ã –∏—Å–ø–æ–ª—å–∑—É–µ–º Fetch –∑–¥–µ—Å—å, –ø–æ—Å–∫–æ–ª—å–∫—É API –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–æ–º –±—Ä–∞—É–∑–µ—Ä–æ–≤ –∏ –Ω–µ —Ç—Ä–µ–±—É–µ—Ç –¥–ª—è —Ä–∞–±–æ—Ç—ã –≤–Ω–µ—à–Ω–∏—Ö –±–∏–±–ª–∏–æ—Ç–µ–∫. –ü–æ–¥ –¥–æ–±–∞–≤–ª–µ–Ω–Ω—ã–º —Ä–∞–Ω–µ–µ –∫–æ–¥–æ–º –æ–±–Ω–æ–≤–∏—Ç–µ —Ñ—É–Ω–∫—Ü–∏—é <code>pushForm</code> –¥–ª—è –≤–∫–ª—é—á–µ–Ω–∏—è –∫–æ–¥–∞ –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ –∑–∞–ø—Ä–æ—Å–æ–≤ AJAX:</p>
<div class="code-label " title="~/djangopush/static/js/site.js">~/djangopush/static/js/site.js</div><pre class="code-pre "><code class="code-highlight language-javascript">const pushForm = document.getElementById('send-push__form');
const errorMsg = document.querySelector('.error');

pushForm.addEventListener('submit', async function (e) {
     ...
    const id = meta ? meta.content : null;

     if (head &amp;&amp; body &amp;&amp; id) {
        button.innerText = 'Sending...';
        button.disabled = true;

        const res = await fetch('/send_push', {
            method: 'POST',
            body: JSON.stringify({head, body, id}),
            headers: {
                'content-type': 'application/json'
            }
        });
        if (res.status === 200) {
            button.innerText = 'Send another üòÉ!';
            button.disabled = false;
            input.value = '';
            textarea.value = '';
        } else {
            errorMsg.innerText = res.message;
            button.innerText = 'Something broke üò¢..  Try again?';
            button.disabled = false;
        }
    }
    else {
        let error;
        if (!head || !body){
            error = 'Please ensure you complete the form üôèüèæ'
        }
        else if (!id){
            error = "Are you sure you're logged in? ü§î. Make sure! üëçüèº"
        }
        errorMsg.innerText = error;
    }
});
</code></pre>
<p>–ï—Å–ª–∏ —Ç—Ä–∏ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–∞ <code>head,</code> <code>body</code> –∏ <code>id</code> –ø—Ä–∏—Å—É—Ç—Å—Ç–≤—É—é—Ç, –º—ã –æ—Ç–ø—Ä–∞–≤–∏–º –∑–∞–ø—Ä–æ—Å –∏ –≤—Ä–µ–º–µ–Ω–Ω–æ –æ—Ç–∫–ª—é—á–∏–º –∫–Ω–æ–ø–∫—É submit.</p>

<p>–ó–∞–≤–µ—Ä—à–µ–Ω–Ω—ã–π —Ñ–∞–π–ª –≤—ã–≥–ª—è–¥–∏—Ç —Å–ª–µ–¥—É—é—â–∏–º –æ–±—Ä–∞–∑–æ–º:</p>
<div class="code-label " title="~/djangopush/static/js/site.js">~/djangopush/static/js/site.js</div><pre class="code-pre "><code class="code-highlight language-javascript">const pushForm = document.getElementById('send-push__form');
const errorMsg = document.querySelector('.error');

pushForm.addEventListener('submit', async function (e) {
    e.preventDefault();
    const input = this[0];
    const textarea = this[1];
    const button = this[2];
    errorMsg.innerText = '';

    const head = input.value;
    const body = textarea.value;
    const meta = document.querySelector('meta[name="user_id"]');
    const id = meta ? meta.content : null;

    if (head &amp;&amp; body &amp;&amp; id) {
        button.innerText = 'Sending...';
        button.disabled = true;

        const res = await fetch('/send_push', {
            method: 'POST',
            body: JSON.stringify({head, body, id}),
            headers: {
                'content-type': 'application/json'
            }
        });
        if (res.status === 200) {
            button.innerText = 'Send another üòÉ!';
            button.disabled = false;
            input.value = '';
            textarea.value = '';
        } else {
            errorMsg.innerText = res.message;
            button.innerText = 'Something broke üò¢..  Try again?';
            button.disabled = false;
        }
    }
    else {
        let error;
        if (!head || !body){
            error = 'Please ensure you complete the form üôèüèæ'
        }
        else if (!id){
            error = "Are you sure you're logged in? ü§î. Make sure! üëçüèº"
        }
        errorMsg.innerText = error;
    }    
});
</code></pre>
<p>–ü–æ—Å–ª–µ —ç—Ç–æ–≥–æ –æ—Å—Ç–∞–µ—Ç—Å—è –¥–æ–±–∞–≤–∏—Ç—å —Ñ–∞–π–ª <code>site.js</code> –≤ —Ñ–∞–π–ª <code>home.html</code>:</p>
<pre class="code-pre custom_prefix"><code langs=""><ul class="prefixed"><li class="line" prefix="(my_env) $">nano ~/djangopush/templates/home.html
</li></ul></code></pre>
<p>–î–æ–±–∞–≤—å—Ç–µ —Ç–µ–≥ <code>script</code>:</p>
<div class="code-label " title="~/djangopush/templates/home.html">~/djangopush/templates/home.html</div><pre class="code-pre "><code class="code-highlight language-html">
{% load static %}
&lt;!DOCTYPE html&gt;
&lt;html lang="en"&gt;

&lt;head&gt;
   ...
&lt;/head&gt;
&lt;body&gt;
   ...
   <span class="highlight">&lt;script src="{% static '/js/site.js' %}"&gt;&lt;/script&gt;</span>
&lt;/body&gt;
&lt;/html&gt;
</code></pre>
<p>–í –¥–∞–Ω–Ω—ã–π –º–æ–º–µ–Ω—Ç, –µ—Å–ª–∏ –≤—ã –æ—Å—Ç–∞–≤–∏–ª–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∑–∞–ø—É—â–µ–Ω–Ω—ã–º –∏–ª–∏ –ø–æ–ø—ã—Ç–∞–ª–∏—Å—å –∑–∞–ø—É—Å—Ç–∏—Ç—å –µ–≥–æ —Å–Ω–æ–≤–∞, —Ç–æ –ø–æ–ª—É—á–∏—Ç–µ –æ—à–∏–±–∫—É, –ø–æ—Å–∫–æ–ª—å–∫—É service workers –º–æ–∂–µ—Ç —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞—Ç—å —Ç–æ–ª—å–∫–æ –Ω–∞ –∑–∞—â–∏—â–µ–Ω–Ω—ã—Ö –¥–æ–º–µ–Ω–∞—Ö –∏–ª–∏ –≤ <code>localhost</code>: –ù–∞ —Å–ª–µ–¥—É—é—â–µ–º —à–∞–≥–µ –º—ã –±—É–¥–µ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å <a href="https://ngrok.com/">ngrok</a> –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –±–µ–∑–æ–ø–∞—Å–Ω–æ–≥–æ —Ç—É–Ω–Ω–µ–ª—è –Ω–∞ –Ω–∞—à–µ–º –≤–µ–±-—Å–µ—Ä–≤–µ—Ä–µ.</p>

<h2 id="–®–∞–≥-10-‚Äî-–°–æ–∑–¥–∞–Ω–∏–µ-–∑–∞—â–∏—â–µ–Ω–Ω–æ–≥–æ-—Ç—É–Ω–Ω–µ–ª—è-–¥–ª—è-—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è">–®–∞–≥ 10 ‚Äî –°–æ–∑–¥–∞–Ω–∏–µ –∑–∞—â–∏—â–µ–Ω–Ω–æ–≥–æ —Ç—É–Ω–Ω–µ–ª—è –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è</h2>

<p>Service worker'—ã —Ç—Ä–µ–±—É—é—Ç –Ω–∞–ª–∏—á–∏—è –∑–∞—â–∏—â–µ–Ω–Ω—ã—Ö —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π –¥–ª—è —Ä–∞–±–æ—Ç—ã –Ω–∞ –ª—é–±–æ–º —Å–∞–π—Ç–µ, –∫—Ä–æ–º–µ <code>localhost</code>, –ø–æ—Å–∫–æ–ª—å–∫—É –æ–Ω–∏ –Ω–µ –∑–∞—â–∏—â–µ–Ω—ã –æ—Ç –≤–∑–ª–æ–º–∞ –¥–ª—è –ø–æ—Å–ª–µ–¥—É—é—â–µ–π —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ –∏ –ø–æ–¥–º–µ–Ω—ã –æ—Ç–≤–µ—Ç–æ–≤. –ü–æ —ç—Ç–æ–π –ø—Ä–∏—á–∏–Ω–µ –º—ã —Å–æ–∑–¥–∞–¥–∏–º –∑–∞—â–∏—â–µ–Ω–Ω—ã–π —Ç—É–Ω–Ω–µ–ª—å –¥–ª—è –Ω–∞—à–µ–≥–æ —Å–µ—Ä–≤–µ—Ä–∞ —Å –ø–æ–º–æ—â—å—é <a href="https://ngrok.com">ngrok</a>.</p>

<p>–û—Ç–∫—Ä–æ–π—Ç–µ –≤—Ç–æ—Ä–æ–µ –æ–∫–Ω–æ –∫–æ–º–∞–Ω–¥–Ω–æ–π —Å—Ç—Ä–æ–∫–∏ –∏ —É–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤—ã –Ω–∞—Ö–æ–¥–∏—Ç–µ—Å—å –≤ –¥–æ–º–∞—à–Ω–µ–π –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏:</p>
<pre class="code-pre command second-environment"><code langs=""><ul class="prefixed"><li class="line" prefix="$">cd ~
</li></ul></code></pre>
<p>–ï—Å–ª–∏ –≤—ã –Ω–∞—á–∞–ª–∏ —Ä–∞–±–æ—Ç—É —Å —á–∏—Å—Ç—ã–º —Å–µ—Ä–≤–µ—Ä–æ–º –Ω–∞ –±–∞–∑–µ Ubuntu 18.04, –≤–∞–º –ø–æ—Ç—Ä–µ–±—É–µ—Ç—Å—è –≤—ã–ø–æ–ª–Ω–∏—Ç—å —É—Å—Ç–∞–Ω–æ–≤–∫—É <code>unzip</code>:</p>
<pre class="code-pre command second-environment"><code langs=""><ul class="prefixed"><li class="line" prefix="$">sudo apt update &amp;&amp; sudo apt install unzip
</li></ul></code></pre>
<p>–ó–∞–≥—Ä—É–∑–∏—Ç–µ ngrok:</p>
<pre class="code-pre command second-environment"><code langs=""><ul class="prefixed"><li class="line" prefix="$">wget https://bin.equinox.io/c/4VmDzA7iaHb/ngrok-stable-linux-amd64.zip
</li><li class="line" prefix="$">unzip ngrok-stable-linux-amd64.zip
</li></ul></code></pre>
<p>–ü–µ—Ä–µ–º–µ—Å—Ç–∏—Ç–µ <code>ngrok</code> –≤ <code>/usr/local/bin</code>, —á—Ç–æ–±—ã –ø–æ–ª—É—á–∏—Ç—å –¥–æ—Å—Ç—É–ø –∫ –∫–æ–º–∞–Ω–¥–µ <code>ngrok</code> –∏–∑ –∫–æ–º–∞–Ω–¥–Ω–æ–π —Å—Ç—Ä–æ–∫–∏:</p>
<pre class="code-pre command second-environment"><code langs=""><ul class="prefixed"><li class="line" prefix="$">sudo mv ngrok /usr/local/bin
</li></ul></code></pre>
<p>–í –ø–µ—Ä–≤–æ–º –æ–∫–Ω–µ –∫–æ–º–∞–Ω–¥–Ω–æ–π —Å—Ç—Ä–æ–∫–∏ —É–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤—ã –Ω–∞—Ö–æ–¥–∏—Ç–µ—Å—å –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ –ø—Ä–æ–µ–∫—Ç–∞ –∏ –∑–∞–ø—É—Å—Ç–∏—Ç–µ —Å–µ—Ä–≤–µ—Ä:</p>
<pre class="code-pre custom_prefix"><code langs=""><ul class="prefixed"><li class="line" prefix="(my_env) $">cd ~/djangopush
</li><li class="line" prefix="(my_env) $">python manage.py runserver <span class="highlight">your_server_ip</span>:8000
</li></ul></code></pre>
<p>–í—ã –¥–æ–ª–∂–Ω—ã –±—ã–ª–∏ —Å–¥–µ–ª–∞—Ç—å —ç—Ç–æ, –ø—Ä–µ–∂–¥–µ —á–µ–º —Å–æ–∑–¥–∞—Ç—å –∑–∞—â–∏—â–µ–Ω–Ω—ã–π —Ç—É–Ω–Ω–µ–ª—å –¥–ª—è –≤–∞—à–µ–≥–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è.</p>

<p>–í–æ –≤—Ç–æ—Ä–æ–º –æ–∫–Ω–µ –∫–æ–º–∞–Ω–¥–Ω–æ–π —Å—Ç—Ä–æ–∫–∏ –ø–µ—Ä–µ–π–¥–∏—Ç–µ –∫ –ø–∞–ø–∫–µ –ø—Ä–æ–µ–∫—Ç–∞ –∏ –∞–∫—Ç–∏–≤–∏—Ä—É–π—Ç–µ –≤–∏—Ä—Ç—É–∞–ª—å–Ω—É—é —Å—Ä–µ–¥—É:</p>
<pre class="code-pre command second-environment"><code langs=""><ul class="prefixed"><li class="line" prefix="$">cd ~/djangopush
</li><li class="line" prefix="$">source my_env/bin/activate
</li></ul></code></pre>
<p>–°–æ–∑–¥–∞–π—Ç–µ –∑–∞—â–∏—â–µ–Ω–Ω—ã–π —Ç—É–Ω–Ω–µ–ª—å –¥–ª—è –≤–∞—à–µ–≥–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è:</p>
<pre class="code-pre custom_prefix second-environment"><code langs=""><ul class="prefixed"><li class="line" prefix="(my_env) $">ngrok http <span class="highlight">your_server_ip</span>:8000
</li></ul></code></pre>
<p>–í—ã —É–≤–∏–¥–∏—Ç–µ —Å–ª–µ–¥—É—é—â–∏–π –≤—ã–≤–æ–¥, –∫–æ—Ç–æ—Ä—ã–π –≤–∫–ª—é—á–∞–µ—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –∑–∞—â–∏—â–µ–Ω–Ω–æ–º URL-–∞–¥—Ä–µ—Å–µ ngrok:</p>
<pre class="code-pre  second-environment"><code langs=""><div class="secondary-code-label " title="Output">Output</div>ngrok by <a href="https://www.digitalocean.com/community/users/inconshreveable" class="username-tag">@inconshreveable</a>                                                                                                                       (Ctrl+C to quit)

Session Status                online
Session Expires               7 hours, 59 minutes
Version                       2.2.8
Region                        United States (us)
Web Interface                 http://127.0.0.1:4040
Forwarding                    http://<span class="highlight">ngrok_secure_url</span> -&gt; 203.0.113.0:8000
Forwarding                    https://<span class="highlight">ngrok_secure_url</span> -&gt; 203.0.113.0:8000

Connections                   ttl     opn     rt1     rt5     p50     p90
                              0       0       0.00    0.00    0.00    0.00
</code></pre>
<p>–°–∫–æ–ø–∏—Ä—É–π—Ç–µ <code><span class="highlight">ngrok_secure_url</span></code> –∏–∑ –≤—ã–≤–æ–¥–∞ –∫–æ–Ω—Å–æ–ª–∏. –í—ã –¥–æ–ª–∂–Ω—ã –±—É–¥–µ—Ç–µ –¥–æ–±–∞–≤–∏—Ç—å –µ–≥–æ –≤ —Å–ø–∏—Å–æ–∫ <code>ALLOWED_HOSTS</code> –≤ —Ñ–∞–π–ª–µ <code>settings.py</code>.</p>

<p>–û—Ç–∫—Ä–æ–π—Ç–µ –¥—Ä—É–≥–æ–µ –æ–∫–Ω–æ –∫–æ–º–∞–Ω–¥–Ω–æ–π —Å—Ç—Ä–æ–∫–∏ –ø–µ—Ä–µ–π–¥–∏—Ç–µ –≤ –ø–∞–ø–∫—É –ø—Ä–æ–µ–∫—Ç–∞ –∏ –∞–∫—Ç–∏–≤–∏—Ä—É–π—Ç–µ –≤–∏—Ä—Ç—É–∞–ª—å–Ω—É—é —Å—Ä–µ–¥—É:</p>
<pre class="code-pre command third-environment"><code langs=""><ul class="prefixed"><li class="line" prefix="$">cd ~/djangopush
</li><li class="line" prefix="$">source my_env/bin/activate
</li></ul></code></pre>
<p>–û—Ç–∫—Ä–æ–π—Ç–µ —Ñ–∞–π–ª <code>settings.py</code>:</p>
<pre class="code-pre custom_prefix third-environment"><code langs=""><ul class="prefixed"><li class="line" prefix="(my_env) $">nano ~/djangopush/djangopush/settings.py
</li></ul></code></pre>
<p>–û–±–Ω–æ–≤–∏—Ç–µ —Å–ø–∏—Å–æ–∫ <code>ALLOWED_HOSTS</code> —Å –∑–∞—â–∏—â–µ–Ω–Ω—ã–º —Ç—É–Ω–Ω–µ–ª–µ–º ngrok:</p>
<div class="code-label " title="~/djangopush/djangopush/settings.py">~/djangopush/djangopush/settings.py</div><pre class="code-pre "><code class="code-highlight language-python">...

ALLOWED_HOSTS = ['your_server_ip', '<span class="highlight">ngrok_secure_url</span>']
...

</code></pre>
<p>–ü–µ—Ä–µ–π–¥–∏—Ç–µ –Ω–∞ –∑–∞—â–∏—â–µ–Ω–Ω—É—é —Å—Ç—Ä–∞–Ω–∏—Ü—É –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞ –¥–ª—è –≤—Ö–æ–¥–∞: <code>https://<span class="highlight">ngrok_secure_url</span>/admin/</code>. –í—ã —É–≤–∏–¥–∏—Ç–µ —ç–∫—Ä–∞–Ω, –∫–æ—Ç–æ—Ä—ã–π –±—É–¥–µ—Ç –≤—ã–≥–ª—è–¥–µ—Ç—å –ø—Ä–∏–º–µ—Ä–Ω–æ —Ç–∞–∫:</p>

<p><img src="https://assets.digitalocean.com/articles/django_push_18_04/ngrok_login.png" alt="–í—Ö–æ–¥ –¥–ª—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞ ngrok"></p>

<p>–í–≤–µ–¥–∏—Ç–µ –¥–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è Django —Å –ø—Ä–∞–≤–∞–º–∏ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞ –Ω–∞ —ç—Ç–æ–º —ç–∫—Ä–∞–Ω–µ. –≠—Ç–∞ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –¥–æ–ª–∂–Ω–∞ –ø–æ–≤—Ç–æ—Ä—è—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é, –∫–æ—Ç–æ—Ä—É—é –≤—ã –≤–≤–æ–¥–∏–ª–∏ –ø—Ä–∏ –≤—Ö–æ–¥–µ –≤ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞ –Ω–∞ —ç—Ç–∞–ø–µ <a href="https://www.digitalocean.com/community/tutorials/how-to-install-the-django-web-framework-on-ubuntu-18-04#testing-the-development-server">–ø—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–æ–π –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∏</a>. –¢–µ–ø–µ—Ä—å –≤—ã –≥–æ—Ç–æ–≤—ã –∫ –æ—Ç–ø—Ä–∞–≤–∫–µ push-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π.</p>

<p>–í–≤–µ–¥–∏—Ç–µ <code>https://<span class="highlight">ngrok_secure_url</span></code> –≤ –∞–¥—Ä–µ—Å–Ω–æ–π —Å—Ç—Ä–æ–∫–µ –±—Ä–∞—É–∑–µ—Ä–∞. –í—ã —É–≤–∏–¥–∏—Ç–µ –∑–∞–ø—Ä–æ—Å —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è –Ω–∞ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π. –ù–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É <strong>Allow (–†–∞–∑—Ä–µ—à–∏—Ç—å)</strong>, —á—Ç–æ–±—ã —Ä–∞–∑—Ä–µ—à–∏—Ç—å –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ push-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –≤ –±—Ä–∞—É–∑–µ—Ä–µ.</p>

<p><img src="https://assets.digitalocean.com/articles/django_push_18_04/allow_push_two.png" alt="–∑–∞–ø—Ä–æ—Å push-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π"></p>

<p>–û—Ç–ø—Ä–∞–≤–∫–∞ –∑–∞–ø–æ–ª–Ω–µ–Ω–Ω–æ–π —Ñ–æ—Ä–º—ã –±—É–¥–µ—Ç –æ—Ç–æ–±—Ä–∞–∂–∞—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –ø—Ä–∏–º–µ—Ä–Ω–æ —Å–ª–µ–¥—É—é—â–µ–≥–æ –≤–∏–¥–∞:</p>

<p><img src="https://assets.digitalocean.com/articles/django_push_18_04/web_push_final.png" alt="—Å–∫—Ä–∏–Ω—à–æ—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è"></p>

<p><span class='note'><strong>–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ</strong>: —É–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤–∞—à —Å–µ—Ä–≤–µ—Ä –∑–∞–ø—É—â–µ–Ω, –ø—Ä–µ–∂–¥–µ —á–µ–º –ø—ã—Ç–∞—Ç—å—Å—è –æ—Ç–ø—Ä–∞–≤–∏—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è.<br></span></p>

<p>–ï—Å–ª–∏ –≤—ã –ø–æ–ª—É—á–∏–ª–∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è, —ç—Ç–æ –∑–Ω–∞—á–∏—Ç, —á—Ç–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ.</p>

<p>–í—ã —Å–æ–∑–¥–∞–ª–∏ –≤–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è, –∫–æ—Ç–æ—Ä–æ–µ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç push-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ, –∏ —Å –ø–æ–º–æ—â—å—é service workers –ø–æ–ª—É—á–∞–µ—Ç –∏ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è. –¢–∞–∫–∂–µ –≤—ã –≤—ã–ø–æ–ª–Ω–∏–ª–∏ –¥–µ–π—Å—Ç–≤–∏—è –ø–æ –ø–æ–ª—É—á–µ–Ω–∏—é –∫–ª—é—á–µ–π VAPID, –∫–æ—Ç–æ—Ä—ã–µ —Ç—Ä–µ–±—É—é—Ç—Å—è –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ push-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π —Å —Å–µ—Ä–≤–µ—Ä–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è.</p>

<h2 id="–ó–∞–∫–ª—é—á–µ–Ω–∏–µ">–ó–∞–∫–ª—é—á–µ–Ω–∏–µ</h2>

<p>–í —ç—Ç–æ–º –æ–±—É—á–∞—é—â–µ–º —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–µ –≤—ã –Ω–∞—É—á–∏–ª–∏—Å—å –æ—Ñ–æ—Ä–º–ª—è—Ç—å –ø–æ–¥–ø–∏—Å–∫—É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è push-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π, —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—Ç—å service worker'—ã –∏ –æ—Ç–æ–±—Ä–∞–∂–∞—Ç—å push-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è —Å –ø–æ–º–æ—â—å—é API —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π.</p>

<p>–í—ã –º–æ–∂–µ—Ç–µ –ø–æ–π—Ç–∏ –¥–∞–ª—å—à–µ –∏ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –¥–ª—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã—Ö –æ–±–ª–∞—Å—Ç–µ–π –≤–∞—à–µ–≥–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –ø—Ä–∏ –Ω–∞–∂–∞—Ç–∏–∏. –ò—Å—Ö–æ–¥–Ω—ã–π –∫–æ–¥ –¥–ª—è –¥–∞–Ω–Ω–æ–≥–æ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–∞ –º–æ–∂–Ω–æ –Ω–∞–π—Ç–∏ <a href="https://github.com/HackAfro/django-push">–∑–¥–µ—Å—å</a>.</p>
