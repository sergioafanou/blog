---
layout: post
title: How To Set Up the code-server Cloud IDE Platform on DigitalOcean Kubernetes
network: digitalocean
date: July 12, 2019 at 08:53PM
url: https://www.digitalocean.com/community/tutorials/how-to-set-up-the-code-server-cloud-ide-platform-on-digitalocean-kubernetes
image: https://assets.digitalocean.com/articles/codeserver/step1a.png
tags: docker
feedtitle: DigitalOcean Community Tutorials
feedurl: https://www.digitalocean.com/community/tutorials
author: DigitalOcean
---
<p><em>The author selected the <a href="https://www.brightfunds.org/funds/foss-nonprofits">Free and Open Source Fund</a> to receive a donation as part of the <a href="https://do.co/w4do-cta">Write for DOnations</a> program.</em></p>

<h3 id="introduction">Introduction</h3>

<p>With developer tools moving to the cloud, creation and adoption of cloud IDE (Integrated Development Environment) platforms is growing. Cloud IDEs allow for real-time collaboration between developer teams to work in a unified development environment that minimizes incompatibilities and enhances productivity. Accessible through web browsers, cloud IDEs are available from every type of modern device. Another advantage of a cloud IDE is the possibility to leverage the power of a cluster, which can greatly exceed the processing power of a single development computer.</p>

<p><a href="https://github.com/cdr/code-server">code-server</a> is <a href="https://code.visualstudio.com/">Microsoft Visual Studio Code</a> running on a remote server and accessible directly from your browser. Visual Studio Code is a modern code editor with integrated Git support, a code debugger, smart autocompletion, and customizable and extensible features. This means that you can use various devices, running different operating systems, and always have a consistent development environment on hand.</p>

<p>In this tutorial, you will set up the code-server cloud IDE platform on your DigitalOcean Kubernetes cluster and expose it at your domain, secured with Let's Encrypt certificates. In the end, you'll have Microsoft Visual Studio Code running on your Kubernetes cluster, available via HTTPS and protected by a password.</p>

<h2 id="prerequisites">Prerequisites</h2>

<ul>
<li><p>A DigitalOcean Kubernetes cluster with your connection configured as the <code>kubectl</code> default. Instructions on how to configure <code>kubectl</code> are shown under the <strong>Connect to your Cluster</strong> step when you create your cluster. To create a Kubernetes cluster on DigitalOcean, see <a href="https://www.digitalocean.com/docs/kubernetes/quickstart/">Kubernetes Quickstart</a>.</p></li>
<li><p>The Helm package manager installed on your local machine, and Tiller installed on your cluster. To do this, complete Steps 1 and 2 of the <a href="https://www.digitalocean.com/community/tutorials/how-to-install-software-on-kubernetes-clusters-with-the-helm-package-manager">How To Install Software on Kubernetes Clusters with the Helm Package Manager</a> tutorial.</p></li>
<li><p>The Nginx Ingress Controller and Cert-Manager installed on your cluster using Helm in order to expose code-server using Ingress Resources. To do this, follow <a href="https://www.digitalocean.com/community/tutorials/how-to-set-up-an-nginx-ingress-on-digitalocean-kubernetes-using-helm">How to Set Up an Nginx Ingress on DigitalOcean Kubernetes Using Helm</a>.</p></li>
<li><p>A fully registered domain name to host code-server, pointed at the Load Balancer used by the Nginx Ingress. This tutorial will use <code><span class="highlight">code-server.your_domain</span></code> throughout. You can purchase a domain name on <a href="https://www.namecheap.com/">Namecheap</a>, get one for free on <a href="https://www.freenom.com/en/index.html?lang=en">Freenom</a>, or use the domain registrar of your choice. This domain name must differ from the one used in the How To Set Up an Nginx Ingress on DigitalOcean Kubernetes prerequisite tutorial.</p></li>
</ul>

<h2 id="step-1-—-installing-and-exposing-code-server">Step 1 — Installing And Exposing code-server</h2>

<p>In this section, you'll install code-server to your DigitalOcean Kubernetes cluster and expose it at your domain, using the Nginx Ingress controller. You will also set up a password for admittance.</p>

<p>You'll store the deployment configuration on your local machine, in a file named <code>code-server.yaml</code>. Create it using the following command:</p>
<pre class="code-pre command"><code langs=""><ul class="prefixed"><li class="line" prefix="$">nano code-server.yaml
</li></ul></code></pre>
<p>Add the following lines to the file:</p>
<div class="code-label " title="code-server.yaml">code-server.yaml</div><pre class="code-pre "><code langs="">apiVersion: v1
kind: Namespace
metadata:
  name: code-server
---
apiVersion: extensions/v1beta1
kind: Ingress
metadata:
  name: code-server
  namespace: code-server
  annotations:
    kubernetes.io/ingress.class: nginx
spec:
  rules:
  - host: <span class="highlight">code-server.your_domain</span>
    http:
      paths:
      - backend:
          serviceName: code-server
          servicePort: 80
---
apiVersion: v1
kind: Service
metadata:
 name: code-server
 namespace: code-server
spec:
 ports:
 - port: 80
   targetPort: 8443
 selector:
   app: code-server
---
apiVersion: extensions/v1beta1
kind: Deployment
metadata:
  labels:
    app: code-server
  name: code-server
  namespace: code-server
spec:
  selector:
    matchLabels:
      app: code-server
  replicas: 1
  template:
    metadata:
      labels:
        app: code-server
    spec:
      containers:
      - image: codercom/code-server
        imagePullPolicy: Always
        name: code-server
        args: ["--allow-http"]
        ports:
        - containerPort: 8443
        env:
        - name: PASSWORD
          value: "<span class="highlight">your_password</span>"
</code></pre>
<p>This configuration defines a Namespace, a Deployment, a Service, and an Ingress. The Namespace is called <code>code-server</code> and separates the code-server installation from the rest of your cluster. The Deployment consists of one replica of the <code>codercom/code-server</code> Docker image, and an environment variable named <code>PASSWORD</code> that specifies the password for access.</p>

<p>The <code>code-server</code> Service internally exposes the pod (created as a part of the Deployment) at port <code>80</code>. The Ingress defined in the file specifies that the Ingress Controller is <code>nginx</code>, and that the <code><span class="highlight">code-server.your_domain</span></code> domain will be served from the Service.</p>

<p>Remember to replace <code><span class="highlight">your_password</span></code> with your desired password, and <code><span class="highlight">code-server.your_domain</span></code> with your desired domain, pointed to the Load Balancer of the Nginx Ingress Controller.</p>

<p>Then, create the configuration in Kubernetes by running the following command:</p>
<pre class="code-pre command"><code langs=""><ul class="prefixed"><li class="line" prefix="$">kubectl create -f code-server.yaml
</li></ul></code></pre>
<p>You'll see the following output:</p>
<pre class="code-pre "><code langs=""><div class="secondary-code-label " title="Output">Output</div>namespace/code-server created
ingress.extensions/code-server created
service/code-server created
deployment.extensions/code-server created
</code></pre>
<p>You can watch the code-server pod become available by running:</p>
<pre class="code-pre command"><code langs=""><ul class="prefixed"><li class="line" prefix="$">kubectl get pods -w -n code-server
</li></ul></code></pre>
<p>The output will look like:</p>
<pre class="code-pre "><code langs=""><div class="secondary-code-label " title="Output">Output</div>NAME                          READY   STATUS              RESTARTS   AGE
code-server-f85d9bfc9-j7hq6   0/1     ContainerCreating   0          1m
</code></pre>
<p>As soon as the status becomes <code>Running</code>, code-server has finished installing to your cluster.</p>

<p>Navigate to your domain in your browser. You'll see the login prompt for code-server.</p>

<p><img src="https://assets.digitalocean.com/articles/codeserver/step1a.png" alt="code-server login prompt"></p>

<p>Enter the password you set in <code>code-server.yaml</code> and press <strong>Enter IDE</strong>. You'll enter code-server and immediately see its editor GUI.</p>

<p><img src="https://assets.digitalocean.com/articles/codeserver/step2a.png" alt="code-server GUI"></p>

<p>You've installed code-server to your Kubernetes cluster and made it available at your domain. You have also verified that it requires you to log in with a password. Now, you'll move on to secure it with free Let's Encrypt certificates using Cert-Manager.</p>

<h2 id="step-2-—-securing-the-code-server-deployment">Step 2 — Securing the code-server Deployment</h2>

<p>In this section, you will secure your code-server installation by applying Let's Encrypt certificates to your Ingress, which Cert-Manager will automatically create. After completing this step, your code-server installation will be accessible via HTTPS.</p>

<p>Open <code>code-server.yaml</code> for editing:</p>
<pre class="code-pre command"><code langs=""><ul class="prefixed"><li class="line" prefix="$">nano code-server.yaml
</li></ul></code></pre>
<p>Add the highlighted lines to your file, making sure to replace the example domain with your own:</p>
<div class="code-label " title="code-server.yaml">code-server.yaml</div><pre class="code-pre "><code langs="">apiVersion: v1
kind: Namespace
metadata:
  name: code-server
---
apiVersion: extensions/v1beta1
kind: Ingress
metadata:
  name: code-server
  namespace: code-server
  annotations:
    kubernetes.io/ingress.class: nginx
<span class="highlight">    certmanager.k8s.io/cluster-issuer: letsencrypt-prod</span>
spec:
<span class="highlight">  tls:</span>
<span class="highlight">  - hosts:</span>
<span class="highlight">    - code-server.your_domain</span>
<span class="highlight">    secretName: codeserver-prod</span>
  rules:
  - host: code-server.your_domain
    http:
      paths:
      - backend:
          serviceName: code-server
          servicePort: 80
...
</code></pre>
<p>First, you specify that the cluster-issuer that this Ingress will use to provision certificates will be <code>letsencrypt-prod</code>, created as a part of the prerequisites. Then, you specify the domains that will be secured under the <code>tls</code> section, as well as your name for the <code>Secret</code> holding them.</p>

<p>Apply the changes to your Kubernetes cluster by running the following command:</p>
<pre class="code-pre command"><code langs=""><ul class="prefixed"><li class="line" prefix="$">kubectl apply -f code-server.yaml
</li></ul></code></pre>
<p>You'll need to wait a few minutes for Let's Encrypt to provision your certificate. In the meantime, you can track its progress by looking at the output of the following command:</p>
<pre class="code-pre command"><code langs=""><ul class="prefixed"><li class="line" prefix="$">kubectl describe certificate codeserver-prod -n code-server
</li></ul></code></pre>
<p>When it finishes, the end of the output will look similar to this:</p>
<pre class="code-pre "><code langs=""><div class="secondary-code-label " title="Output">Output</div>Events:
  Type    Reason              Age    From          Message
  ----    ------              ----   ----          -------
  Normal  Generated           2m49s  cert-manager  Generated new private key
  Normal  GenerateSelfSigned  2m49s  cert-manager  Generated temporary self signed certificate
  Normal  OrderCreated        2m49s  cert-manager  Created Order resource "codeserver-prod-4279678953"
  Normal  OrderComplete       2m14s  cert-manager  Order "codeserver-prod-4279678953" completed successfully
  Normal  CertIssued          2m14s  cert-manager  Certificate issued successfully
</code></pre>
<p>You can now refresh your domain in your browser. You'll see the padlock to the left of the address bar in your browser signifying that the connection is secure.</p>

<p>In this step, you have configured the Ingress to secure your code-server deployment. Now, you can review the code-server user interface.</p>

<h2 id="step-3-—-exploring-the-code-server-interface">Step 3 — Exploring the code-server Interface</h2>

<p>In this section, you'll explore some of the features of the code-server interface. Since code-server is Visual Studio Code running in the cloud, it has the same interface as the standalone desktop edition.</p>

<p>On the left-hand side of the IDE, there is a vertical row of six buttons opening the most commonly used features in a side panel known as the Activity Bar.</p>

<p><img src="https://assets.digitalocean.com/articles/codeserver/step3a.png" alt="code-server GUI - Sidepanel"></p>

<p>This bar is customizable so you can move these views to a different order or remove them from the bar. By default, the first view opens the Explorer panel that provides tree-like navigation of the project's structure. You can manage your folders and files here—creating, deleting, moving, and renaming them as necessary. The next view provides access to a search and replace functionality.</p>

<p>Following this, in the default order, is your view of the source control systems, like <a href="https://git-scm.com/download">Git</a>. Visual Studio code also supports other source control providers and you can find further instructions for source control workflows with the editor in this <a href="https://code.visualstudio.com/docs/editor/versioncontrol">documentation</a>.</p>

<p><img src="https://assets.digitalocean.com/articles/codeserver/git.png" alt="Git dropdown menu with version control actions"></p>

<p>The debugger option on the Activity Bar provides all the common actions for debugging in the panel. Visual Studio Code comes with built-in support for the <a href="https://nodejs.org/">Node.js</a> runtime debugger and any language that transpiles to <a href="https://www.javascript.com/">Javascript</a>. For other languages you can install <a href="https://code.visualstudio.com/docs/editor/debugging#_debugger-extensions">extensions</a> for the required debugger. You can save debugging configurations in the <code>launch.json</code> file.</p>

<p><img src="https://assets.digitalocean.com/articles/codeserver/debugger.png" alt="Debugger View with launch.json open"></p>

<p>The final view in the Activity Bar provides a menu to access available extensions on the <a href="https://marketplace.visualstudio.com/VSCode">Marketplace</a>.</p>

<p><img src="https://assets.digitalocean.com/articles/codeserver/step3b.png" alt="code-server GUI - Tabs"></p>

<p>The central part of the GUI is your editor, which you can separate by tabs for your code editing. You can change your editing view to a grid system or to side-by-side files.</p>

<p><img src="https://assets.digitalocean.com/articles/codeserver/gridview.png" alt="Editor Grid View"></p>

<p>After creating a new file through the <strong>File</strong> menu, an empty file will open in a new tab, and once saved, the file's name will be viewable in the Explorer side panel. Creating folders can be done by right clicking on the Explorer sidebar and pressing on <strong>New Folder</strong>. You can expand a folder by clicking on its name as well as dragging and dropping files and folders to upper parts of the hierarchy to move them to a new location.</p>

<p><img src="https://assets.digitalocean.com/articles/codeserver/step3c.png" alt="code-server GUI - New Folder"></p>

<p>You can gain access to a terminal by pressing <code>CTRL+SHIFT+\</code>, or by pressing on <strong>Terminal</strong> in the upper menu, and selecting <strong>New Terminal</strong>. The terminal will open in a lower panel and its working directory will be set to the project's workspace, which contains the files and folders shown in the Explorer side panel.</p>

<p>You've explored a high-level overview of the code-server interface and reviewed some of the most commonly used features.</p>

<h2 id="conclusion">Conclusion</h2>

<p>You now have code-server, a versatile cloud IDE, installed on your DigitalOcean Kubernetes cluster. You can work on your source code and documents with it individually or collaborate with your team. Running a cloud IDE on your cluster provides more power for testing, downloading, and more thorough or rigorous computing. For further information see the <a href="https://code.visualstudio.com/docs">Visual Studio Code documentation</a> on additional features and detailed instructions on other components of code-server.</p>

